{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/codemirror-spell-checker/src/js/spell-checker.js","webpack:///./node_modules/codemirror/addon/dialog/dialog.js","webpack:///./node_modules/codemirror/addon/display/fullscreen.js","webpack:///./node_modules/codemirror/addon/display/placeholder.js","webpack:///./node_modules/codemirror/addon/edit/continuelist.js","webpack:///./node_modules/codemirror/addon/edit/matchbrackets.js","webpack:///./node_modules/codemirror/addon/hint/show-hint.js","webpack:///./node_modules/codemirror/addon/mode/overlay.js","webpack:///./node_modules/codemirror/addon/search/searchcursor.js","webpack:///./node_modules/codemirror/addon/selection/mark-selection.js","webpack:///./node_modules/codemirror/keymap/vim.js","webpack:///./node_modules/codemirror/lib/codemirror.js","webpack:///./node_modules/codemirror/mode/gfm/gfm.js","webpack:///./node_modules/codemirror/mode/markdown/markdown.js","webpack:///./node_modules/codemirror/mode/meta.js","webpack:///./node_modules/codemirror/mode/xml/xml.js","webpack:///./node_modules/typo-js/typo.js","webpack:///./src/scripts/easymde/codemirror/tablist.js","webpack:///./src/scripts/easymde/easymde.js","webpack:///./src/scripts/easymde/marked/Lexer.js","webpack:///./src/scripts/easymde/marked/Parser.js","webpack:///./src/scripts/easymde/marked/Renderer.js","webpack:///./src/scripts/easymde/marked/Slugger.js","webpack:///./src/scripts/easymde/marked/TextRenderer.js","webpack:///./src/scripts/easymde/marked/Tokenizer.js","webpack:///./src/scripts/easymde/marked/defaults.js","webpack:///./src/scripts/easymde/marked/helpers.js","webpack:///./src/scripts/easymde/marked/marked.js","webpack:///./src/scripts/easymde/marked/rules.js","webpack:///./src/scripts/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Typo","CodeMirrorSpellChecker","options","codeMirrorInstance","defineMode","String","includes","indexOf","apply","this","arguments","config","aff_loading","xhr_aff","XMLHttpRequest","open","onload","readyState","status","aff_data","responseText","num_loaded","typo","dic_data","platform","send","dic_loading","xhr_dic","rx_word","overlay","token","stream","ch","peek","word","next","check","getMode","backdrop","overlayMode","console","log","CodeMirror","dialogDiv","cm","template","bottom","dialog","wrap","getWrapperElement","appendChild","document","createElement","className","innerHTML","addClass","closeNotification","newVal","state","currentNotificationClose","defineExtension","callback","closed","me","close","inp","rmClass","parentNode","removeChild","focus","onClose","button","getElementsByTagName","selectValueOnOpen","select","onInput","on","e","onKeyUp","onKeyDown","keyCode","closeOnEnter","blur","e_stop","closeOnBlur","evt","relatedTarget","callbacks","buttons","blurring","length","b","e_preventDefault","setTimeout","doneTimer","duration","clearTimeout","mod","defineOption","val","old","Init","fullScreenRestore","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","width","style","height","documentElement","overflow","refresh","setFullscreen","replace","info","scrollTo","setNormal","clearPlaceholder","placeholder","setPlaceholder","elt","cssText","direction","getOption","placeHolder","createTextNode","display","lineSpace","insertBefore","firstChild","onBlur","isEmpty","onChange","wrapper","empty","lineCount","getLine","prev","off","hasFocus","listRE","emptyListRE","unorderedListRE","incrementRemainingMarkdownListNumbers","pos","startLine","line","lookAhead","skipCount","startItem","exec","startIndent","nextLineNumber","nextLine","nextItem","nextIndent","newNumber","parseInt","nextNumber","itemNumber","isNaN","replaceRange","commands","newlineAndIndentContinueMarkdownList","Pass","ranges","listSelections","replacements","head","eolState","getStateAfter","inner","innerMode","execCommand","inList","list","inQuote","quote","match","cursorBeforeBullet","test","slice","endOfQuote","endOfList","indent","after","numbered","bullet","replaceSelections","ie_lt8","navigator","userAgent","documentMode","Pos","matching","bracketRegex","findMatchingBracket","where","getLineHandle","afterCursor","re","text","charAt","dir","strict","getTokenTypeAt","found","scanForBracket","from","to","forward","maxScanLen","maxScanLineLength","maxScanLines","stack","lineEnd","Math","min","lastLine","max","firstLine","lineNo","end","undefined","push","pop","matchBrackets","autoclear","maxHighlightLen","maxHighlightLineLength","marks","markText","focused","clear","operation","doMatchBrackets","currentlyHighlighted","oldConfig","Completion","widget","debounce","tick","startPos","getCursor","startLen","getSelection","self","activityFunc","cursorActivity","showHint","getHints","async","newOpts","hint","prop","editor","hintOptions","out","defaultOptions","resolve","parseOptions","selections","somethingSelected","supportsSelection","anchor","completionActive","completion","signal","update","requestAnimationFrame","fn","cancelAnimationFrame","getText","getHintElement","hintsElement","el","nodeName","toUpperCase","Widget","data","picked","ownerDocument","getInputField","parentWindow","defaultView","hints","theme","selectedHint","completions","cur","render","displayText","hintId","container","body","cursorCoords","alignWithWord","left","top","below","offsetLeft","offsetTop","offsetParent","getComputedStyle","position","offsetParentPosition","getBoundingClientRect","bodyPosition","winW","innerWidth","offsetWidth","winH","innerHeight","offsetHeight","box","overlapY","scrolls","scrollHeight","clientHeight","startScroll","getScrollInfo","cursor","closingOnBlur","overlapX","right","node","nextSibling","paddingRight","nativeBarWidth","addKeyMap","keyMap","handle","baseMap","Up","moveFocus","Down","PageUp","menuSize","PageDown","Home","setFocus","End","Enter","pick","Tab","Esc","custom","customKeys","ourMap","addBinding","bound","extra","extraKeys","buildKeyMap","avoidWrap","changeActive","screenAmount","closeOnUnfocus","onFocus","onScroll","curScroll","newTop","point","target","srcElement","completeOnSingleClick","scrollToActive","childNodes","fetchHints","result","then","active","scrollIntoView","identStart","closeCharacters","disable","first","myTick","finishUpdate","completeSingle","removeKeyMap","firstNode","floor","registerHelper","words","helpers","getHelpers","resolved","app","applicableHelpers","run","getHelper","fromList","anyword","term","getTokenAt","start","string","substr","autocomplete","auto","base","combine","startState","basePos","baseCur","overlayPos","overlayCur","streamSeen","copyState","combineTokens","textAfter","electricChars","blankLine","baseToken","overlayToken","doFold","noFold","ensureFlags","regexp","flags","current","ignoreCase","global","multiline","regexpFlags","RegExp","source","maybeMultiline","searchRegexpForward","doc","last","lastIndex","index","searchRegexpForwardMultiline","chunk","curLine","before","split","inside","startCh","lastMatchIn","endMargin","newMatch","searchRegexpBackward","searchRegexpBackwardMultiline","chunkSize","adjustPos","orig","folded","foldFunc","mid","len","searchStringForward","query","caseFold","fold","lines","search","cutFrom","endString","searchStringBackward","lastIndexOf","topString","SearchCursor","atOccurrence","clipPos","matches","reverse","normalize","str","toLowerCase","findNext","find","findPrevious","cmpPos","newText","origin","splitLines","defineDocExtension","getSearchCursor","setSelections","onCursorActivity","markedSelection","reset","array","coverRange","coverStart","coverEnd","cmp","shift","markedSelectionStyle","addAt","cls","endLine","atEnd","mark","splice","defaultKeymap","keys","type","toKeys","context","action","motion","motionArgs","linewise","toJumplist","wordEnd","bigWord","inclusive","explicitRepeat","toFirstChar","repeatOffset","isEdit","actionArgs","matchIndent","sameLine","operator","operatorArgs","indentRight","toLower","operatorMotionArgs","visualLine","shouldMoveCursor","insertAt","interlaceInsertRepeat","blockwise","keepSpaces","fullLine","exitVisualBlock","increase","backtrack","textObjectInner","searchArgs","querySrc","wholeWordOnly","defaultKeymapLength","defaultExCommandMap","shortName","possiblyAsync","excludeFromCommandHistory","Vim","detachVimMap","vim","caretColor","clearFatCursorMark","updateFatCursorMark","fatCursorMarks","disableFatCursorMark","attach","attachVimMap","setOption","getOnPasteFn","leaveVimMode","enableFatCursorMark","maybeInitVimState","enterVimMode","range","lineLength","cmKey","vimKey","pieces","lastPiece","hasCharacter","piece","modifiers","specialKeys","isUpperCase","join","cmKeyToVimKey","cmd","findKey","Backspace","Delete","Insert","onPasteFn","insertMode","setCursor","offsetCursor","actions","enterInsertMode","numberRegex","wordCharTest","isWordChar","bigWordCharTest","makeKeyRange","size","fromCharCode","upperCaseAlphabet","lowerCaseAlphabet","numbers","validMarks","concat","validRegisters","isLine","isLowerCase","k","isWhiteSpaceString","isEndOfSentenceSymbol","inArray","arr","defaultValue","aliases","Error","cfg","option","scope","local","vimGlobalState","lastInsertModeKeyTimer","createCircularJumpList","pointer","tail","buffer","Array","move","offset","newCur","inc","oldCur","cursorEqual","cachedCursor","add","curMark","useNextSlot","trashMark","setBookmark","markPos","oldPointer","createInsertModeChanges","changes","expectCursorActivityForChange","MacroModeState","latestRegister","isPlaying","isRecording","replaySearchQueries","onRecordingDone","lastInsertModeChanges","inputState","InputState","lastEditInputState","lastEditActionCommand","lastHPos","lastHSPos","lastMotion","fakeCursor","insertModeRepeat","visualMode","visualBlock","lastSelection","lastPastedText","sel","resetVimGlobalState","optionName","searchQuery","searchIsReversed","lastSubstituteReplacePart","jumpList","macroModeState","lastCharacterSearch","increment","selectedCharacter","registerController","RegisterController","searchHistoryController","HistoryController","exCommandHistoryController","exitMacroRecordMode","enterMacroRecordMode","registerName","register","getRegister","openDialog","vimApi","getRegisterController","resetVimGlobalState_","getVimGlobalState_","maybeInitVimState_","suppressErrorLogging","InsertModeKey","map","lhs","rhs","ctx","exCommandDispatcher","unmap","noremap","toCtxArray","ctxsToMap","actualLength","mapping","newMapping","_mapCommand","mappedCtxs","filter","mapclear","origLength","userKeymap","contexts","j","defineEx","prefix","func","exCommands","commandMap_","handleKey","command","handleMacroRecording","clearInputState","pushText","logKey","handleEsc","exitVisualMode","exitInsertMode","keyBuffer","keysAreChars","commandDispatcher","matchCommand","thisMatch","here","handleKeyInsertMode","keysMatcher","pushRepeatDigit","handleKeyNonInsertMode","curOp","isVimOp","substring","doKeyToKey","processCommand","handleEx","input","defineMotion","motions","defineAction","defineOperator","operators","mapCommand","args","defineRegister","registers","prefixRepeat","motionRepeat","reason","Register","insertModeChanges","searchQueries","unnamedRegister","historyBuffer","iterator","initialPrefix","getRepeat","repeat","setText","pushInsertModeChanges","pushSearchQuery","toString","isValidRegister","shiftNumericRegisters_","nextMatch","up","element","pushInput","bestMatch","partial","full","commandMatch","commandMatches","character","lastChar","repeatOverride","processMotion","processOperator","processOperatorMotion","processAction","processSearch","processEx","copyArgs","evalInput","updateCmSelection","repeatIsExplicit","recordLastEdit","getSearchState","setReversed","promptPrefix","originalQuery","getQuery","originalScrollPos","handleQuery","showPrompt","logSearchQuery","desc","searchPromptDesc","parsedQuery","keyName","selectionEnd","selectionStart","updateSearchQuery","clearSearchHighlight","expandWordUnderCursor","isKeyword","smartCase","showConfirm","onPromptClose","onPromptKeyDown","exArgs","newHead","newAnchor","origHead","copyCursor","clipCursorToContent","origAnchor","oldHead","oldAnchor","noRepeat","motionResult","recordJumpPosition","Infinity","updateMark","cursorIsBefore","lastSel","lineOffset","abs","chOffset","curStart","curEnd","cmSel","cursorMin","cursorMax","makeCmSelection","tmp","_cm","expandSelectionToLine","selection","getRange","clipToLine","primary","operatorMoveTo","actionCommand","moveToTopLine","_head","getUserVisibleLines","findFirstNonWhiteSpaceCharacter","moveToMiddleLine","moveToBottomLine","expandToLine","isReversed","highlightSearchMatches","goToMark","getMarkPos","moveToOtherHighlightedEnd","jumpToMark","best","equal","between","cursorIsBetween","moveByCharacters","moveByLines","endCh","moveByDisplayLines","moveByScroll","moveToColumn","moveToEol","posV","findPosV","moveToStartOfLine","charCoords","res","hitSide","goalCoords","coordsChar","resCoords","moveByPage","moveByParagraph","findParagraph","moveBySentence","nextChar","idx","ln","stop","curr","last_valid","skip_empty_lines","curr_index","findSentence","scrollbox","defaultTextHeight","dest","moveByWords","emptyLineIsWord","findWord","eodCh","shortCircuit","firstWord","lastWord","moveToWord","moveTillCharacter","moveToCharacter","recordLastCharacterSearch","moveToSymbol","symb","curCh","lineText","nextCh","lastCh","reverseSymb","depth","curMoveThrough","symbolToMode","init","findSymbolModes","isComplete","lineLen","findSymbol","keepHPos","retval","moveToFirstNonWhiteSpaceCharacter","moveToMatchedSymbol","symbol","moveToLineOrEdgeOfDocument","lineNum","textObjectManipulation","bracketRegexp","openSym","selectCompanionObject","'","chars","firstIndex","findBeginningAndEnd","expandSelection","repeatLastCharacterSearch","lastSearch","moveH","fillArray","times","change","finalHead","Number","MAX_VALUE","setSelection","replaceSelection","replacement","lastState","prevLineEnd","wasLastLine","newlineAndIndent","indentLine","indentAuto","_args","changeCase","getSelections","swapped","toSwap","yank","endPos","jumpListWalk","scroll","lineHeight","delta","newPos","ceil","newBottom","scrollToCursor","y","replayMacro","executeMacroRegister","toggleOverwrite","overwrite","getLastEditPos","onKeyEventTargetKeyDown","selectForInsert","toggleVisualMode","subMode","reselectLastSelection","_actionArgs","updateLastSelection","anchorMark","headMark","joinLines","finalCh","curFinalPos","newLineAndEnterInsertMode","newlineAndIndentContinueComment","paste","tabSize","whitespaceLength","tabs","spaces","currentLine","chompedText","wasChomped","firstIndent","wspace","newIndent","quotient","curPosFinal","lastSelectionCurEnd","selectedArea","getCurrentSelectedAreaRange","block","getLastSelectedAreaRange","getSelectedAreaRange","selectedText","emptyStrings","selectBlock","posFromIndex","indexFromPos","extendLineToColumn","undo","repeatFn","redo","setRegister","setMark","replaceTo","replaceWith","replaceWithStr","incrementNumberToken","numberStr","lineStr","baseStr","digits","zeroPadding","repeatLastEdit","includeLineBreak","maxCh","ret","offsetLine","offsetCh","pressed","mapped","prefixLen","pressedPrefix","mappedPrefix","cur1","cur2","cur3","cur1before2","cur2before3","trim","column","isClipped","primIndex","atAnchor","atHead","getIndex","wasClipped","baseCh","headCh","newDir","lineHead","updateFakeCursor","exclusive","headOffset","anchorOffset","moveHead","clearFakeCursor","firstNonWS","_forward","noSymbol","getHead","wordStart","bracket","section","comment","method","preprocess","charTests","foundWord","charIdxInLine","markName","includeChar","isBoundary","any","SearchState","searchState_","shortText","prompt","splitBySeparator","argString","separator","slashes","findUnescapedSeparators","tokens","escapeNextChar","setQuery","getOverlay","searchOverlay","setOverlay","reversed","getScrollbarAnnotate","annotate","setScrollbarAnnotate","charUnescapes","unescapes","parseQuery","regexPart","forceIgnoreCase","specialComesNext","translateRegex","openNotification","alert","raw","rawQuery","r1","r2","props","regexEqual","highlightTimeout","searchState","removeOverlay","matchSol","sol","backUp","eol","skipToEnd","addOverlay","showMatchesOnScrollbar","scrollInfo","bottomY","done","history","ExCommandDispatcher","buildCommandMap_","opt_params","that","_processCommand","commandHistoryRegister","previousCommand","inputStream","StringStream","commandName","params","parseInput_","matchCommand_","parseCommandArgs_","toInput","eatWhile","eat","parseLineSpec_","numberMatch","parseLineSpecOffset_","offsetMatch","delim","argDelimiter","user","unshift","colorscheme","mapArgs","imap","nmap","vmap","set","setArgs","setCfg","expr","forceGet","optionIsBoolean","oldValue","message","setOptionReturn","setlocal","setglobal","regArgs","regInfo","sort","unique","number","pattern","err","eatSpace","opts","decimal","hex","octal","parseArgs","lineStart","radix","numPart","textPart","matchPart","a","compareFn","textOld","anum","bnum","splitBySlash","matchedLines","content","nextCommand","substitute","trailing","flagsPart","count","replacePart","confirm","output","matched","matcher","unescapeRegexReplace","translateRegexReplace","searchCursor","exMode","lastPos","replaceAll","_value","savedCallback","doReplace","write","save","nohlsearch","delmarks","sym","startMark","finishMark","charCodeAt","finish","insertModeChangeRegister","lastChange","logInsertModeChange","imc","repeatInsertModeChanges","changeObj","ignoreCount","selectionCount","maybeReset","handleExternalSelection","textContent","fakeCursorBookmark","lookupKey","repeatForInsert","isAction","cachedInputState","repeatCommand","repeatInsert","changeObject","keyHandler","binding","detach","fallthrough","gecko","ie_upto10","ie_11up","edge","ie","ie_version","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","flipCtrlCmd","captureRightClick","classTest","removeChildren","removeChildrenAndAdd","parent","tag","eltP","setAttribute","contains","child","nodeType","host","activeElt","activeElement","shadowRoot","joinClasses","as","createRange","endNode","setEnd","setStart","createTextRange","moveToElementText","collapse","moveEnd","moveStart","selectInput","f","copyObj","obj","countColumn","startIndex","startValue","nextTab","_e","Delayed","id","time","handler","onTimeout","Date","ms","sel_dontScroll","sel_mouse","sel_move","findColumn","goal","col","skipped","spaceStrs","spaceStr","lst","nothing","createObj","inst","nonASCIISingleCaseWordChar","isWordCharBasic","helper","extendingChars","isExtendingChar","skipExtendingChars","findFirst","pred","midF","bidiOther","getBidiPartAt","order","sticky","bidiOrdering","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","level","outerType","code","types","i$1","i$2","type$1","i$3","prev$1","type$2","i$4","type$3","i$5","cur$1","type$4","i$6","end$1","replace$1","j$1","i$7","at","isRTL","j$2","nstart","getOrder","noHandlers","emitter","addEventListener","attachEvent","_handlers","getHandlers","removeEventListener","detachEvent","handlers","signalDOMEvent","override","preventDefault","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivityHandlers","hasHandler","eventMixin","ctor","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_target","e_button","which","ctrlKey","zwspSupported","badBidiRects","dragAndDrop","div","zeroWidthElement","measure","hasBadBidiRects","txt","r0","splitLinesAuto","nl","rt","hasSelection","te","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","modes","mimeModes","dependencies","resolveMode","spec","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","nstate","a1","a2","lineOracle","lastColumnPos","lastColumnValue","children","sz","getBetween","iter","getLines","updateLineHeight","diff","no","lineAtHeight","h","outer","lh","lineNumberFor","lineNumberFormatter","firstLineNumber","equalCursorPos","copyPos","x","maxPos","minPos","clipLine","linelen","clipToLen","clipPosArray","skipTo","indentation","consume","caseInsensitive","cased","hideFirstChars","oracle","SavedContext","Context","maxLookAhead","baseTokens","baseTokenPos","highlightLine","forceToEnd","st","modeGen","lineClasses","runMode","loop","overlays","i_end","opaque","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","stateAfter","styleClasses","highlightFrontier","modeFrontier","precise","minindent","minline","lim","indented","findStartLine","saved","fromSaved","processLine","viewFrom","viewTo","startAt","callBlankLine","readToken","copy","Token","takeToken","asArray","extractLineClasses","lineClass","flattenSpans","curStyle","addModeClass","mName","sawReadOnlySpans","sawCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","stretchSpansOverChange","oldFirst","markedSpans","oldLast","isInsert","nw","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansBefore","startsBefore","markedSpansAfter","span$1","clearEmptySpans","newMarkers","gapMarkers","gap","clearWhenEmpty","detachMarkedSpans","detachLine","attachMarkedSpans","attachLine","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","merged","visualLineNo","lineN","vis","visualLineEndNo","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","found$1","findMaxLine","maxLine","maxLineLength","maxLineChanged","Line","estimateHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","rest","addToken","buildToken","buildTokenBadBidi","insertLineContent","externalMeasured","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","title","startStyle","endStyle","css","attributes","trailingBefore","spaceBefore","special","specialChars","mustWrap","createDocumentFragment","txt$1","tabWidth","specialCharPlaceholder","fullStyle","attr","part","buildCollapsedSpan","ignoreWidget","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","foundBookmarks","endStyles","upto","tokenText","LineView","visualLineContinued","hidden","buildViewArray","nextPos","view","operationGroup","orphanDelayedCallbacks","signalLater","delayedCallbacks","fireOrphanDelayed","delayed","updateLineForChanges","dims","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","zIndex","getLineContent","ext","built","background","updateLineBackground","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","markers","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","gutterLeft","gutterSpecs","gutterWidth","alignable","isWidget","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","wrapperWidth","coverGutter","paddingLeft","marginLeft","widgetHeight","parentStyle","gutters","clientWidth","eventInWidget","getAttribute","sizer","mover","paddingTop","paddingVert","paddingH","cachedPaddingH","currentStyle","scrollGap","displayWidth","scroller","barWidth","displayHeight","barHeight","mapFromLineView","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","lineMeasure","updateExternalMeasurement","rect","hasHeights","prepared","varHeight","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","ensureLineHeights","place","nodeAndOffsetInLineMap","getUsefulRect","screen","logicalXDPI","deviceXDPI","normal","fromRange","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","maybeUpdateRectForZooming","rSpan","charWidth","nullRect","rtop","rbot","bot","bogus","singleCursorHeightPerLine","rbottom","measureCharInner","measureText","mStart","mEnd","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","cachedCharWidth","cachedTextHeight","lineNumChars","pageScrollX","pageScrollY","marginTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","viewOffset","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","preparedMeasure","getBidi","partPos","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsCharInner","rangeEnd","wrappedLineExtent","begin","wrappedLineExtentChar","boxIsAfter","ltr","coordsBidiPartWrapped","coordsBidiPart","baseX","chAround","boxAround","atLeft","atStart","_lineNo","ref","closestDist","endX","dist","textHeight","clientLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","estHeight","posFromMouse","liberal","forRect","space","clientX","clientY","e$1","colDiff","round","regChange","lendiff","updateLineNumbers","viewChanged","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","countDirtyView","dirty","updateSelection","showSelection","prepareSelection","curFragment","cursors","selFragment","showCursorWhenSelecting","drawSelectionCursor","drawSelectionRange","cursorHeight","otherCursor","cmpCoords","fragment","padding","leftSide","rightSide","sizerWidth","docLTR","drawForLine","fromArg","toArg","wrapX","side","extent","iterateBidiSections","fromPos","toPos","openStart","openEnd","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","clearInterval","blinker","cursorDiv","visibility","cursorBlinkRate","setInterval","ensureFocus","delayBlurEvent","delayingBlurEvent","readOnly","selForContextMenu","receivedFocus","updateHeightsInViewport","prevBottom","lineDiv","updateWidgetHeight","chWidth","w","visibleLines","viewport","ensure","ensureFrom","ensureTo","calculateScrollPos","snapMargin","screentop","docBottom","atTop","atBottom","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","scrollToPos","margin","cursorScrollMargin","scrollToCoords","scrollToCoordsRange","sPos","updateScrollTop","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollbars","setScrollLeft","isScroller","scrollWidth","alignHorizontally","measureForScrollbars","gutterW","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","maybeDisable","elementFromPoint","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","heightForcer","borderBottom","scrollbarFiller","coverGutterNextToScrollbar","gutterFiller","scrollbarModel","initScrollbars","scrollbarStyle","axis","nextOpId","startOperation","op","updateInput","typing","changeObjs","cursorActivityCalled","selectionChanged","updateMaxLine","ops","ownsGroup","endOperation","endCb","group","fireCallbacksForOps","finishOperation","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","endOperations","scrollbarsClipped","marginBottom","borderRightWidth","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","setDocumentHeight","postUpdateDisplay","wheelStartX","wheelStartY","doScroll","scrollNode","maybeScrollWindow","limit","changed","endCoords","scrollPos","startTop","startLeft","scrollPosIntoView","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","runInOp","methodOp","docMethodOp","highlight","highlightWorker","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","force","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","events","renderedView","maybeUpdateLineNumberWidth","viewportMargin","different","lastWrapHeight","lastWrapWidth","adjustView","toUpdate","selSnapshot","anchorNode","extend","focusNode","focusOffset","selectionSnapshot","updateNumbersFrom","rm","currentWheelTarget","updateNumber","patchDisplay","snapshot","removeAllRanges","addRange","restoreSelection","selectionDiv","reportedViewFrom","reportedViewTo","updateGutterSpace","alignWidgets","comp","align","innerW","lineGutter","lineNumInnerWidth","lineNumWidth","getGutters","sawLineNumbers","renderGutters","specs","gElt","updateGutters","Display","draggable","wheelDX","wheelDY","activeTouch","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","there","deepCopy","Range","normalizeSelection","mayTouch","selectionsMayTouch","prim","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","spansFor","updateLine","linesFor","lastText","lastSpans","nlines","insert","remove","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","History","startGen","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","addChangeToHistory","selAfter","opId","hist","historyEventDelay","lastChangeEvent","pushSelectionToHistory","addSelectionToHistory","selectionEventCanBeMerged","clearRedo","existing","removeClearedSpans","explicitlyCleared","mergeOldSpans","getOldSpans","stretched","stretchCur","copyHistoryArray","newGroup","instantiateSel","event","newChanges","extendRange","posBefore","extendSelection","extendSelections","heads","replaceOneSelection","setSimpleSelection","setSelectionReplaceHistory","setSelectionNoUndo","NaN","filterSelectionChange","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","skipAtomic","skipAtomicInner","oldPos","preventCursorLeft","selectLeft","preventCursorRight","selectRight","atomic","near","movePos","far","cantEdit","selectAll","filterChange","canceled","cancel","makeChange","ignoreReadOnly","suppressEdits","parts","mk","newParts","dfrom","dto","removeReadOnlyRanges","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","antiChanges","returned","v","shiftDoc","distance","removed","recomputeMaxLength","checkWidthStart","retreatFrontier","changesHandler","changeHandler","makeChangeSingleDocInEditor","assign","rebaseHistSelSingle","rebaseHistArray","sub","ok","copied","changeLine","changeType","LeafChunk","BranchChunk","removeInner","insertInner","iterN","oldHeight","remaining","leaf","maybeSpill","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","this$1","oldH","nextMarkerId","TextMarker","cloneNode","isParent","SharedTextMarker","markTextShared","replacedWith","addToHistory","addMarkedSpan","clearOnEnter","clearHistory","withOp","visual","dHeight","findSharedMarkers","findMarks","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","constructor","getValue","lineSeparator","setValue","getLineNumber","getLineHandleVisualStart","extendSelectionsBy","addSelection","dup","newSel","oldPrev","newPrev","computeReplacedSel","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","removeLineClass","addLineWidget","aboveVisible","removeLineWidget","realOpts","findMarksAt","getAllMarks","sepSize","copyHistory","linkedDoc","mFrom","mTo","subMark","copySharedMarkers","unlinkDoc","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","read","markAsReadAndPasteIfAllFilesAreRead","readTextFromFile","file","allowDropFileTypes","reader","onerror","readAsText","draggingText","text$1","getData","selected","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","editors","globalsRegistered","ensureGlobalHandlers","resizeTimer","onResize","setSize","keyNames","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","145","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","normalizeKeyName","alt","ctrl","normalizeKeyMap","keymap","keyname","getKeyMap","isModifierKey","addModifierNames","noShift","altKey","metaKey","shiftKey","altGraphKey","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","prep","targetTop","basic","pcDefault","emacsy","macDefault","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","visualLineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","defaultTab","transposeChars","sels","openLine","inWS","doHandleBinding","dropShift","ensurePolled","prevShift","stopSeq","dispatchKey","seq","keySeq","dispatchKeyInner","keyMaps","lookupKeyForEditor","handleKeyBinding","lastStoppedKey","getField","handled","showCrossHair","onKeyPress","charCode","handleCharBinding","lastClick","lastDoubleClick","PastClick","onMouseDown","supportsTouch","clickInGutter","now","compare","clickRepeat","selectingText","handleMappedButton","contained","behavior","unit","addNew","moveOnDrag","configureMouse","dragDrop","moved","dragEnd","mouseMove","dragStart","preventScroll","e2","leftButtonStartDrag","ourRange","ourIndex","startSel","rangeForUnit","extendTo","startCol","posCol","leftPos","oldRange","ranges$1","anchorLine","boundary","headIndex","usePart","bidiSimplify","editorSize","counter","curCount","leftButtonSelect","leftButtonDown","onContextMenu","findWordAt","gutterEvent","prevent","mX","mY","touches","lineBox","g","contextMenuInGutter","themeChanged","defaults","optionHandlers","dragDropChanged","funcs","dragFunctions","toggle","enter","over","leave","drop","wrappingChanged","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","touchFinished","prevTouch","finishTouch","farAway","touch","radiusX","radiusY","isMouseLikeTouchEvent","pageX","pageY","frag","onDragOver","setData","effectAllowed","setDragImage","img","src","_top","onDragStart","registerEventHandlers","finishInit","initHooks","textRendering","how","aggressive","curSpace","curSpaceString","indentUnit","indentString","indentWithTabs","pos$1","defineInitHook","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","recent","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","spellcheck","autocorrect","autocapitalize","hiddenTextarea","border","findPosH","origDir","lineDir","moveOnce","boundToLine","bidi","mv","getWrappedLineExtent","moveInStorageOrder","searchInVisualLine","getRes","moveVisually","sawType","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","posToDOM","badPos","bad","domToPos","lineNode","locateNodeInLineView","textNode","topNode","nodeValue","curNode","previousSibling","dist$1","belongsToInput","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","updateFromDOM","readFromDOMSoon","forceCompositionEnd","screenReaderLabelChanged","label","removeAttribute","showMultipleSelections","curAnchor","curFocus","rng","rangeCount","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","pollSelection","pollInterval","poll","scan","isInGutter","triggerOnKeyDown","pollContent","fromIndex","fromNode","toNode","toIndex","closing","extraLinebreak","addText","walk","cmText","markerID","isBlock","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","readOnlyChanged","resetPosition","TextareaInput","prevInput","pollingFast","createField","textarea","prepareCopyCut","fastPoll","dispatchEvent","Event","_display","moveInputWithCursor","headPos","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldScrollY","oldCSS","oldWrapperCSS","wrapperBox","scrollY","rehide","detectingSelectAll","prepareSelectAllHack","mouseup","extval","disabled","deflt","notOnInit","newBreaks","integer","defineOptions","getDoc","score","priority","insertSorted","modeSpec","newRanges","getLineTokens","help","_global","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","amount","rtlMoveVisually","goalColumn","goals","startChar","scrollToRange","interpret","swapDoc","phrase","phraseText","phrases","getScrollerElement","getGutterElement","registerGlobalHelper","predicate","addEditorMethods","dontDelegate","defineMIME","mime","fromTextArea","tabindex","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","addLegacyProps","version","factory","urlRE","modeConfig","codeDepth","gfmOverlay","codeBlock","ateSpace","difference","gitHubSpice","markdownConfig","taskLists","strikethrough","emoji","cmCfg","modeCfg","htmlMode","htmlModeMissing","highlightFormatting","maxBlockquoteDepth","fencedCodeBlockHighlighting","fencedCodeBlockDefaultMode","xml","tokenTypeOverrides","tokenTypes","header","list1","list2","list3","hr","image","imageAltText","imageMarker","formatting","linkInline","linkEmail","linkText","linkHref","em","strong","tokenType","hrRE","taskListRE","atxHeaderRE","allowAtxHeaderWithoutSpace","setextHeaderRE","textRE","fencedCodeRE","linkDefRE","punctuation","switchInline","inline","switchBlock","linkTitle","indentedCode","htmlBlock","exit","htmlState","tagStart","tokenize","isInText","inlineNormal","blockNormal","trailingSpaceNewLine","prevLine","thisLine","firstTokenOnLine","prevLineLineIsEmpty","prevLineIsIndentedCode","prevLineIsHr","prevLineIsList","maxNonCodeIndentation","listStack","lineIndentation","indentationDiff","allowsInlineContinuation","fencedCodeEnd","isHr","getType","setext","listType","taskList","fencedEndRE","localMode","findModeByName","mimes","localState","footnoteLink","md_inside","returnType","currListInd","hasExitedList","maxFencedEndInd","taskOpen","taskClosed","listMod","handleText","matchCh","regex","previousFormatting","formattingEscape","atts","leftFlanking","rightFlanking","setEm","setStrong","retType","endChar","returnState","linkRE","footnoteLinkInside","footnoteUrl","blockCommentStart","blockCommentEnd","closeBrackets","modeInfo","alias","findModeByMIME","findModeByExtension","findModeByFileName","filename","dot","htmlConfig","autoSelfClosers","implicitlyClosed","contextGrabbers","doNotIndent","allowUnquoted","allowMissing","xmlConfig","allowMissingTagName","editorConf","config_","setStyle","inText","chain","parser","inBlock","doctype","inTag","closure","baseState","tagName","isInAttribute","stringStartCol","terminator","startOfLine","noIndent","popContext","maybePopContext","nextTagName","parentTagName","tagNameState","closeTagNameState","attrState","matchClosing","closeState","closeStateErr","_stream","attrEqState","attrValueState","attrContinuedState","baseIndent","multilineTagIndentPastTag","multilineTagIndentFactor","alignCDATA","tagAfter","grabbers","configuration","skipAttribute","xmlCurrentTag","xmlCurrentContext","cx","dictionary","affData","wordsData","settings","rules","dictionaryTable","compoundRules","compoundRuleCodes","replacementTable","memoized","loaded","path","_len","_jlen","readDataFile","url","setFunc","response","_readFile","asyncLoad","setAffData","setup","setWordsData","_parseAFF","rule","ONLYINCOMPOUND","_parseDIC","ruleText","expressionText","loadedCallback","extension","dictionaryPath","getURL","__dirname","load","charset","promise","req","Promise","reject","statusText","overrideMimeType","fs","existsSync","readFileSync","numEntries","lineParts","_removeAffixComments","definitionParts","ruleType","ruleCode","combineable","entries","charactersToRemove","additionParts","charactersToAdd","continuationClasses","parseRuleCodes","regexToMatch","entry","_removeDicComments","addWord","ruleCodesArray","NEEDAFFIX","newWords","_applyRule","ii","_iilen","newWord","combineCode","combineRule","otherNewWords","iii","_iiilen","textCodes","FLAG","continuationRule","aWord","trimmedWord","checkExact","capitalizedWord","hasFlag","lowercaseWord","ruleCodes","COMPOUNDMIN","flag","wordFlags","alphabet","suggest","memoizedLimit","replacementEntry","correctedWord","edits1","known_only","_edit","rv","ed1","weighted_corrections","ed1word","sorted_corrections","a_val","b_val","localeCompare","capitalization_scheme","working_limit","correct","tabAndIndentMarkdownList","shiftTabAndUnindentMarkdownList","marked","isMac","anchorToExternalRegex","bindings","toggleBold","toggleItalic","drawLink","toggleHeadingSmaller","toggleHeadingBigger","drawImage","toggleBlockquote","toggleOrderedList","toggleUnorderedList","toggleCodeBlock","togglePreview","toggleStrikethrough","toggleHeading1","toggleHeading2","toggleHeading3","cleanBlock","drawTable","drawHorizontalRule","toggleSideBySide","toggleFullScreen","toggleSecretBlock","shortcuts","isMobile","opera","fixShortcut","createToolbarDropdown","enableTooltips","createToolbarButton","childrenIndex","childElement","toolbarBuiltInButtons","enableActions","markup","actionName","tooltip","getBindingName","createTooltip","noDisable","classList","noMobile","classNameParts","iconClasses","classNameIndex","classNamePart","icon","iconClassIndex","iconClass","onclick","createSep","getState","stat","bold","italic","link","saved_overflow","codemirror","sidebyside","onToggleFullScreen","maxHeight","removeProperty","setPreviewMaxHeight","toolbar_div","toolbarElements","fullscreen","toolbarButton","_toggleBlock","blockStyles","fenceCharsToInsert","fencing_line","token_state","code_type","line_num","firstTok","lastTok","fencedChars","block_start","block_end","cur_start","cur_end","tok","is_code","start_text","start_line","end_text","end_line","fence_chars","search_from","next_line","next_line_last_tok","no_sel_and_starting_of_line","sel_multi","start_line_sel","end_line_sel","repl_start","repl_end","_replaceSelection","insertFencingAtSelection","secretChars","secret","orig_text","cap","new_text","_toggleLine","_toggleHeading","startPoint","endPoint","_cleanBlock","promptURLs","promptTexts","insertTexts","afterImageUploaded","imageName","uploadedImage","updateStatusBar","imageTexts","sbOnUploaded","sbInit","table","horizontalRule","preview","useSideBySideListener","noFullscreenItems","gui","toolbar","statusbar","forEach","removeNoFullscreenClass","sideBySideFullscreen","addNoFullscreenClass","previewNormal","sideBySideRenderingFunction","newValue","previewRender","previewClass","isArray","startEnd","currHeadingLevel","listRegexp","whitespacesRegexp","repl","_toggle","untoggleOnly","char","_getChar","_checkChar","start_chars","end_chars","humanFileSize","bytes","units","u","toFixed","_mergeProperties","wordCount","default","openBrowseFileWindow","timeFormat","locale","format","hour","minute","sbOnDragEnter","sbOnDrop","sbProgress","sizeUnits","errorMessages","noFileGiven","typeNotAllowed","fileTooLarge","importError","EasyMDE","autoDownloadFA","autoDownloadFontAwesome","styleSheets","href","showIcons","uploadImage","plainText","markdown","parsingConfig","autosave","errorCallback","errorMessage","imageMaxSize","imageAccept","unique_id","uniqueId","initialValue","foundSavedValue","imageUploadFunction","uploadImagesUsingCustomFunction","uploadImages","isLocalStorageAvailable","localStorage","setItem","removeItem","onSuccess","onError","names","uploadImageUsingCustomFunction","itemName","matchingClasses","markedOptions","renderingConfig","singleLineBreaks","breaks","codeSyntaxHighlighting","hljs","language","getLanguage","highlightAuto","setOptions","htmlText","sanitizerFunction","htmlDoc","DOMParser","parseFromString","listItems","listItem","listItemChild","HTMLInputElement","listStyleType","removeListStyleWhenCheckbox","linkString","fixedLinkString","addAnchorTargetBlank","_rendered","game","spellChecker","codemirrorOptions","styleSelectedText","nativeSpellcheck","forceSync","easyMDEContainer","cmWrapper","createToolbar","createStatusbar","enabled","_autosave_timeout","submit_delay","sideBySide","createSideBySide","temp_cm","easyMDE","binded","autosaveTimeoutId","getItem","getElementById","dd","Intl","DateTimeFormat","clearAutosavedValue","imageInput","click","onErrorSup","fillErrorMessage","imageUrl","formData","FormData","append","imageCSRFToken","request","upload","onprogress","lengthComputable","progress","total","imageUploadEndpoint","JSON","parse","error","filePath","location","filledErrorMessage","borderTopWidth","previewMaxHeight","syncSideBySidePreviewScroll","cScroll","pScroll","ratio","parseFloat","onscroll","items","toolbarData","toolbarGuideIcon","hideIcons","nonSeparatorIconsFollow","item","toolbarTips","multiple","accept","opacity","onUpdate","onActivity","isPreviewActive","isSideBySideActive","isFullscreenActive","Tokenizer","smartypants","mangle","random","Lexer","links","tokenizer","pedantic","gfm","lex","blockTokens","lastToken","fences","heading","nptable","blockquote","html","def","lheading","paragraph","errMsg","silent","l2","row","inlineTokens","cells","inLink","inRawBlock","prevChar","maskedSrc","reflinkSearch","blockSkip","escape","reflink","codespan","br","del","autolink","entityLink","inlineText","Renderer","TextRenderer","Slugger","unescape","Parser","renderer","textRenderer","slugger","l3","cell","ordered","loose","itemBody","checked","task","checkbox","parseInline","lang","escaped","tablecell","tablerow","listitem","cleanUrl","infostring","langPrefix","headerIds","headerPrefix","slug","xhtml","sanitize","baseUrl","seen","originalSlug","rtrim","splitCells","findClosingBracket","outputLink","newline","trimRight","codeBlockStyle","matchIndentToCode","indentToCode","matchIndentInNode","indentInNode","indentCodeCompensation","bull","isordered","isparen","itemMatch","addBack","istask","ischecked","smartLists","sanitizer","lastParenIndex","linkLen","_escapes","nolink","endReg","endAst","endUnd","middle","hasNonSpaceChars","hasSpaceCharsOnBothEnds","startsWith","endsWith","prevCapZero","_backpedal","TextEditor","_replaceContentLinks","getDefaults","walkTokens","changeDefaults","newDefaults","escapeTest","escapeReplace","escapeTestNoEncode","escapeReplaceNoEncode","escapeReplacements","getEscapeReplacement","unescapeTest","_","caret","nonWordAndColonTest","originIndependentUrl","baseUrls","justDomain","protocol","domain","resolveUrl","relativeBase","suffLen","currChar","encode","edit","getRegex","prot","decodeURIComponent","encodeURI","noopTest","merge","tableRow","checkSanitizeDeprecation","warn","pending","use","prevRenderer","prevTokenizer","lexer","_paragraph","_label","_title","_tag","_comment","CONST","ENTITY_LINK_TYPES","_punctuation","_blockSkip","_overlapSkip","overlapSkip","_scheme","_email","_attribute","_href","_extended_email","saveEditor","chooseImage","FilePicker","browse","Hooks","journal","sheet","Boolean","restricted","Handlebars","hash","owner","editable","enrichHTML","secrets","entities","$","SafeString","outerHTML","oldActivateListeners","FormApplication","activateListeners","each","_activateEditor","dataset","editorOptions","instance","getEntityHints","ev","insertIntoEditor","pack","packs","getEntity","entity","CONFIG","collection","_id","btn","currentTarget","oldEnrichHTML","rolls","rollData","entityTypes","getCompletions","getEntityNameHints","startEntityCompletion","keywords","startAtStart"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"modules/mess/scripts/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/scripts/index.js\");\n","// Use strict mode (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode)\n\"use strict\";\n\n\n// Requires\nvar Typo = require(\"typo-js\");\n\n\n// Create function\nfunction CodeMirrorSpellChecker(options) {\n\t// Initialize\n\toptions = options || {};\n\n\n\t// Verify\n\tif(typeof options.codeMirrorInstance !== \"function\" || typeof options.codeMirrorInstance.defineMode !== \"function\") {\n\t\tconsole.log(\"CodeMirror Spell Checker: You must provide an instance of CodeMirror via the option `codeMirrorInstance`\");\n\t\treturn;\n\t}\n\n\n\t// Because some browsers don't support this functionality yet\n\tif(!String.prototype.includes) {\n\t\tString.prototype.includes = function() {\n\t\t\t\"use strict\";\n\t\t\treturn String.prototype.indexOf.apply(this, arguments) !== -1;\n\t\t};\n\t}\n\n\n\t// Define the new mode\n\toptions.codeMirrorInstance.defineMode(\"spell-checker\", function(config) {\n\t\t// Load AFF/DIC data\n\t\tif(!CodeMirrorSpellChecker.aff_loading) {\n\t\t\tCodeMirrorSpellChecker.aff_loading = true;\n\t\t\tvar xhr_aff = new XMLHttpRequest();\n\t\t\txhr_aff.open(\"GET\", \"https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.aff\", true);\n\t\t\txhr_aff.onload = function() {\n\t\t\t\tif(xhr_aff.readyState === 4 && xhr_aff.status === 200) {\n\t\t\t\t\tCodeMirrorSpellChecker.aff_data = xhr_aff.responseText;\n\t\t\t\t\tCodeMirrorSpellChecker.num_loaded++;\n\n\t\t\t\t\tif(CodeMirrorSpellChecker.num_loaded == 2) {\n\t\t\t\t\t\tCodeMirrorSpellChecker.typo = new Typo(\"en_US\", CodeMirrorSpellChecker.aff_data, CodeMirrorSpellChecker.dic_data, {\n\t\t\t\t\t\t\tplatform: \"any\"\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\txhr_aff.send(null);\n\t\t}\n\n\t\tif(!CodeMirrorSpellChecker.dic_loading) {\n\t\t\tCodeMirrorSpellChecker.dic_loading = true;\n\t\t\tvar xhr_dic = new XMLHttpRequest();\n\t\t\txhr_dic.open(\"GET\", \"https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.dic\", true);\n\t\t\txhr_dic.onload = function() {\n\t\t\t\tif(xhr_dic.readyState === 4 && xhr_dic.status === 200) {\n\t\t\t\t\tCodeMirrorSpellChecker.dic_data = xhr_dic.responseText;\n\t\t\t\t\tCodeMirrorSpellChecker.num_loaded++;\n\n\t\t\t\t\tif(CodeMirrorSpellChecker.num_loaded == 2) {\n\t\t\t\t\t\tCodeMirrorSpellChecker.typo = new Typo(\"en_US\", CodeMirrorSpellChecker.aff_data, CodeMirrorSpellChecker.dic_data, {\n\t\t\t\t\t\t\tplatform: \"any\"\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\txhr_dic.send(null);\n\t\t}\n\n\n\t\t// Define what separates a word\n\t\tvar rx_word = \"!\\\"#$%&()*+,-./:;<=>?@[\\\\]^_`{|}~ \";\n\n\n\t\t// Create the overlay and such\n\t\tvar overlay = {\n\t\t\ttoken: function(stream) {\n\t\t\t\tvar ch = stream.peek();\n\t\t\t\tvar word = \"\";\n\n\t\t\t\tif(rx_word.includes(ch)) {\n\t\t\t\t\tstream.next();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\twhile((ch = stream.peek()) != null && !rx_word.includes(ch)) {\n\t\t\t\t\tword += ch;\n\t\t\t\t\tstream.next();\n\t\t\t\t}\n\n\t\t\t\tif(CodeMirrorSpellChecker.typo && !CodeMirrorSpellChecker.typo.check(word))\n\t\t\t\t\treturn \"spell-error\"; // CSS class: cm-spell-error\n\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\n\t\tvar mode = options.codeMirrorInstance.getMode(\n\t\t\tconfig, config.backdrop || \"text/plain\"\n\t\t);\n\n\t\treturn options.codeMirrorInstance.overlayMode(mode, overlay, true);\n\t});\n}\n\n\n// Initialize data globally to reduce memory consumption\nCodeMirrorSpellChecker.num_loaded = 0;\nCodeMirrorSpellChecker.aff_loading = false;\nCodeMirrorSpellChecker.dic_loading = false;\nCodeMirrorSpellChecker.aff_data = \"\";\nCodeMirrorSpellChecker.dic_data = \"\";\nCodeMirrorSpellChecker.typo;\n\n\n// Export\nmodule.exports = CodeMirrorSpellChecker;","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Open simple dialogs on top of an editor. Relies on dialog.css.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  function dialogDiv(cm, template, bottom) {\n    var wrap = cm.getWrapperElement();\n    var dialog;\n    dialog = wrap.appendChild(document.createElement(\"div\"));\n    if (bottom)\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-bottom\";\n    else\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-top\";\n\n    if (typeof template == \"string\") {\n      dialog.innerHTML = template;\n    } else { // Assuming it's a detached DOM element.\n      dialog.appendChild(template);\n    }\n    CodeMirror.addClass(wrap, 'dialog-opened');\n    return dialog;\n  }\n\n  function closeNotification(cm, newVal) {\n    if (cm.state.currentNotificationClose)\n      cm.state.currentNotificationClose();\n    cm.state.currentNotificationClose = newVal;\n  }\n\n  CodeMirror.defineExtension(\"openDialog\", function(template, callback, options) {\n    if (!options) options = {};\n\n    closeNotification(this, null);\n\n    var dialog = dialogDiv(this, template, options.bottom);\n    var closed = false, me = this;\n    function close(newVal) {\n      if (typeof newVal == 'string') {\n        inp.value = newVal;\n      } else {\n        if (closed) return;\n        closed = true;\n        CodeMirror.rmClass(dialog.parentNode, 'dialog-opened');\n        dialog.parentNode.removeChild(dialog);\n        me.focus();\n\n        if (options.onClose) options.onClose(dialog);\n      }\n    }\n\n    var inp = dialog.getElementsByTagName(\"input\")[0], button;\n    if (inp) {\n      inp.focus();\n\n      if (options.value) {\n        inp.value = options.value;\n        if (options.selectValueOnOpen !== false) {\n          inp.select();\n        }\n      }\n\n      if (options.onInput)\n        CodeMirror.on(inp, \"input\", function(e) { options.onInput(e, inp.value, close);});\n      if (options.onKeyUp)\n        CodeMirror.on(inp, \"keyup\", function(e) {options.onKeyUp(e, inp.value, close);});\n\n      CodeMirror.on(inp, \"keydown\", function(e) {\n        if (options && options.onKeyDown && options.onKeyDown(e, inp.value, close)) { return; }\n        if (e.keyCode == 27 || (options.closeOnEnter !== false && e.keyCode == 13)) {\n          inp.blur();\n          CodeMirror.e_stop(e);\n          close();\n        }\n        if (e.keyCode == 13) callback(inp.value, e);\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(dialog, \"focusout\", function (evt) {\n        if (evt.relatedTarget !== null) close();\n      });\n    } else if (button = dialog.getElementsByTagName(\"button\")[0]) {\n      CodeMirror.on(button, \"click\", function() {\n        close();\n        me.focus();\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(button, \"blur\", close);\n\n      button.focus();\n    }\n    return close;\n  });\n\n  CodeMirror.defineExtension(\"openConfirm\", function(template, callbacks, options) {\n    closeNotification(this, null);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var buttons = dialog.getElementsByTagName(\"button\");\n    var closed = false, me = this, blurring = 1;\n    function close() {\n      if (closed) return;\n      closed = true;\n      CodeMirror.rmClass(dialog.parentNode, 'dialog-opened');\n      dialog.parentNode.removeChild(dialog);\n      me.focus();\n    }\n    buttons[0].focus();\n    for (var i = 0; i < buttons.length; ++i) {\n      var b = buttons[i];\n      (function(callback) {\n        CodeMirror.on(b, \"click\", function(e) {\n          CodeMirror.e_preventDefault(e);\n          close();\n          if (callback) callback(me);\n        });\n      })(callbacks[i]);\n      CodeMirror.on(b, \"blur\", function() {\n        --blurring;\n        setTimeout(function() { if (blurring <= 0) close(); }, 200);\n      });\n      CodeMirror.on(b, \"focus\", function() { ++blurring; });\n    }\n  });\n\n  /*\n   * openNotification\n   * Opens a notification, that can be closed with an optional timer\n   * (default 5000ms timer) and always closes on click.\n   *\n   * If a notification is opened while another is opened, it will close the\n   * currently opened one and open the new one immediately.\n   */\n  CodeMirror.defineExtension(\"openNotification\", function(template, options) {\n    closeNotification(this, close);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var closed = false, doneTimer;\n    var duration = options && typeof options.duration !== \"undefined\" ? options.duration : 5000;\n\n    function close() {\n      if (closed) return;\n      closed = true;\n      clearTimeout(doneTimer);\n      CodeMirror.rmClass(dialog.parentNode, 'dialog-opened');\n      dialog.parentNode.removeChild(dialog);\n    }\n\n    CodeMirror.on(dialog, 'click', function(e) {\n      CodeMirror.e_preventDefault(e);\n      close();\n    });\n\n    if (duration)\n      doneTimer = setTimeout(close, duration);\n\n    return close;\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"fullScreen\", false, function(cm, val, old) {\n    if (old == CodeMirror.Init) old = false;\n    if (!old == !val) return;\n    if (val) setFullscreen(cm);\n    else setNormal(cm);\n  });\n\n  function setFullscreen(cm) {\n    var wrap = cm.getWrapperElement();\n    cm.state.fullScreenRestore = {scrollTop: window.pageYOffset, scrollLeft: window.pageXOffset,\n                                  width: wrap.style.width, height: wrap.style.height};\n    wrap.style.width = \"\";\n    wrap.style.height = \"auto\";\n    wrap.className += \" CodeMirror-fullscreen\";\n    document.documentElement.style.overflow = \"hidden\";\n    cm.refresh();\n  }\n\n  function setNormal(cm) {\n    var wrap = cm.getWrapperElement();\n    wrap.className = wrap.className.replace(/\\s*CodeMirror-fullscreen\\b/, \"\");\n    document.documentElement.style.overflow = \"\";\n    var info = cm.state.fullScreenRestore;\n    wrap.style.width = info.width; wrap.style.height = info.height;\n    window.scrollTo(info.scrollLeft, info.scrollTop);\n    cm.refresh();\n  }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  CodeMirror.defineOption(\"placeholder\", \"\", function(cm, val, old) {\n    var prev = old && old != CodeMirror.Init;\n    if (val && !prev) {\n      cm.on(\"blur\", onBlur);\n      cm.on(\"change\", onChange);\n      cm.on(\"swapDoc\", onChange);\n      onChange(cm);\n    } else if (!val && prev) {\n      cm.off(\"blur\", onBlur);\n      cm.off(\"change\", onChange);\n      cm.off(\"swapDoc\", onChange);\n      clearPlaceholder(cm);\n      var wrapper = cm.getWrapperElement();\n      wrapper.className = wrapper.className.replace(\" CodeMirror-empty\", \"\");\n    }\n\n    if (val && !cm.hasFocus()) onBlur(cm);\n  });\n\n  function clearPlaceholder(cm) {\n    if (cm.state.placeholder) {\n      cm.state.placeholder.parentNode.removeChild(cm.state.placeholder);\n      cm.state.placeholder = null;\n    }\n  }\n  function setPlaceholder(cm) {\n    clearPlaceholder(cm);\n    var elt = cm.state.placeholder = document.createElement(\"pre\");\n    elt.style.cssText = \"height: 0; overflow: visible\";\n    elt.style.direction = cm.getOption(\"direction\");\n    elt.className = \"CodeMirror-placeholder CodeMirror-line-like\";\n    var placeHolder = cm.getOption(\"placeholder\")\n    if (typeof placeHolder == \"string\") placeHolder = document.createTextNode(placeHolder)\n    elt.appendChild(placeHolder)\n    cm.display.lineSpace.insertBefore(elt, cm.display.lineSpace.firstChild);\n  }\n\n  function onBlur(cm) {\n    if (isEmpty(cm)) setPlaceholder(cm);\n  }\n  function onChange(cm) {\n    var wrapper = cm.getWrapperElement(), empty = isEmpty(cm);\n    wrapper.className = wrapper.className.replace(\" CodeMirror-empty\", \"\") + (empty ? \" CodeMirror-empty\" : \"\");\n\n    if (empty) setPlaceholder(cm);\n    else clearPlaceholder(cm);\n  }\n\n  function isEmpty(cm) {\n    return (cm.lineCount() === 1) && (cm.getLine(0) === \"\");\n  }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var listRE = /^(\\s*)(>[> ]*|[*+-] \\[[x ]\\]\\s|[*+-]\\s|(\\d+)([.)]))(\\s*)/,\n      emptyListRE = /^(\\s*)(>[> ]*|[*+-] \\[[x ]\\]|[*+-]|(\\d+)[.)])(\\s*)$/,\n      unorderedListRE = /[*+-]\\s/;\n\n  CodeMirror.commands.newlineAndIndentContinueMarkdownList = function(cm) {\n    if (cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n    var ranges = cm.listSelections(), replacements = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var pos = ranges[i].head;\n\n      // If we're not in Markdown mode, fall back to normal newlineAndIndent\n      var eolState = cm.getStateAfter(pos.line);\n      var inner = CodeMirror.innerMode(cm.getMode(), eolState);\n      if (inner.mode.name !== \"markdown\") {\n        cm.execCommand(\"newlineAndIndent\");\n        return;\n      } else {\n        eolState = inner.state;\n      }\n\n      var inList = eolState.list !== false;\n      var inQuote = eolState.quote !== 0;\n\n      var line = cm.getLine(pos.line), match = listRE.exec(line);\n      var cursorBeforeBullet = /^\\s*$/.test(line.slice(0, pos.ch));\n      if (!ranges[i].empty() || (!inList && !inQuote) || !match || cursorBeforeBullet) {\n        cm.execCommand(\"newlineAndIndent\");\n        return;\n      }\n      if (emptyListRE.test(line)) {\n        var endOfQuote = inQuote && />\\s*$/.test(line)\n        var endOfList = !/>\\s*$/.test(line)\n        if (endOfQuote || endOfList) cm.replaceRange(\"\", {\n          line: pos.line, ch: 0\n        }, {\n          line: pos.line, ch: pos.ch + 1\n        });\n        replacements[i] = \"\\n\";\n      } else {\n        var indent = match[1], after = match[5];\n        var numbered = !(unorderedListRE.test(match[2]) || match[2].indexOf(\">\") >= 0);\n        var bullet = numbered ? (parseInt(match[3], 10) + 1) + match[4] : match[2].replace(\"x\", \" \");\n        replacements[i] = \"\\n\" + indent + bullet + after;\n\n        if (numbered) incrementRemainingMarkdownListNumbers(cm, pos);\n      }\n    }\n\n    cm.replaceSelections(replacements);\n  };\n\n  // Auto-updating Markdown list numbers when a new item is added to the\n  // middle of a list\n  function incrementRemainingMarkdownListNumbers(cm, pos) {\n    var startLine = pos.line, lookAhead = 0, skipCount = 0;\n    var startItem = listRE.exec(cm.getLine(startLine)), startIndent = startItem[1];\n\n    do {\n      lookAhead += 1;\n      var nextLineNumber = startLine + lookAhead;\n      var nextLine = cm.getLine(nextLineNumber), nextItem = listRE.exec(nextLine);\n\n      if (nextItem) {\n        var nextIndent = nextItem[1];\n        var newNumber = (parseInt(startItem[3], 10) + lookAhead - skipCount);\n        var nextNumber = (parseInt(nextItem[3], 10)), itemNumber = nextNumber;\n\n        if (startIndent === nextIndent && !isNaN(nextNumber)) {\n          if (newNumber === nextNumber) itemNumber = nextNumber + 1;\n          if (newNumber > nextNumber) itemNumber = newNumber + 1;\n          cm.replaceRange(\n            nextLine.replace(listRE, nextIndent + itemNumber + nextItem[4] + nextItem[5]),\n          {\n            line: nextLineNumber, ch: 0\n          }, {\n            line: nextLineNumber, ch: nextLine.length\n          });\n        } else {\n          if (startIndent.length > nextIndent.length) return;\n          // This doesn't run if the next line immediatley indents, as it is\n          // not clear of the users intention (new indented item or same level)\n          if ((startIndent.length < nextIndent.length) && (lookAhead === 1)) return;\n          skipCount += 1;\n        }\n      }\n    } while (nextItem);\n  }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var ie_lt8 = /MSIE \\d/.test(navigator.userAgent) &&\n    (document.documentMode == null || document.documentMode < 8);\n\n  var Pos = CodeMirror.Pos;\n\n  var matching = {\"(\": \")>\", \")\": \"(<\", \"[\": \"]>\", \"]\": \"[<\", \"{\": \"}>\", \"}\": \"{<\", \"<\": \">>\", \">\": \"<<\"};\n\n  function bracketRegex(config) {\n    return config && config.bracketRegex || /[(){}[\\]]/\n  }\n\n  function findMatchingBracket(cm, where, config) {\n    var line = cm.getLineHandle(where.line), pos = where.ch - 1;\n    var afterCursor = config && config.afterCursor\n    if (afterCursor == null)\n      afterCursor = /(^| )cm-fat-cursor($| )/.test(cm.getWrapperElement().className)\n    var re = bracketRegex(config)\n\n    // A cursor is defined as between two characters, but in in vim command mode\n    // (i.e. not insert mode), the cursor is visually represented as a\n    // highlighted box on top of the 2nd character. Otherwise, we allow matches\n    // from before or after the cursor.\n    var match = (!afterCursor && pos >= 0 && re.test(line.text.charAt(pos)) && matching[line.text.charAt(pos)]) ||\n        re.test(line.text.charAt(pos + 1)) && matching[line.text.charAt(++pos)];\n    if (!match) return null;\n    var dir = match.charAt(1) == \">\" ? 1 : -1;\n    if (config && config.strict && (dir > 0) != (pos == where.ch)) return null;\n    var style = cm.getTokenTypeAt(Pos(where.line, pos + 1));\n\n    var found = scanForBracket(cm, Pos(where.line, pos + (dir > 0 ? 1 : 0)), dir, style || null, config);\n    if (found == null) return null;\n    return {from: Pos(where.line, pos), to: found && found.pos,\n            match: found && found.ch == match.charAt(0), forward: dir > 0};\n  }\n\n  // bracketRegex is used to specify which type of bracket to scan\n  // should be a regexp, e.g. /[[\\]]/\n  //\n  // Note: If \"where\" is on an open bracket, then this bracket is ignored.\n  //\n  // Returns false when no bracket was found, null when it reached\n  // maxScanLines and gave up\n  function scanForBracket(cm, where, dir, style, config) {\n    var maxScanLen = (config && config.maxScanLineLength) || 10000;\n    var maxScanLines = (config && config.maxScanLines) || 1000;\n\n    var stack = [];\n    var re = bracketRegex(config)\n    var lineEnd = dir > 0 ? Math.min(where.line + maxScanLines, cm.lastLine() + 1)\n                          : Math.max(cm.firstLine() - 1, where.line - maxScanLines);\n    for (var lineNo = where.line; lineNo != lineEnd; lineNo += dir) {\n      var line = cm.getLine(lineNo);\n      if (!line) continue;\n      var pos = dir > 0 ? 0 : line.length - 1, end = dir > 0 ? line.length : -1;\n      if (line.length > maxScanLen) continue;\n      if (lineNo == where.line) pos = where.ch - (dir < 0 ? 1 : 0);\n      for (; pos != end; pos += dir) {\n        var ch = line.charAt(pos);\n        if (re.test(ch) && (style === undefined || cm.getTokenTypeAt(Pos(lineNo, pos + 1)) == style)) {\n          var match = matching[ch];\n          if (match && (match.charAt(1) == \">\") == (dir > 0)) stack.push(ch);\n          else if (!stack.length) return {pos: Pos(lineNo, pos), ch: ch};\n          else stack.pop();\n        }\n      }\n    }\n    return lineNo - dir == (dir > 0 ? cm.lastLine() : cm.firstLine()) ? false : null;\n  }\n\n  function matchBrackets(cm, autoclear, config) {\n    // Disable brace matching in long lines, since it'll cause hugely slow updates\n    var maxHighlightLen = cm.state.matchBrackets.maxHighlightLineLength || 1000;\n    var marks = [], ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      var match = ranges[i].empty() && findMatchingBracket(cm, ranges[i].head, config);\n      if (match && cm.getLine(match.from.line).length <= maxHighlightLen) {\n        var style = match.match ? \"CodeMirror-matchingbracket\" : \"CodeMirror-nonmatchingbracket\";\n        marks.push(cm.markText(match.from, Pos(match.from.line, match.from.ch + 1), {className: style}));\n        if (match.to && cm.getLine(match.to.line).length <= maxHighlightLen)\n          marks.push(cm.markText(match.to, Pos(match.to.line, match.to.ch + 1), {className: style}));\n      }\n    }\n\n    if (marks.length) {\n      // Kludge to work around the IE bug from issue #1193, where text\n      // input stops going to the textare whever this fires.\n      if (ie_lt8 && cm.state.focused) cm.focus();\n\n      var clear = function() {\n        cm.operation(function() {\n          for (var i = 0; i < marks.length; i++) marks[i].clear();\n        });\n      };\n      if (autoclear) setTimeout(clear, 800);\n      else return clear;\n    }\n  }\n\n  function doMatchBrackets(cm) {\n    cm.operation(function() {\n      if (cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n      cm.state.matchBrackets.currentlyHighlighted = matchBrackets(cm, false, cm.state.matchBrackets);\n    });\n  }\n\n  CodeMirror.defineOption(\"matchBrackets\", false, function(cm, val, old) {\n    function clear(cm) {\n      if (cm.state.matchBrackets && cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n    }\n\n    if (old && old != CodeMirror.Init) {\n      cm.off(\"cursorActivity\", doMatchBrackets);\n      cm.off(\"focus\", doMatchBrackets)\n      cm.off(\"blur\", clear)\n      clear(cm);\n    }\n    if (val) {\n      cm.state.matchBrackets = typeof val == \"object\" ? val : {};\n      cm.on(\"cursorActivity\", doMatchBrackets);\n      cm.on(\"focus\", doMatchBrackets)\n      cm.on(\"blur\", clear)\n    }\n  });\n\n  CodeMirror.defineExtension(\"matchBrackets\", function() {matchBrackets(this, true);});\n  CodeMirror.defineExtension(\"findMatchingBracket\", function(pos, config, oldConfig){\n    // Backwards-compatibility kludge\n    if (oldConfig || typeof config == \"boolean\") {\n      if (!oldConfig) {\n        config = config ? {strict: true} : null\n      } else {\n        oldConfig.strict = config\n        config = oldConfig\n      }\n    }\n    return findMatchingBracket(this, pos, config)\n  });\n  CodeMirror.defineExtension(\"scanForBracket\", function(pos, dir, style, config){\n    return scanForBracket(this, pos, dir, style, config);\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    options = parseOptions(this, this.getCursor(\"start\"), options);\n    var selections = this.listSelections()\n    if (selections.length > 1) return;\n    // By default, don't allow completion when something is selected.\n    // A hint function can have a `supportsSelection` property to\n    // indicate that it can handle selections.\n    if (this.somethingSelected()) {\n      if (!options.hint.supportsSelection) return;\n      // Don't try with cross-line selections\n      for (var i = 0; i < selections.length; i++)\n        if (selections[i].head.line != selections[i].anchor.line) return;\n    }\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    if (!completion.options.hint) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    completion.update(true);\n  });\n\n  CodeMirror.defineExtension(\"closeHint\", function() {\n    if (this.state.completionActive) this.state.completionActive.close()\n  })\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.widget = null;\n    this.debounce = 0;\n    this.tick = 0;\n    this.startPos = this.cm.getCursor(\"start\");\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\n\n    var self = this;\n    cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\n  }\n\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n    return setTimeout(fn, 1000/60);\n  };\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n      this.tick = null;\n      this.cm.off(\"cursorActivity\", this.activityFunc);\n\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\n      if (this.widget) this.widget.close();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i], self = this;\n      this.cm.operation(function() {\n        if (completion.hint)\n          completion.hint(self.cm, data, completion);\n        else\n          self.cm.replaceRange(getText(completion), completion.from || data.from,\n                               completion.to || data.to, \"complete\");\n        CodeMirror.signal(data, \"pick\", completion);\n        self.cm.scrollIntoView();\n      })\n      this.close();\n    },\n\n    cursorActivity: function() {\n      if (this.debounce) {\n        cancelAnimationFrame(this.debounce);\n        this.debounce = 0;\n      }\n\n      var identStart = this.startPos;\n      if(this.data) {\n        identStart = this.data.from;\n      }\n\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\n          pos.ch < identStart.ch || this.cm.somethingSelected() ||\n          (!pos.ch || this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\n        this.close();\n      } else {\n        var self = this;\n        this.debounce = requestAnimationFrame(function() {self.update();});\n        if (this.widget) this.widget.disable();\n      }\n    },\n\n    update: function(first) {\n      if (this.tick == null) return\n      var self = this, myTick = ++this.tick\n      fetchHints(this.options.hint, this.cm, this.options, function(data) {\n        if (self.tick == myTick) self.finishUpdate(data, first)\n      })\n    },\n\n    finishUpdate: function(data, first) {\n      if (this.data) CodeMirror.signal(this.data, \"update\");\n\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\n      if (this.widget) this.widget.close();\n\n      this.data = data;\n\n      if (data && data.list.length) {\n        if (picked && data.list.length == 1) {\n          this.pick(data, 0);\n        } else {\n          this.widget = new Widget(this, data);\n          CodeMirror.signal(data, \"shown\");\n        }\n      }\n    }\n  };\n\n  function parseOptions(cm, pos, options) {\n    var editor = cm.options.hintOptions;\n    var out = {};\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n    if (editor) for (var prop in editor)\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\n    if (options) for (var prop in options)\n      if (options[prop] !== undefined) out[prop] = options[prop];\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\n    return out;\n  }\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else return completion.text;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n\n    var mac = /Mac/.test(navigator.platform);\n\n    if (mac) {\n      baseMap[\"Ctrl-P\"] = function() {handle.moveFocus(-1);};\n      baseMap[\"Ctrl-N\"] = function() {handle.moveFocus(1);};\n    }\n\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    this.picked = false;\n    var widget = this, cm = completion.cm;\n    var ownerDocument = cm.getInputField().ownerDocument;\n    var parentWindow = ownerDocument.defaultView || ownerDocument.parentWindow;\n\n    var hints = this.hints = ownerDocument.createElement(\"ul\");\n    var theme = completion.cm.options.theme;\n    hints.className = \"CodeMirror-hints \" + theme;\n    this.selectedHint = data.selectedHint || 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(ownerDocument.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else elt.appendChild(ownerDocument.createTextNode(cur.displayText || getText(cur)));\n      elt.hintId = i;\n    }\n\n    var container = completion.options.container || ownerDocument.body;\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    var offsetLeft = 0, offsetTop = 0;\n    if (container !== ownerDocument.body) {\n      // We offset the cursor position because left and top are relative to the offsetParent's top left corner.\n      var isContainerPositioned = ['absolute', 'relative', 'fixed'].indexOf(parentWindow.getComputedStyle(container).position) !== -1;\n      var offsetParent = isContainerPositioned ? container : container.offsetParent;\n      var offsetParentPosition = offsetParent.getBoundingClientRect();\n      var bodyPosition = ownerDocument.body.getBoundingClientRect();\n      offsetLeft = (offsetParentPosition.left - bodyPosition.left - offsetParent.scrollLeft);\n      offsetTop = (offsetParentPosition.top - bodyPosition.top - offsetParent.scrollTop);\n    }\n    hints.style.left = (left - offsetLeft) + \"px\";\n    hints.style.top = (top - offsetTop) + \"px\";\n\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = parentWindow.innerWidth || Math.max(ownerDocument.body.offsetWidth, ownerDocument.documentElement.offsetWidth);\n    var winH = parentWindow.innerHeight || Math.max(ownerDocument.body.offsetHeight, ownerDocument.documentElement.offsetHeight);\n    container.appendChild(hints);\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\n    var scrolls = hints.scrollHeight > hints.clientHeight + 1\n    var startScroll = cm.getScrollInfo();\n\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height - offsetTop) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top - offsetTop) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left - offsetLeft) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX - offsetLeft) + \"px\";\n    }\n    if (scrolls) for (var node = hints.firstChild; node; node = node.nextSibling)\n      node.style.paddingRight = cm.display.nativeBarWidth + \"px\"\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (parentWindow.pageYOffset || (ownerDocument.documentElement || ownerDocument.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n    this.scrollToActive()\n\n    CodeMirror.signal(data, \"select\", completions[this.selectedHint], hints.childNodes[this.selectedHint]);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    disable: function() {\n      this.completion.cm.removeKeyMap(this.keyMap);\n      var widget = this;\n      this.keyMap = {Enter: function() { widget.picked = true; }};\n      this.completion.cm.addKeyMap(this.keyMap);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      if (node) node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      this.scrollToActive()\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    scrollToActive: function() {\n      var node = this.hints.childNodes[this.selectedHint]\n      var firstNode = this.hints.firstChild;\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - firstNode.offsetTop;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + firstNode.offsetTop;\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n\n  function applicableHelpers(cm, helpers) {\n    if (!cm.somethingSelected()) return helpers\n    var result = []\n    for (var i = 0; i < helpers.length; i++)\n      if (helpers[i].supportsSelection) result.push(helpers[i])\n    return result\n  }\n\n  function fetchHints(hint, cm, options, callback) {\n    if (hint.async) {\n      hint(cm, callback, options)\n    } else {\n      var result = hint(cm, options)\n      if (result && result.then) result.then(callback)\n      else callback(result)\n    }\n  }\n\n  function resolveAutoHints(cm, pos) {\n    var helpers = cm.getHelpers(pos, \"hint\"), words\n    if (helpers.length) {\n      var resolved = function(cm, callback, options) {\n        var app = applicableHelpers(cm, helpers);\n        function run(i) {\n          if (i == app.length) return callback(null)\n          fetchHints(app[i], cm, options, function(result) {\n            if (result && result.list.length > 0) callback(result)\n            else run(i + 1)\n          })\n        }\n        run(0)\n      }\n      resolved.async = true\n      resolved.supportsSelection = true\n      return resolved\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\n    } else if (CodeMirror.hint.anyword) {\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\n    } else {\n      return function() {}\n    }\n  }\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\n    resolve: resolveAutoHints\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur)\n    var term, from = CodeMirror.Pos(cur.line, token.start), to = cur\n    if (token.start < cur.ch && /\\w/.test(token.string.charAt(cur.ch - token.start - 1))) {\n      term = token.string.substr(0, cur.ch - token.start)\n    } else {\n      term = \"\"\n      from = cur\n    }\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, term.length) == term)\n        found.push(word);\n    }\n\n    if (found.length) return {list: found, from: from, to: to};\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnUnfocus: true,\n    completeOnSingleClick: true,\n    container: null,\n    customKeys: null,\n    extraKeys: null\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Utility function that allows modes to be combined. The mode given\n// as the base argument takes care of most of the normal mode\n// functionality, but a second (typically simple) mode is used, which\n// can override the style of text. Both modes get to parse all of the\n// text, but when both assign a non-null style to a piece of code, the\n// overlay wins, unless the combine argument was true and not overridden,\n// or state.overlay.combineTokens was true, in which case the styles are\n// combined.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.overlayMode = function(base, overlay, combine) {\n  return {\n    startState: function() {\n      return {\n        base: CodeMirror.startState(base),\n        overlay: CodeMirror.startState(overlay),\n        basePos: 0, baseCur: null,\n        overlayPos: 0, overlayCur: null,\n        streamSeen: null\n      };\n    },\n    copyState: function(state) {\n      return {\n        base: CodeMirror.copyState(base, state.base),\n        overlay: CodeMirror.copyState(overlay, state.overlay),\n        basePos: state.basePos, baseCur: null,\n        overlayPos: state.overlayPos, overlayCur: null\n      };\n    },\n\n    token: function(stream, state) {\n      if (stream != state.streamSeen ||\n          Math.min(state.basePos, state.overlayPos) < stream.start) {\n        state.streamSeen = stream;\n        state.basePos = state.overlayPos = stream.start;\n      }\n\n      if (stream.start == state.basePos) {\n        state.baseCur = base.token(stream, state.base);\n        state.basePos = stream.pos;\n      }\n      if (stream.start == state.overlayPos) {\n        stream.pos = stream.start;\n        state.overlayCur = overlay.token(stream, state.overlay);\n        state.overlayPos = stream.pos;\n      }\n      stream.pos = Math.min(state.basePos, state.overlayPos);\n\n      // state.overlay.combineTokens always takes precedence over combine,\n      // unless set to null\n      if (state.overlayCur == null) return state.baseCur;\n      else if (state.baseCur != null &&\n               state.overlay.combineTokens ||\n               combine && state.overlay.combineTokens == null)\n        return state.baseCur + \" \" + state.overlayCur;\n      else return state.overlayCur;\n    },\n\n    indent: base.indent && function(state, textAfter, line) {\n      return base.indent(state.base, textAfter, line);\n    },\n    electricChars: base.electricChars,\n\n    innerMode: function(state) { return {state: state.base, mode: base}; },\n\n    blankLine: function(state) {\n      var baseToken, overlayToken;\n      if (base.blankLine) baseToken = base.blankLine(state.base);\n      if (overlay.blankLine) overlayToken = overlay.blankLine(state.overlay);\n\n      return overlayToken == null ?\n        baseToken :\n        (combine && baseToken != null ? baseToken + \" \" + overlayToken : overlayToken);\n    }\n  };\n};\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"))\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod)\n  else // Plain browser env\n    mod(CodeMirror)\n})(function(CodeMirror) {\n  \"use strict\"\n  var Pos = CodeMirror.Pos\n\n  function regexpFlags(regexp) {\n    var flags = regexp.flags\n    return flags != null ? flags : (regexp.ignoreCase ? \"i\" : \"\")\n      + (regexp.global ? \"g\" : \"\")\n      + (regexp.multiline ? \"m\" : \"\")\n  }\n\n  function ensureFlags(regexp, flags) {\n    var current = regexpFlags(regexp), target = current\n    for (var i = 0; i < flags.length; i++) if (target.indexOf(flags.charAt(i)) == -1)\n      target += flags.charAt(i)\n    return current == target ? regexp : new RegExp(regexp.source, target)\n  }\n\n  function maybeMultiline(regexp) {\n    return /\\\\s|\\\\n|\\n|\\\\W|\\\\D|\\[\\^/.test(regexp.source)\n  }\n\n  function searchRegexpForward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, last = doc.lastLine(); line <= last; line++, ch = 0) {\n      regexp.lastIndex = ch\n      var string = doc.getLine(line), match = regexp.exec(string)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpForwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpForward(doc, regexp, start)\n\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, last = doc.lastLine(); line <= last;) {\n      // This grows the search buffer in exponentially-sized chunks\n      // between matches, so that nearby matches are fast and don't\n      // require concatenating the whole document (in case we're\n      // searching for something that has tons of matches), but at the\n      // same time, the amount of retries is limited.\n      for (var i = 0; i < chunk; i++) {\n        if (line > last) break\n        var curLine = doc.getLine(line++)\n        string = string == null ? curLine : string + \"\\n\" + curLine\n      }\n      chunk = chunk * 2\n      regexp.lastIndex = start.ch\n      var match = regexp.exec(string)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = start.line + before.length - 1, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  function lastMatchIn(string, regexp, endMargin) {\n    var match, from = 0\n    while (from <= string.length) {\n      regexp.lastIndex = from\n      var newMatch = regexp.exec(string)\n      if (!newMatch) break\n      var end = newMatch.index + newMatch[0].length\n      if (end > string.length - endMargin) break\n      if (!match || end > match.index + match[0].length)\n        match = newMatch\n      from = newMatch.index + 1\n    }\n    return match\n  }\n\n  function searchRegexpBackward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, first = doc.firstLine(); line >= first; line--, ch = -1) {\n      var string = doc.getLine(line)\n      var match = lastMatchIn(string, regexp, ch < 0 ? 0 : string.length - ch)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpBackwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpBackward(doc, regexp, start)\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunkSize = 1, endMargin = doc.getLine(start.line).length - start.ch\n    for (var line = start.line, first = doc.firstLine(); line >= first;) {\n      for (var i = 0; i < chunkSize && line >= first; i++) {\n        var curLine = doc.getLine(line--)\n        string = string == null ? curLine : curLine + \"\\n\" + string\n      }\n      chunkSize *= 2\n\n      var match = lastMatchIn(string, regexp, endMargin)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = line + before.length, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  var doFold, noFold\n  if (String.prototype.normalize) {\n    doFold = function(str) { return str.normalize(\"NFD\").toLowerCase() }\n    noFold = function(str) { return str.normalize(\"NFD\") }\n  } else {\n    doFold = function(str) { return str.toLowerCase() }\n    noFold = function(str) { return str }\n  }\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos, foldFunc) {\n    if (orig.length == folded.length) return pos\n    for (var min = 0, max = pos + Math.max(0, orig.length - folded.length);;) {\n      if (min == max) return min\n      var mid = (min + max) >> 1\n      var len = foldFunc(orig.slice(0, mid)).length\n      if (len == pos) return mid\n      else if (len > pos) max = mid\n      else min = mid + 1\n    }\n  }\n\n  function searchStringForward(doc, query, start, caseFold) {\n    // Empty string would match anything and never progress, so we\n    // define it to match nothing instead.\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, last = doc.lastLine() + 1 - lines.length; line <= last; line++, ch = 0) {\n      var orig = doc.getLine(line).slice(ch), string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.indexOf(lines[0])\n        if (found == -1) continue search\n        var start = adjustPos(orig, string, found, fold) + ch\n        return {from: Pos(line, adjustPos(orig, string, found, fold) + ch),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold) + ch)}\n      } else {\n        var cutFrom = string.length - lines[0].length\n        if (string.slice(cutFrom) != lines[0]) continue search\n        for (var i = 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(line + i)) != lines[i]) continue search\n        var end = doc.getLine(line + lines.length - 1), endString = fold(end), lastLine = lines[lines.length - 1]\n        if (endString.slice(0, lastLine.length) != lastLine) continue search\n        return {from: Pos(line, adjustPos(orig, string, cutFrom, fold) + ch),\n                to: Pos(line + lines.length - 1, adjustPos(end, endString, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function searchStringBackward(doc, query, start, caseFold) {\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, first = doc.firstLine() - 1 + lines.length; line >= first; line--, ch = -1) {\n      var orig = doc.getLine(line)\n      if (ch > -1) orig = orig.slice(0, ch)\n      var string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.lastIndexOf(lines[0])\n        if (found == -1) continue search\n        return {from: Pos(line, adjustPos(orig, string, found, fold)),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold))}\n      } else {\n        var lastLine = lines[lines.length - 1]\n        if (string.slice(0, lastLine.length) != lastLine) continue search\n        for (var i = 1, start = line - lines.length + 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(start + i)) != lines[i]) continue search\n        var top = doc.getLine(line + 1 - lines.length), topString = fold(top)\n        if (topString.slice(topString.length - lines[0].length) != lines[0]) continue search\n        return {from: Pos(line + 1 - lines.length, adjustPos(top, topString, top.length - lines[0].length, fold)),\n                to: Pos(line, adjustPos(orig, string, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function SearchCursor(doc, query, pos, options) {\n    this.atOccurrence = false\n    this.doc = doc\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0)\n    this.pos = {from: pos, to: pos}\n\n    var caseFold\n    if (typeof options == \"object\") {\n      caseFold = options.caseFold\n    } else { // Backwards compat for when caseFold was the 4th argument\n      caseFold = options\n      options = null\n    }\n\n    if (typeof query == \"string\") {\n      if (caseFold == null) caseFold = false\n      this.matches = function(reverse, pos) {\n        return (reverse ? searchStringBackward : searchStringForward)(doc, query, pos, caseFold)\n      }\n    } else {\n      query = ensureFlags(query, \"gm\")\n      if (!options || options.multiline !== false)\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackwardMultiline : searchRegexpForwardMultiline)(doc, query, pos)\n        }\n      else\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackward : searchRegexpForward)(doc, query, pos)\n        }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false)},\n    findPrevious: function() {return this.find(true)},\n\n    find: function(reverse) {\n      var result = this.matches(reverse, this.doc.clipPos(reverse ? this.pos.from : this.pos.to))\n\n      // Implements weird auto-growing behavior on null-matches for\n      // backwards-compatibility with the vim code (unfortunately)\n      while (result && CodeMirror.cmpPos(result.from, result.to) == 0) {\n        if (reverse) {\n          if (result.from.ch) result.from = Pos(result.from.line, result.from.ch - 1)\n          else if (result.from.line == this.doc.firstLine()) result = null\n          else result = this.matches(reverse, this.doc.clipPos(Pos(result.from.line - 1)))\n        } else {\n          if (result.to.ch < this.doc.getLine(result.to.line).length) result.to = Pos(result.to.line, result.to.ch + 1)\n          else if (result.to.line == this.doc.lastLine()) result = null\n          else result = this.matches(reverse, Pos(result.to.line + 1, 0))\n        }\n      }\n\n      if (result) {\n        this.pos = result\n        this.atOccurrence = true\n        return this.pos.match || true\n      } else {\n        var end = Pos(reverse ? this.doc.firstLine() : this.doc.lastLine() + 1, 0)\n        this.pos = {from: end, to: end}\n        return this.atOccurrence = false\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from},\n    to: function() {if (this.atOccurrence) return this.pos.to},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return\n      var lines = CodeMirror.splitLines(newText)\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin)\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0))\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold)\n  })\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold)\n  })\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = []\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold)\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break\n      ranges.push({anchor: cur.from(), head: cur.to()})\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0)\n  })\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Because sometimes you need to mark the selected *text*.\n//\n// Adds an option 'styleSelectedText' which, when enabled, gives\n// selected text the CSS class given as option value, or\n// \"CodeMirror-selectedtext\" when the value is not a string.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"styleSelectedText\", false, function(cm, val, old) {\n    var prev = old && old != CodeMirror.Init;\n    if (val && !prev) {\n      cm.state.markedSelection = [];\n      cm.state.markedSelectionStyle = typeof val == \"string\" ? val : \"CodeMirror-selectedtext\";\n      reset(cm);\n      cm.on(\"cursorActivity\", onCursorActivity);\n      cm.on(\"change\", onChange);\n    } else if (!val && prev) {\n      cm.off(\"cursorActivity\", onCursorActivity);\n      cm.off(\"change\", onChange);\n      clear(cm);\n      cm.state.markedSelection = cm.state.markedSelectionStyle = null;\n    }\n  });\n\n  function onCursorActivity(cm) {\n    if (cm.state.markedSelection)\n      cm.operation(function() { update(cm); });\n  }\n\n  function onChange(cm) {\n    if (cm.state.markedSelection && cm.state.markedSelection.length)\n      cm.operation(function() { clear(cm); });\n  }\n\n  var CHUNK_SIZE = 8;\n  var Pos = CodeMirror.Pos;\n  var cmp = CodeMirror.cmpPos;\n\n  function coverRange(cm, from, to, addAt) {\n    if (cmp(from, to) == 0) return;\n    var array = cm.state.markedSelection;\n    var cls = cm.state.markedSelectionStyle;\n    for (var line = from.line;;) {\n      var start = line == from.line ? from : Pos(line, 0);\n      var endLine = line + CHUNK_SIZE, atEnd = endLine >= to.line;\n      var end = atEnd ? to : Pos(endLine, 0);\n      var mark = cm.markText(start, end, {className: cls});\n      if (addAt == null) array.push(mark);\n      else array.splice(addAt++, 0, mark);\n      if (atEnd) break;\n      line = endLine;\n    }\n  }\n\n  function clear(cm) {\n    var array = cm.state.markedSelection;\n    for (var i = 0; i < array.length; ++i) array[i].clear();\n    array.length = 0;\n  }\n\n  function reset(cm) {\n    clear(cm);\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++)\n      coverRange(cm, ranges[i].from(), ranges[i].to());\n  }\n\n  function update(cm) {\n    if (!cm.somethingSelected()) return clear(cm);\n    if (cm.listSelections().length > 1) return reset(cm);\n\n    var from = cm.getCursor(\"start\"), to = cm.getCursor(\"end\");\n\n    var array = cm.state.markedSelection;\n    if (!array.length) return coverRange(cm, from, to);\n\n    var coverStart = array[0].find(), coverEnd = array[array.length - 1].find();\n    if (!coverStart || !coverEnd || to.line - from.line <= CHUNK_SIZE ||\n        cmp(from, coverEnd.to) >= 0 || cmp(to, coverStart.from) <= 0)\n      return reset(cm);\n\n    while (cmp(from, coverStart.from) > 0) {\n      array.shift().clear();\n      coverStart = array[0].find();\n    }\n    if (cmp(from, coverStart.from) < 0) {\n      if (coverStart.to.line - from.line < CHUNK_SIZE) {\n        array.shift().clear();\n        coverRange(cm, from, coverStart.to, 0);\n      } else {\n        coverRange(cm, from, coverStart.from, 0);\n      }\n    }\n\n    while (cmp(to, coverEnd.to) < 0) {\n      array.pop().clear();\n      coverEnd = array[array.length - 1].find();\n    }\n    if (cmp(to, coverEnd.to) > 0) {\n      if (to.line - coverEnd.from.line < CHUNK_SIZE) {\n        array.pop().clear();\n        coverRange(cm, coverEnd.from, to);\n      } else {\n        coverRange(cm, coverEnd.to, to);\n      }\n    }\n  }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n/**\n * Supported keybindings:\n *   Too many to list. Refer to defaultKeymap below.\n *\n * Supported Ex commands:\n *   Refer to defaultExCommandMap below.\n *\n * Registers: unnamed, -, a-z, A-Z, 0-9\n *   (Does not respect the special case for number registers when delete\n *    operator is made with these commands: %, (, ),  , /, ?, n, N, {, } )\n *   TODO: Implement the remaining registers.\n *\n * Marks: a-z, A-Z, and 0-9\n *   TODO: Implement the remaining special marks. They have more complex\n *       behavior.\n *\n * Events:\n *  'vim-mode-change' - raised on the editor anytime the current mode changes,\n *                      Event object: {mode: \"visual\", subMode: \"linewise\"}\n *\n * Code structure:\n *  1. Default keymap\n *  2. Variable declarations and short basic helpers\n *  3. Instance (External API) implementation\n *  4. Internal state tracking objects (input state, counter) implementation\n *     and instantiation\n *  5. Key handler (the main command dispatcher) implementation\n *  6. Motion, operator, and action implementations\n *  7. Helper functions for the key handler, motions, operators, and actions\n *  8. Set up Vim to work as a keymap for CodeMirror.\n *  9. Ex command implementations.\n */\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../lib/codemirror\"), require(\"../addon/search/searchcursor\"), require(\"../addon/dialog/dialog\"), require(\"../addon/edit/matchbrackets.js\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../lib/codemirror\", \"../addon/search/searchcursor\", \"../addon/dialog/dialog\", \"../addon/edit/matchbrackets\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  'use strict';\n\n  var defaultKeymap = [\n    // Key to key mapping. This goes first to make it possible to override\n    // existing mappings.\n    { keys: '<Left>', type: 'keyToKey', toKeys: 'h' },\n    { keys: '<Right>', type: 'keyToKey', toKeys: 'l' },\n    { keys: '<Up>', type: 'keyToKey', toKeys: 'k' },\n    { keys: '<Down>', type: 'keyToKey', toKeys: 'j' },\n    { keys: '<Space>', type: 'keyToKey', toKeys: 'l' },\n    { keys: '<BS>', type: 'keyToKey', toKeys: 'h', context: 'normal'},\n    { keys: '<Del>', type: 'keyToKey', toKeys: 'x', context: 'normal'},\n    { keys: '<C-Space>', type: 'keyToKey', toKeys: 'W' },\n    { keys: '<C-BS>', type: 'keyToKey', toKeys: 'B', context: 'normal' },\n    { keys: '<S-Space>', type: 'keyToKey', toKeys: 'w' },\n    { keys: '<S-BS>', type: 'keyToKey', toKeys: 'b', context: 'normal' },\n    { keys: '<C-n>', type: 'keyToKey', toKeys: 'j' },\n    { keys: '<C-p>', type: 'keyToKey', toKeys: 'k' },\n    { keys: '<C-[>', type: 'keyToKey', toKeys: '<Esc>' },\n    { keys: '<C-c>', type: 'keyToKey', toKeys: '<Esc>' },\n    { keys: '<C-[>', type: 'keyToKey', toKeys: '<Esc>', context: 'insert' },\n    { keys: '<C-c>', type: 'keyToKey', toKeys: '<Esc>', context: 'insert' },\n    { keys: 's', type: 'keyToKey', toKeys: 'cl', context: 'normal' },\n    { keys: 's', type: 'keyToKey', toKeys: 'c', context: 'visual'},\n    { keys: 'S', type: 'keyToKey', toKeys: 'cc', context: 'normal' },\n    { keys: 'S', type: 'keyToKey', toKeys: 'VdO', context: 'visual' },\n    { keys: '<Home>', type: 'keyToKey', toKeys: '0' },\n    { keys: '<End>', type: 'keyToKey', toKeys: '$' },\n    { keys: '<PageUp>', type: 'keyToKey', toKeys: '<C-b>' },\n    { keys: '<PageDown>', type: 'keyToKey', toKeys: '<C-f>' },\n    { keys: '<CR>', type: 'keyToKey', toKeys: 'j^', context: 'normal' },\n    { keys: '<Ins>', type: 'action', action: 'toggleOverwrite', context: 'insert' },\n    // Motions\n    { keys: 'H', type: 'motion', motion: 'moveToTopLine', motionArgs: { linewise: true, toJumplist: true }},\n    { keys: 'M', type: 'motion', motion: 'moveToMiddleLine', motionArgs: { linewise: true, toJumplist: true }},\n    { keys: 'L', type: 'motion', motion: 'moveToBottomLine', motionArgs: { linewise: true, toJumplist: true }},\n    { keys: 'h', type: 'motion', motion: 'moveByCharacters', motionArgs: { forward: false }},\n    { keys: 'l', type: 'motion', motion: 'moveByCharacters', motionArgs: { forward: true }},\n    { keys: 'j', type: 'motion', motion: 'moveByLines', motionArgs: { forward: true, linewise: true }},\n    { keys: 'k', type: 'motion', motion: 'moveByLines', motionArgs: { forward: false, linewise: true }},\n    { keys: 'gj', type: 'motion', motion: 'moveByDisplayLines', motionArgs: { forward: true }},\n    { keys: 'gk', type: 'motion', motion: 'moveByDisplayLines', motionArgs: { forward: false }},\n    { keys: 'w', type: 'motion', motion: 'moveByWords', motionArgs: { forward: true, wordEnd: false }},\n    { keys: 'W', type: 'motion', motion: 'moveByWords', motionArgs: { forward: true, wordEnd: false, bigWord: true }},\n    { keys: 'e', type: 'motion', motion: 'moveByWords', motionArgs: { forward: true, wordEnd: true, inclusive: true }},\n    { keys: 'E', type: 'motion', motion: 'moveByWords', motionArgs: { forward: true, wordEnd: true, bigWord: true, inclusive: true }},\n    { keys: 'b', type: 'motion', motion: 'moveByWords', motionArgs: { forward: false, wordEnd: false }},\n    { keys: 'B', type: 'motion', motion: 'moveByWords', motionArgs: { forward: false, wordEnd: false, bigWord: true }},\n    { keys: 'ge', type: 'motion', motion: 'moveByWords', motionArgs: { forward: false, wordEnd: true, inclusive: true }},\n    { keys: 'gE', type: 'motion', motion: 'moveByWords', motionArgs: { forward: false, wordEnd: true, bigWord: true, inclusive: true }},\n    { keys: '{', type: 'motion', motion: 'moveByParagraph', motionArgs: { forward: false, toJumplist: true }},\n    { keys: '}', type: 'motion', motion: 'moveByParagraph', motionArgs: { forward: true, toJumplist: true }},\n    { keys: '(', type: 'motion', motion: 'moveBySentence', motionArgs: { forward: false }},\n    { keys: ')', type: 'motion', motion: 'moveBySentence', motionArgs: { forward: true }},\n    { keys: '<C-f>', type: 'motion', motion: 'moveByPage', motionArgs: { forward: true }},\n    { keys: '<C-b>', type: 'motion', motion: 'moveByPage', motionArgs: { forward: false }},\n    { keys: '<C-d>', type: 'motion', motion: 'moveByScroll', motionArgs: { forward: true, explicitRepeat: true }},\n    { keys: '<C-u>', type: 'motion', motion: 'moveByScroll', motionArgs: { forward: false, explicitRepeat: true }},\n    { keys: 'gg', type: 'motion', motion: 'moveToLineOrEdgeOfDocument', motionArgs: { forward: false, explicitRepeat: true, linewise: true, toJumplist: true }},\n    { keys: 'G', type: 'motion', motion: 'moveToLineOrEdgeOfDocument', motionArgs: { forward: true, explicitRepeat: true, linewise: true, toJumplist: true }},\n    { keys: '0', type: 'motion', motion: 'moveToStartOfLine' },\n    { keys: '^', type: 'motion', motion: 'moveToFirstNonWhiteSpaceCharacter' },\n    { keys: '+', type: 'motion', motion: 'moveByLines', motionArgs: { forward: true, toFirstChar:true }},\n    { keys: '-', type: 'motion', motion: 'moveByLines', motionArgs: { forward: false, toFirstChar:true }},\n    { keys: '_', type: 'motion', motion: 'moveByLines', motionArgs: { forward: true, toFirstChar:true, repeatOffset:-1 }},\n    { keys: '$', type: 'motion', motion: 'moveToEol', motionArgs: { inclusive: true }},\n    { keys: '%', type: 'motion', motion: 'moveToMatchedSymbol', motionArgs: { inclusive: true, toJumplist: true }},\n    { keys: 'f<character>', type: 'motion', motion: 'moveToCharacter', motionArgs: { forward: true , inclusive: true }},\n    { keys: 'F<character>', type: 'motion', motion: 'moveToCharacter', motionArgs: { forward: false }},\n    { keys: 't<character>', type: 'motion', motion: 'moveTillCharacter', motionArgs: { forward: true, inclusive: true }},\n    { keys: 'T<character>', type: 'motion', motion: 'moveTillCharacter', motionArgs: { forward: false }},\n    { keys: ';', type: 'motion', motion: 'repeatLastCharacterSearch', motionArgs: { forward: true }},\n    { keys: ',', type: 'motion', motion: 'repeatLastCharacterSearch', motionArgs: { forward: false }},\n    { keys: '\\'<character>', type: 'motion', motion: 'goToMark', motionArgs: {toJumplist: true, linewise: true}},\n    { keys: '`<character>', type: 'motion', motion: 'goToMark', motionArgs: {toJumplist: true}},\n    { keys: ']`', type: 'motion', motion: 'jumpToMark', motionArgs: { forward: true } },\n    { keys: '[`', type: 'motion', motion: 'jumpToMark', motionArgs: { forward: false } },\n    { keys: ']\\'', type: 'motion', motion: 'jumpToMark', motionArgs: { forward: true, linewise: true } },\n    { keys: '[\\'', type: 'motion', motion: 'jumpToMark', motionArgs: { forward: false, linewise: true } },\n    // the next two aren't motions but must come before more general motion declarations\n    { keys: ']p', type: 'action', action: 'paste', isEdit: true, actionArgs: { after: true, isEdit: true, matchIndent: true}},\n    { keys: '[p', type: 'action', action: 'paste', isEdit: true, actionArgs: { after: false, isEdit: true, matchIndent: true}},\n    { keys: ']<character>', type: 'motion', motion: 'moveToSymbol', motionArgs: { forward: true, toJumplist: true}},\n    { keys: '[<character>', type: 'motion', motion: 'moveToSymbol', motionArgs: { forward: false, toJumplist: true}},\n    { keys: '|', type: 'motion', motion: 'moveToColumn'},\n    { keys: 'o', type: 'motion', motion: 'moveToOtherHighlightedEnd', context:'visual'},\n    { keys: 'O', type: 'motion', motion: 'moveToOtherHighlightedEnd', motionArgs: {sameLine: true}, context:'visual'},\n    // Operators\n    { keys: 'd', type: 'operator', operator: 'delete' },\n    { keys: 'y', type: 'operator', operator: 'yank' },\n    { keys: 'c', type: 'operator', operator: 'change' },\n    { keys: '=', type: 'operator', operator: 'indentAuto' },\n    { keys: '>', type: 'operator', operator: 'indent', operatorArgs: { indentRight: true }},\n    { keys: '<', type: 'operator', operator: 'indent', operatorArgs: { indentRight: false }},\n    { keys: 'g~', type: 'operator', operator: 'changeCase' },\n    { keys: 'gu', type: 'operator', operator: 'changeCase', operatorArgs: {toLower: true}, isEdit: true },\n    { keys: 'gU', type: 'operator', operator: 'changeCase', operatorArgs: {toLower: false}, isEdit: true },\n    { keys: 'n', type: 'motion', motion: 'findNext', motionArgs: { forward: true, toJumplist: true }},\n    { keys: 'N', type: 'motion', motion: 'findNext', motionArgs: { forward: false, toJumplist: true }},\n    // Operator-Motion dual commands\n    { keys: 'x', type: 'operatorMotion', operator: 'delete', motion: 'moveByCharacters', motionArgs: { forward: true }, operatorMotionArgs: { visualLine: false }},\n    { keys: 'X', type: 'operatorMotion', operator: 'delete', motion: 'moveByCharacters', motionArgs: { forward: false }, operatorMotionArgs: { visualLine: true }},\n    { keys: 'D', type: 'operatorMotion', operator: 'delete', motion: 'moveToEol', motionArgs: { inclusive: true }, context: 'normal'},\n    { keys: 'D', type: 'operator', operator: 'delete', operatorArgs: { linewise: true }, context: 'visual'},\n    { keys: 'Y', type: 'operatorMotion', operator: 'yank', motion: 'expandToLine', motionArgs: { linewise: true }, context: 'normal'},\n    { keys: 'Y', type: 'operator', operator: 'yank', operatorArgs: { linewise: true }, context: 'visual'},\n    { keys: 'C', type: 'operatorMotion', operator: 'change', motion: 'moveToEol', motionArgs: { inclusive: true }, context: 'normal'},\n    { keys: 'C', type: 'operator', operator: 'change', operatorArgs: { linewise: true }, context: 'visual'},\n    { keys: '~', type: 'operatorMotion', operator: 'changeCase', motion: 'moveByCharacters', motionArgs: { forward: true }, operatorArgs: { shouldMoveCursor: true }, context: 'normal'},\n    { keys: '~', type: 'operator', operator: 'changeCase', context: 'visual'},\n    { keys: '<C-w>', type: 'operatorMotion', operator: 'delete', motion: 'moveByWords', motionArgs: { forward: false, wordEnd: false }, context: 'insert' },\n    //ignore C-w in normal mode\n    { keys: '<C-w>', type: 'idle', context: 'normal' },\n    // Actions\n    { keys: '<C-i>', type: 'action', action: 'jumpListWalk', actionArgs: { forward: true }},\n    { keys: '<C-o>', type: 'action', action: 'jumpListWalk', actionArgs: { forward: false }},\n    { keys: '<C-e>', type: 'action', action: 'scroll', actionArgs: { forward: true, linewise: true }},\n    { keys: '<C-y>', type: 'action', action: 'scroll', actionArgs: { forward: false, linewise: true }},\n    { keys: 'a', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'charAfter' }, context: 'normal' },\n    { keys: 'A', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'eol' }, context: 'normal' },\n    { keys: 'A', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'endOfSelectedArea' }, context: 'visual' },\n    { keys: 'i', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'inplace' }, context: 'normal' },\n    { keys: 'gi', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'lastEdit' }, context: 'normal' },\n    { keys: 'I', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'firstNonBlank'}, context: 'normal' },\n    { keys: 'gI', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'bol'}, context: 'normal' },\n    { keys: 'I', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { insertAt: 'startOfSelectedArea' }, context: 'visual' },\n    { keys: 'o', type: 'action', action: 'newLineAndEnterInsertMode', isEdit: true, interlaceInsertRepeat: true, actionArgs: { after: true }, context: 'normal' },\n    { keys: 'O', type: 'action', action: 'newLineAndEnterInsertMode', isEdit: true, interlaceInsertRepeat: true, actionArgs: { after: false }, context: 'normal' },\n    { keys: 'v', type: 'action', action: 'toggleVisualMode' },\n    { keys: 'V', type: 'action', action: 'toggleVisualMode', actionArgs: { linewise: true }},\n    { keys: '<C-v>', type: 'action', action: 'toggleVisualMode', actionArgs: { blockwise: true }},\n    { keys: '<C-q>', type: 'action', action: 'toggleVisualMode', actionArgs: { blockwise: true }},\n    { keys: 'gv', type: 'action', action: 'reselectLastSelection' },\n    { keys: 'J', type: 'action', action: 'joinLines', isEdit: true },\n    { keys: 'gJ', type: 'action', action: 'joinLines', actionArgs: { keepSpaces: true }, isEdit: true },\n    { keys: 'p', type: 'action', action: 'paste', isEdit: true, actionArgs: { after: true, isEdit: true }},\n    { keys: 'P', type: 'action', action: 'paste', isEdit: true, actionArgs: { after: false, isEdit: true }},\n    { keys: 'r<character>', type: 'action', action: 'replace', isEdit: true },\n    { keys: '@<character>', type: 'action', action: 'replayMacro' },\n    { keys: 'q<character>', type: 'action', action: 'enterMacroRecordMode' },\n    // Handle Replace-mode as a special case of insert mode.\n    { keys: 'R', type: 'action', action: 'enterInsertMode', isEdit: true, actionArgs: { replace: true }, context: 'normal'},\n    { keys: 'R', type: 'operator', operator: 'change', operatorArgs: { linewise: true, fullLine: true }, context: 'visual', exitVisualBlock: true},\n    { keys: 'u', type: 'action', action: 'undo', context: 'normal' },\n    { keys: 'u', type: 'operator', operator: 'changeCase', operatorArgs: {toLower: true}, context: 'visual', isEdit: true },\n    { keys: 'U', type: 'operator', operator: 'changeCase', operatorArgs: {toLower: false}, context: 'visual', isEdit: true },\n    { keys: '<C-r>', type: 'action', action: 'redo' },\n    { keys: 'm<character>', type: 'action', action: 'setMark' },\n    { keys: '\"<character>', type: 'action', action: 'setRegister' },\n    { keys: 'zz', type: 'action', action: 'scrollToCursor', actionArgs: { position: 'center' }},\n    { keys: 'z.', type: 'action', action: 'scrollToCursor', actionArgs: { position: 'center' }, motion: 'moveToFirstNonWhiteSpaceCharacter' },\n    { keys: 'zt', type: 'action', action: 'scrollToCursor', actionArgs: { position: 'top' }},\n    { keys: 'z<CR>', type: 'action', action: 'scrollToCursor', actionArgs: { position: 'top' }, motion: 'moveToFirstNonWhiteSpaceCharacter' },\n    { keys: 'z-', type: 'action', action: 'scrollToCursor', actionArgs: { position: 'bottom' }},\n    { keys: 'zb', type: 'action', action: 'scrollToCursor', actionArgs: { position: 'bottom' }, motion: 'moveToFirstNonWhiteSpaceCharacter' },\n    { keys: '.', type: 'action', action: 'repeatLastEdit' },\n    { keys: '<C-a>', type: 'action', action: 'incrementNumberToken', isEdit: true, actionArgs: {increase: true, backtrack: false}},\n    { keys: '<C-x>', type: 'action', action: 'incrementNumberToken', isEdit: true, actionArgs: {increase: false, backtrack: false}},\n    { keys: '<C-t>', type: 'action', action: 'indent', actionArgs: { indentRight: true }, context: 'insert' },\n    { keys: '<C-d>', type: 'action', action: 'indent', actionArgs: { indentRight: false }, context: 'insert' },\n    // Text object motions\n    { keys: 'a<character>', type: 'motion', motion: 'textObjectManipulation' },\n    { keys: 'i<character>', type: 'motion', motion: 'textObjectManipulation', motionArgs: { textObjectInner: true }},\n    // Search\n    { keys: '/', type: 'search', searchArgs: { forward: true, querySrc: 'prompt', toJumplist: true }},\n    { keys: '?', type: 'search', searchArgs: { forward: false, querySrc: 'prompt', toJumplist: true }},\n    { keys: '*', type: 'search', searchArgs: { forward: true, querySrc: 'wordUnderCursor', wholeWordOnly: true, toJumplist: true }},\n    { keys: '#', type: 'search', searchArgs: { forward: false, querySrc: 'wordUnderCursor', wholeWordOnly: true, toJumplist: true }},\n    { keys: 'g*', type: 'search', searchArgs: { forward: true, querySrc: 'wordUnderCursor', toJumplist: true }},\n    { keys: 'g#', type: 'search', searchArgs: { forward: false, querySrc: 'wordUnderCursor', toJumplist: true }},\n    // Ex command\n    { keys: ':', type: 'ex' }\n  ];\n  var defaultKeymapLength = defaultKeymap.length;\n\n  /**\n   * Ex commands\n   * Care must be taken when adding to the default Ex command map. For any\n   * pair of commands that have a shared prefix, at least one of their\n   * shortNames must not match the prefix of the other command.\n   */\n  var defaultExCommandMap = [\n    { name: 'colorscheme', shortName: 'colo' },\n    { name: 'map' },\n    { name: 'imap', shortName: 'im' },\n    { name: 'nmap', shortName: 'nm' },\n    { name: 'vmap', shortName: 'vm' },\n    { name: 'unmap' },\n    { name: 'write', shortName: 'w' },\n    { name: 'undo', shortName: 'u' },\n    { name: 'redo', shortName: 'red' },\n    { name: 'set', shortName: 'se' },\n    { name: 'setlocal', shortName: 'setl' },\n    { name: 'setglobal', shortName: 'setg' },\n    { name: 'sort', shortName: 'sor' },\n    { name: 'substitute', shortName: 's', possiblyAsync: true },\n    { name: 'nohlsearch', shortName: 'noh' },\n    { name: 'yank', shortName: 'y' },\n    { name: 'delmarks', shortName: 'delm' },\n    { name: 'registers', shortName: 'reg', excludeFromCommandHistory: true },\n    { name: 'global', shortName: 'g' }\n  ];\n\n  var Pos = CodeMirror.Pos;\n\n  var Vim = function() {\n    function enterVimMode(cm) {\n      cm.setOption('disableInput', true);\n      cm.setOption('showCursorWhenSelecting', false);\n      CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"normal\"});\n      cm.on('cursorActivity', onCursorActivity);\n      maybeInitVimState(cm);\n      CodeMirror.on(cm.getInputField(), 'paste', getOnPasteFn(cm));\n    }\n\n    function leaveVimMode(cm) {\n      cm.setOption('disableInput', false);\n      cm.off('cursorActivity', onCursorActivity);\n      CodeMirror.off(cm.getInputField(), 'paste', getOnPasteFn(cm));\n      cm.state.vim = null;\n    }\n\n    function detachVimMap(cm, next) {\n      if (this == CodeMirror.keyMap.vim) {\n        CodeMirror.rmClass(cm.getWrapperElement(), \"cm-fat-cursor\");\n        if (cm.getOption(\"inputStyle\") == \"contenteditable\" && document.body.style.caretColor != null) {\n          disableFatCursorMark(cm);\n          cm.getInputField().style.caretColor = \"\";\n        }\n      }\n\n      if (!next || next.attach != attachVimMap)\n        leaveVimMode(cm);\n    }\n    function attachVimMap(cm, prev) {\n      if (this == CodeMirror.keyMap.vim) {\n        CodeMirror.addClass(cm.getWrapperElement(), \"cm-fat-cursor\");\n        if (cm.getOption(\"inputStyle\") == \"contenteditable\" && document.body.style.caretColor != null) {\n          enableFatCursorMark(cm);\n          cm.getInputField().style.caretColor = \"transparent\";\n        }\n      }\n\n      if (!prev || prev.attach != attachVimMap)\n        enterVimMode(cm);\n    }\n\n    function updateFatCursorMark(cm) {\n      if (!cm.state.fatCursorMarks) return;\n      clearFatCursorMark(cm);\n      var ranges = cm.listSelections(), result = []\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.empty()) {\n          var lineLength = cm.getLine(range.anchor.line).length;\n          if (range.anchor.ch < lineLength) {\n            result.push(cm.markText(range.anchor, Pos(range.anchor.line, range.anchor.ch + 1),\n                                    {className: \"cm-fat-cursor-mark\"}));\n          } else {\n            result.push(cm.markText(Pos(range.anchor.line, lineLength - 1),\n                                    Pos(range.anchor.line, lineLength),\n                                    {className: \"cm-fat-cursor-mark\"}));\n          }\n        }\n      }\n      cm.state.fatCursorMarks = result;\n    }\n\n    function clearFatCursorMark(cm) {\n      var marks = cm.state.fatCursorMarks;\n      if (marks) for (var i = 0; i < marks.length; i++) marks[i].clear();\n    }\n\n    function enableFatCursorMark(cm) {\n      cm.state.fatCursorMarks = [];\n      updateFatCursorMark(cm)\n      cm.on(\"cursorActivity\", updateFatCursorMark)\n    }\n\n    function disableFatCursorMark(cm) {\n      clearFatCursorMark(cm);\n      cm.off(\"cursorActivity\", updateFatCursorMark);\n      // explicitly set fatCursorMarks to null because event listener above\n      // can be invoke after removing it, if off is called from operation\n      cm.state.fatCursorMarks = null;\n    }\n\n    // Deprecated, simply setting the keymap works again.\n    CodeMirror.defineOption('vimMode', false, function(cm, val, prev) {\n      if (val && cm.getOption(\"keyMap\") != \"vim\")\n        cm.setOption(\"keyMap\", \"vim\");\n      else if (!val && prev != CodeMirror.Init && /^vim/.test(cm.getOption(\"keyMap\")))\n        cm.setOption(\"keyMap\", \"default\");\n    });\n\n    function cmKey(key, cm) {\n      if (!cm) { return undefined; }\n      if (this[key]) { return this[key]; }\n      var vimKey = cmKeyToVimKey(key);\n      if (!vimKey) {\n        return false;\n      }\n      var cmd = CodeMirror.Vim.findKey(cm, vimKey);\n      if (typeof cmd == 'function') {\n        CodeMirror.signal(cm, 'vim-keypress', vimKey);\n      }\n      return cmd;\n    }\n\n    var modifiers = {'Shift': 'S', 'Ctrl': 'C', 'Alt': 'A', 'Cmd': 'D', 'Mod': 'A'};\n    var specialKeys = {Enter:'CR',Backspace:'BS',Delete:'Del',Insert:'Ins'};\n    function cmKeyToVimKey(key) {\n      if (key.charAt(0) == '\\'') {\n        // Keypress character binding of format \"'a'\"\n        return key.charAt(1);\n      }\n      var pieces = key.split(/-(?!$)/);\n      var lastPiece = pieces[pieces.length - 1];\n      if (pieces.length == 1 && pieces[0].length == 1) {\n        // No-modifier bindings use literal character bindings above. Skip.\n        return false;\n      } else if (pieces.length == 2 && pieces[0] == 'Shift' && lastPiece.length == 1) {\n        // Ignore Shift+char bindings as they should be handled by literal character.\n        return false;\n      }\n      var hasCharacter = false;\n      for (var i = 0; i < pieces.length; i++) {\n        var piece = pieces[i];\n        if (piece in modifiers) { pieces[i] = modifiers[piece]; }\n        else { hasCharacter = true; }\n        if (piece in specialKeys) { pieces[i] = specialKeys[piece]; }\n      }\n      if (!hasCharacter) {\n        // Vim does not support modifier only keys.\n        return false;\n      }\n      // TODO: Current bindings expect the character to be lower case, but\n      // it looks like vim key notation uses upper case.\n      if (isUpperCase(lastPiece)) {\n        pieces[pieces.length - 1] = lastPiece.toLowerCase();\n      }\n      return '<' + pieces.join('-') + '>';\n    }\n\n    function getOnPasteFn(cm) {\n      var vim = cm.state.vim;\n      if (!vim.onPasteFn) {\n        vim.onPasteFn = function() {\n          if (!vim.insertMode) {\n            cm.setCursor(offsetCursor(cm.getCursor(), 0, 1));\n            actions.enterInsertMode(cm, {}, vim);\n          }\n        };\n      }\n      return vim.onPasteFn;\n    }\n\n    var numberRegex = /[\\d]/;\n    var wordCharTest = [CodeMirror.isWordChar, function(ch) {\n      return ch && !CodeMirror.isWordChar(ch) && !/\\s/.test(ch);\n    }], bigWordCharTest = [function(ch) {\n      return /\\S/.test(ch);\n    }];\n    function makeKeyRange(start, size) {\n      var keys = [];\n      for (var i = start; i < start + size; i++) {\n        keys.push(String.fromCharCode(i));\n      }\n      return keys;\n    }\n    var upperCaseAlphabet = makeKeyRange(65, 26);\n    var lowerCaseAlphabet = makeKeyRange(97, 26);\n    var numbers = makeKeyRange(48, 10);\n    var validMarks = [].concat(upperCaseAlphabet, lowerCaseAlphabet, numbers, ['<', '>']);\n    var validRegisters = [].concat(upperCaseAlphabet, lowerCaseAlphabet, numbers, ['-', '\"', '.', ':', '/']);\n\n    function isLine(cm, line) {\n      return line >= cm.firstLine() && line <= cm.lastLine();\n    }\n    function isLowerCase(k) {\n      return (/^[a-z]$/).test(k);\n    }\n    function isMatchableSymbol(k) {\n      return '()[]{}'.indexOf(k) != -1;\n    }\n    function isNumber(k) {\n      return numberRegex.test(k);\n    }\n    function isUpperCase(k) {\n      return (/^[A-Z]$/).test(k);\n    }\n    function isWhiteSpaceString(k) {\n      return (/^\\s*$/).test(k);\n    }\n    function isEndOfSentenceSymbol(k) {\n      return '.?!'.indexOf(k) != -1;\n    }\n    function inArray(val, arr) {\n      for (var i = 0; i < arr.length; i++) {\n        if (arr[i] == val) {\n          return true;\n        }\n      }\n      return false;\n    }\n\n    var options = {};\n    function defineOption(name, defaultValue, type, aliases, callback) {\n      if (defaultValue === undefined && !callback) {\n        throw Error('defaultValue is required unless callback is provided');\n      }\n      if (!type) { type = 'string'; }\n      options[name] = {\n        type: type,\n        defaultValue: defaultValue,\n        callback: callback\n      };\n      if (aliases) {\n        for (var i = 0; i < aliases.length; i++) {\n          options[aliases[i]] = options[name];\n        }\n      }\n      if (defaultValue) {\n        setOption(name, defaultValue);\n      }\n    }\n\n    function setOption(name, value, cm, cfg) {\n      var option = options[name];\n      cfg = cfg || {};\n      var scope = cfg.scope;\n      if (!option) {\n        return new Error('Unknown option: ' + name);\n      }\n      if (option.type == 'boolean') {\n        if (value && value !== true) {\n          return new Error('Invalid argument: ' + name + '=' + value);\n        } else if (value !== false) {\n          // Boolean options are set to true if value is not defined.\n          value = true;\n        }\n      }\n      if (option.callback) {\n        if (scope !== 'local') {\n          option.callback(value, undefined);\n        }\n        if (scope !== 'global' && cm) {\n          option.callback(value, cm);\n        }\n      } else {\n        if (scope !== 'local') {\n          option.value = option.type == 'boolean' ? !!value : value;\n        }\n        if (scope !== 'global' && cm) {\n          cm.state.vim.options[name] = {value: value};\n        }\n      }\n    }\n\n    function getOption(name, cm, cfg) {\n      var option = options[name];\n      cfg = cfg || {};\n      var scope = cfg.scope;\n      if (!option) {\n        return new Error('Unknown option: ' + name);\n      }\n      if (option.callback) {\n        var local = cm && option.callback(undefined, cm);\n        if (scope !== 'global' && local !== undefined) {\n          return local;\n        }\n        if (scope !== 'local') {\n          return option.callback();\n        }\n        return;\n      } else {\n        var local = (scope !== 'global') && (cm && cm.state.vim.options[name]);\n        return (local || (scope !== 'local') && option || {}).value;\n      }\n    }\n\n    defineOption('filetype', undefined, 'string', ['ft'], function(name, cm) {\n      // Option is local. Do nothing for global.\n      if (cm === undefined) {\n        return;\n      }\n      // The 'filetype' option proxies to the CodeMirror 'mode' option.\n      if (name === undefined) {\n        var mode = cm.getOption('mode');\n        return mode == 'null' ? '' : mode;\n      } else {\n        var mode = name == '' ? 'null' : name;\n        cm.setOption('mode', mode);\n      }\n    });\n\n    var createCircularJumpList = function() {\n      var size = 100;\n      var pointer = -1;\n      var head = 0;\n      var tail = 0;\n      var buffer = new Array(size);\n      function add(cm, oldCur, newCur) {\n        var current = pointer % size;\n        var curMark = buffer[current];\n        function useNextSlot(cursor) {\n          var next = ++pointer % size;\n          var trashMark = buffer[next];\n          if (trashMark) {\n            trashMark.clear();\n          }\n          buffer[next] = cm.setBookmark(cursor);\n        }\n        if (curMark) {\n          var markPos = curMark.find();\n          // avoid recording redundant cursor position\n          if (markPos && !cursorEqual(markPos, oldCur)) {\n            useNextSlot(oldCur);\n          }\n        } else {\n          useNextSlot(oldCur);\n        }\n        useNextSlot(newCur);\n        head = pointer;\n        tail = pointer - size + 1;\n        if (tail < 0) {\n          tail = 0;\n        }\n      }\n      function move(cm, offset) {\n        pointer += offset;\n        if (pointer > head) {\n          pointer = head;\n        } else if (pointer < tail) {\n          pointer = tail;\n        }\n        var mark = buffer[(size + pointer) % size];\n        // skip marks that are temporarily removed from text buffer\n        if (mark && !mark.find()) {\n          var inc = offset > 0 ? 1 : -1;\n          var newCur;\n          var oldCur = cm.getCursor();\n          do {\n            pointer += inc;\n            mark = buffer[(size + pointer) % size];\n            // skip marks that are the same as current position\n            if (mark &&\n                (newCur = mark.find()) &&\n                !cursorEqual(oldCur, newCur)) {\n              break;\n            }\n          } while (pointer < head && pointer > tail);\n        }\n        return mark;\n      }\n      function find(cm, offset) {\n        var oldPointer = pointer;\n        var mark = move(cm, offset);\n        pointer = oldPointer;\n        return mark && mark.find();\n      }\n      return {\n        cachedCursor: undefined, //used for # and * jumps\n        add: add,\n        find: find,\n        move: move\n      };\n    };\n\n    // Returns an object to track the changes associated insert mode.  It\n    // clones the object that is passed in, or creates an empty object one if\n    // none is provided.\n    var createInsertModeChanges = function(c) {\n      if (c) {\n        // Copy construction\n        return {\n          changes: c.changes,\n          expectCursorActivityForChange: c.expectCursorActivityForChange\n        };\n      }\n      return {\n        // Change list\n        changes: [],\n        // Set to true on change, false on cursorActivity.\n        expectCursorActivityForChange: false\n      };\n    };\n\n    function MacroModeState() {\n      this.latestRegister = undefined;\n      this.isPlaying = false;\n      this.isRecording = false;\n      this.replaySearchQueries = [];\n      this.onRecordingDone = undefined;\n      this.lastInsertModeChanges = createInsertModeChanges();\n    }\n    MacroModeState.prototype = {\n      exitMacroRecordMode: function() {\n        var macroModeState = vimGlobalState.macroModeState;\n        if (macroModeState.onRecordingDone) {\n          macroModeState.onRecordingDone(); // close dialog\n        }\n        macroModeState.onRecordingDone = undefined;\n        macroModeState.isRecording = false;\n      },\n      enterMacroRecordMode: function(cm, registerName) {\n        var register =\n            vimGlobalState.registerController.getRegister(registerName);\n        if (register) {\n          register.clear();\n          this.latestRegister = registerName;\n          if (cm.openDialog) {\n            this.onRecordingDone = cm.openDialog(\n                '(recording)['+registerName+']', null, {bottom:true});\n          }\n          this.isRecording = true;\n        }\n      }\n    };\n\n    function maybeInitVimState(cm) {\n      if (!cm.state.vim) {\n        // Store instance state in the CodeMirror object.\n        cm.state.vim = {\n          inputState: new InputState(),\n          // Vim's input state that triggered the last edit, used to repeat\n          // motions and operators with '.'.\n          lastEditInputState: undefined,\n          // Vim's action command before the last edit, used to repeat actions\n          // with '.' and insert mode repeat.\n          lastEditActionCommand: undefined,\n          // When using jk for navigation, if you move from a longer line to a\n          // shorter line, the cursor may clip to the end of the shorter line.\n          // If j is pressed again and cursor goes to the next line, the\n          // cursor should go back to its horizontal position on the longer\n          // line if it can. This is to keep track of the horizontal position.\n          lastHPos: -1,\n          // Doing the same with screen-position for gj/gk\n          lastHSPos: -1,\n          // The last motion command run. Cleared if a non-motion command gets\n          // executed in between.\n          lastMotion: null,\n          marks: {},\n          // Mark for rendering fake cursor for visual mode.\n          fakeCursor: null,\n          insertMode: false,\n          // Repeat count for changes made in insert mode, triggered by key\n          // sequences like 3,i. Only exists when insertMode is true.\n          insertModeRepeat: undefined,\n          visualMode: false,\n          // If we are in visual line mode. No effect if visualMode is false.\n          visualLine: false,\n          visualBlock: false,\n          lastSelection: null,\n          lastPastedText: null,\n          sel: {},\n          // Buffer-local/window-local values of vim options.\n          options: {}\n        };\n      }\n      return cm.state.vim;\n    }\n    var vimGlobalState;\n    function resetVimGlobalState() {\n      vimGlobalState = {\n        // The current search query.\n        searchQuery: null,\n        // Whether we are searching backwards.\n        searchIsReversed: false,\n        // Replace part of the last substituted pattern\n        lastSubstituteReplacePart: undefined,\n        jumpList: createCircularJumpList(),\n        macroModeState: new MacroModeState,\n        // Recording latest f, t, F or T motion command.\n        lastCharacterSearch: {increment:0, forward:true, selectedCharacter:''},\n        registerController: new RegisterController({}),\n        // search history buffer\n        searchHistoryController: new HistoryController(),\n        // ex Command history buffer\n        exCommandHistoryController : new HistoryController()\n      };\n      for (var optionName in options) {\n        var option = options[optionName];\n        option.value = option.defaultValue;\n      }\n    }\n\n    var lastInsertModeKeyTimer;\n    var vimApi= {\n      buildKeyMap: function() {\n        // TODO: Convert keymap into dictionary format for fast lookup.\n      },\n      // Testing hook, though it might be useful to expose the register\n      // controller anyways.\n      getRegisterController: function() {\n        return vimGlobalState.registerController;\n      },\n      // Testing hook.\n      resetVimGlobalState_: resetVimGlobalState,\n\n      // Testing hook.\n      getVimGlobalState_: function() {\n        return vimGlobalState;\n      },\n\n      // Testing hook.\n      maybeInitVimState_: maybeInitVimState,\n\n      suppressErrorLogging: false,\n\n      InsertModeKey: InsertModeKey,\n      map: function(lhs, rhs, ctx) {\n        // Add user defined key bindings.\n        exCommandDispatcher.map(lhs, rhs, ctx);\n      },\n      unmap: function(lhs, ctx) {\n        exCommandDispatcher.unmap(lhs, ctx);\n      },\n      // Non-recursive map function.\n      // NOTE: This will not create mappings to key maps that aren't present\n      // in the default key map. See TODO at bottom of function.\n      noremap: function(lhs, rhs, ctx) {\n        function toCtxArray(ctx) {\n          return ctx ? [ctx] : ['normal', 'insert', 'visual'];\n        }\n        var ctxsToMap = toCtxArray(ctx);\n        // Look through all actual defaults to find a map candidate.\n        var actualLength = defaultKeymap.length, origLength = defaultKeymapLength;\n        for (var i = actualLength - origLength;\n             i < actualLength && ctxsToMap.length;\n             i++) {\n          var mapping = defaultKeymap[i];\n          // Omit mappings that operate in the wrong context(s) and those of invalid type.\n          if (mapping.keys == rhs &&\n              (!ctx || !mapping.context || mapping.context === ctx) &&\n              mapping.type.substr(0, 2) !== 'ex' &&\n              mapping.type.substr(0, 3) !== 'key') {\n            // Make a shallow copy of the original keymap entry.\n            var newMapping = {};\n            for (var key in mapping) {\n              newMapping[key] = mapping[key];\n            }\n            // Modify it point to the new mapping with the proper context.\n            newMapping.keys = lhs;\n            if (ctx && !newMapping.context) {\n              newMapping.context = ctx;\n            }\n            // Add it to the keymap with a higher priority than the original.\n            this._mapCommand(newMapping);\n            // Record the mapped contexts as complete.\n            var mappedCtxs = toCtxArray(mapping.context);\n            ctxsToMap = ctxsToMap.filter(function(el) { return mappedCtxs.indexOf(el) === -1; });\n          }\n        }\n        // TODO: Create non-recursive keyToKey mappings for the unmapped contexts once those exist.\n      },\n      // Remove all user-defined mappings for the provided context.\n      mapclear: function(ctx) {\n        // Partition the existing keymap into user-defined and true defaults.\n        var actualLength = defaultKeymap.length,\n            origLength = defaultKeymapLength;\n        var userKeymap = defaultKeymap.slice(0, actualLength - origLength);\n        defaultKeymap = defaultKeymap.slice(actualLength - origLength);\n        if (ctx) {\n          // If a specific context is being cleared, we need to keep mappings\n          // from all other contexts.\n          for (var i = userKeymap.length - 1; i >= 0; i--) {\n            var mapping = userKeymap[i];\n            if (ctx !== mapping.context) {\n              if (mapping.context) {\n                this._mapCommand(mapping);\n              } else {\n                // `mapping` applies to all contexts so create keymap copies\n                // for each context except the one being cleared.\n                var contexts = ['normal', 'insert', 'visual'];\n                for (var j in contexts) {\n                  if (contexts[j] !== ctx) {\n                    var newMapping = {};\n                    for (var key in mapping) {\n                      newMapping[key] = mapping[key];\n                    }\n                    newMapping.context = contexts[j];\n                    this._mapCommand(newMapping);\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      // TODO: Expose setOption and getOption as instance methods. Need to decide how to namespace\n      // them, or somehow make them work with the existing CodeMirror setOption/getOption API.\n      setOption: setOption,\n      getOption: getOption,\n      defineOption: defineOption,\n      defineEx: function(name, prefix, func){\n        if (!prefix) {\n          prefix = name;\n        } else if (name.indexOf(prefix) !== 0) {\n          throw new Error('(Vim.defineEx) \"'+prefix+'\" is not a prefix of \"'+name+'\", command not registered');\n        }\n        exCommands[name]=func;\n        exCommandDispatcher.commandMap_[prefix]={name:name, shortName:prefix, type:'api'};\n      },\n      handleKey: function (cm, key, origin) {\n        var command = this.findKey(cm, key, origin);\n        if (typeof command === 'function') {\n          return command();\n        }\n      },\n      /**\n       * This is the outermost function called by CodeMirror, after keys have\n       * been mapped to their Vim equivalents.\n       *\n       * Finds a command based on the key (and cached keys if there is a\n       * multi-key sequence). Returns `undefined` if no key is matched, a noop\n       * function if a partial match is found (multi-key), and a function to\n       * execute the bound command if a a key is matched. The function always\n       * returns true.\n       */\n      findKey: function(cm, key, origin) {\n        var vim = maybeInitVimState(cm);\n        function handleMacroRecording() {\n          var macroModeState = vimGlobalState.macroModeState;\n          if (macroModeState.isRecording) {\n            if (key == 'q') {\n              macroModeState.exitMacroRecordMode();\n              clearInputState(cm);\n              return true;\n            }\n            if (origin != 'mapping') {\n              logKey(macroModeState, key);\n            }\n          }\n        }\n        function handleEsc() {\n          if (key == '<Esc>') {\n            // Clear input state and get back to normal mode.\n            clearInputState(cm);\n            if (vim.visualMode) {\n              exitVisualMode(cm);\n            } else if (vim.insertMode) {\n              exitInsertMode(cm);\n            }\n            return true;\n          }\n        }\n        function doKeyToKey(keys) {\n          // TODO: prevent infinite recursion.\n          var match;\n          while (keys) {\n            // Pull off one command key, which is either a single character\n            // or a special sequence wrapped in '<' and '>', e.g. '<Space>'.\n            match = (/<\\w+-.+?>|<\\w+>|./).exec(keys);\n            key = match[0];\n            keys = keys.substring(match.index + key.length);\n            CodeMirror.Vim.handleKey(cm, key, 'mapping');\n          }\n        }\n\n        function handleKeyInsertMode() {\n          if (handleEsc()) { return true; }\n          var keys = vim.inputState.keyBuffer = vim.inputState.keyBuffer + key;\n          var keysAreChars = key.length == 1;\n          var match = commandDispatcher.matchCommand(keys, defaultKeymap, vim.inputState, 'insert');\n          // Need to check all key substrings in insert mode.\n          while (keys.length > 1 && match.type != 'full') {\n            var keys = vim.inputState.keyBuffer = keys.slice(1);\n            var thisMatch = commandDispatcher.matchCommand(keys, defaultKeymap, vim.inputState, 'insert');\n            if (thisMatch.type != 'none') { match = thisMatch; }\n          }\n          if (match.type == 'none') { clearInputState(cm); return false; }\n          else if (match.type == 'partial') {\n            if (lastInsertModeKeyTimer) { window.clearTimeout(lastInsertModeKeyTimer); }\n            lastInsertModeKeyTimer = window.setTimeout(\n              function() { if (vim.insertMode && vim.inputState.keyBuffer) { clearInputState(cm); } },\n              getOption('insertModeEscKeysTimeout'));\n            return !keysAreChars;\n          }\n\n          if (lastInsertModeKeyTimer) { window.clearTimeout(lastInsertModeKeyTimer); }\n          if (keysAreChars) {\n            var selections = cm.listSelections();\n            for (var i = 0; i < selections.length; i++) {\n              var here = selections[i].head;\n              cm.replaceRange('', offsetCursor(here, 0, -(keys.length - 1)), here, '+input');\n            }\n            vimGlobalState.macroModeState.lastInsertModeChanges.changes.pop();\n          }\n          clearInputState(cm);\n          return match.command;\n        }\n\n        function handleKeyNonInsertMode() {\n          if (handleMacroRecording() || handleEsc()) { return true; }\n\n          var keys = vim.inputState.keyBuffer = vim.inputState.keyBuffer + key;\n          if (/^[1-9]\\d*$/.test(keys)) { return true; }\n\n          var keysMatcher = /^(\\d*)(.*)$/.exec(keys);\n          if (!keysMatcher) { clearInputState(cm); return false; }\n          var context = vim.visualMode ? 'visual' :\n                                         'normal';\n          var match = commandDispatcher.matchCommand(keysMatcher[2] || keysMatcher[1], defaultKeymap, vim.inputState, context);\n          if (match.type == 'none') { clearInputState(cm); return false; }\n          else if (match.type == 'partial') { return true; }\n\n          vim.inputState.keyBuffer = '';\n          var keysMatcher = /^(\\d*)(.*)$/.exec(keys);\n          if (keysMatcher[1] && keysMatcher[1] != '0') {\n            vim.inputState.pushRepeatDigit(keysMatcher[1]);\n          }\n          return match.command;\n        }\n\n        var command;\n        if (vim.insertMode) { command = handleKeyInsertMode(); }\n        else { command = handleKeyNonInsertMode(); }\n        if (command === false) {\n          return !vim.insertMode && key.length === 1 ? function() { return true; } : undefined;\n        } else if (command === true) {\n          // TODO: Look into using CodeMirror's multi-key handling.\n          // Return no-op since we are caching the key. Counts as handled, but\n          // don't want act on it just yet.\n          return function() { return true; };\n        } else {\n          return function() {\n            return cm.operation(function() {\n              cm.curOp.isVimOp = true;\n              try {\n                if (command.type == 'keyToKey') {\n                  doKeyToKey(command.toKeys);\n                } else {\n                  commandDispatcher.processCommand(cm, vim, command);\n                }\n              } catch (e) {\n                // clear VIM state in case it's in a bad state.\n                cm.state.vim = undefined;\n                maybeInitVimState(cm);\n                if (!CodeMirror.Vim.suppressErrorLogging) {\n                  console['log'](e);\n                }\n                throw e;\n              }\n              return true;\n            });\n          };\n        }\n      },\n      handleEx: function(cm, input) {\n        exCommandDispatcher.processCommand(cm, input);\n      },\n\n      defineMotion: defineMotion,\n      defineAction: defineAction,\n      defineOperator: defineOperator,\n      mapCommand: mapCommand,\n      _mapCommand: _mapCommand,\n\n      defineRegister: defineRegister,\n\n      exitVisualMode: exitVisualMode,\n      exitInsertMode: exitInsertMode\n    };\n\n    // Represents the current input state.\n    function InputState() {\n      this.prefixRepeat = [];\n      this.motionRepeat = [];\n\n      this.operator = null;\n      this.operatorArgs = null;\n      this.motion = null;\n      this.motionArgs = null;\n      this.keyBuffer = []; // For matching multi-key commands.\n      this.registerName = null; // Defaults to the unnamed register.\n    }\n    InputState.prototype.pushRepeatDigit = function(n) {\n      if (!this.operator) {\n        this.prefixRepeat = this.prefixRepeat.concat(n);\n      } else {\n        this.motionRepeat = this.motionRepeat.concat(n);\n      }\n    };\n    InputState.prototype.getRepeat = function() {\n      var repeat = 0;\n      if (this.prefixRepeat.length > 0 || this.motionRepeat.length > 0) {\n        repeat = 1;\n        if (this.prefixRepeat.length > 0) {\n          repeat *= parseInt(this.prefixRepeat.join(''), 10);\n        }\n        if (this.motionRepeat.length > 0) {\n          repeat *= parseInt(this.motionRepeat.join(''), 10);\n        }\n      }\n      return repeat;\n    };\n\n    function clearInputState(cm, reason) {\n      cm.state.vim.inputState = new InputState();\n      CodeMirror.signal(cm, 'vim-command-done', reason);\n    }\n\n    /*\n     * Register stores information about copy and paste registers.  Besides\n     * text, a register must store whether it is linewise (i.e., when it is\n     * pasted, should it insert itself into a new line, or should the text be\n     * inserted at the cursor position.)\n     */\n    function Register(text, linewise, blockwise) {\n      this.clear();\n      this.keyBuffer = [text || ''];\n      this.insertModeChanges = [];\n      this.searchQueries = [];\n      this.linewise = !!linewise;\n      this.blockwise = !!blockwise;\n    }\n    Register.prototype = {\n      setText: function(text, linewise, blockwise) {\n        this.keyBuffer = [text || ''];\n        this.linewise = !!linewise;\n        this.blockwise = !!blockwise;\n      },\n      pushText: function(text, linewise) {\n        // if this register has ever been set to linewise, use linewise.\n        if (linewise) {\n          if (!this.linewise) {\n            this.keyBuffer.push('\\n');\n          }\n          this.linewise = true;\n        }\n        this.keyBuffer.push(text);\n      },\n      pushInsertModeChanges: function(changes) {\n        this.insertModeChanges.push(createInsertModeChanges(changes));\n      },\n      pushSearchQuery: function(query) {\n        this.searchQueries.push(query);\n      },\n      clear: function() {\n        this.keyBuffer = [];\n        this.insertModeChanges = [];\n        this.searchQueries = [];\n        this.linewise = false;\n      },\n      toString: function() {\n        return this.keyBuffer.join('');\n      }\n    };\n\n    /**\n     * Defines an external register.\n     *\n     * The name should be a single character that will be used to reference the register.\n     * The register should support setText, pushText, clear, and toString(). See Register\n     * for a reference implementation.\n     */\n    function defineRegister(name, register) {\n      var registers = vimGlobalState.registerController.registers;\n      if (!name || name.length != 1) {\n        throw Error('Register name must be 1 character');\n      }\n      if (registers[name]) {\n        throw Error('Register already defined ' + name);\n      }\n      registers[name] = register;\n      validRegisters.push(name);\n    }\n\n    /*\n     * vim registers allow you to keep many independent copy and paste buffers.\n     * See http://usevim.com/2012/04/13/registers/ for an introduction.\n     *\n     * RegisterController keeps the state of all the registers.  An initial\n     * state may be passed in.  The unnamed register '\"' will always be\n     * overridden.\n     */\n    function RegisterController(registers) {\n      this.registers = registers;\n      this.unnamedRegister = registers['\"'] = new Register();\n      registers['.'] = new Register();\n      registers[':'] = new Register();\n      registers['/'] = new Register();\n    }\n    RegisterController.prototype = {\n      pushText: function(registerName, operator, text, linewise, blockwise) {\n        if (linewise && text.charAt(text.length - 1) !== '\\n'){\n          text += '\\n';\n        }\n        // Lowercase and uppercase registers refer to the same register.\n        // Uppercase just means append.\n        var register = this.isValidRegister(registerName) ?\n            this.getRegister(registerName) : null;\n        // if no register/an invalid register was specified, things go to the\n        // default registers\n        if (!register) {\n          switch (operator) {\n            case 'yank':\n              // The 0 register contains the text from the most recent yank.\n              this.registers['0'] = new Register(text, linewise, blockwise);\n              break;\n            case 'delete':\n            case 'change':\n              if (text.indexOf('\\n') == -1) {\n                // Delete less than 1 line. Update the small delete register.\n                this.registers['-'] = new Register(text, linewise);\n              } else {\n                // Shift down the contents of the numbered registers and put the\n                // deleted text into register 1.\n                this.shiftNumericRegisters_();\n                this.registers['1'] = new Register(text, linewise);\n              }\n              break;\n          }\n          // Make sure the unnamed register is set to what just happened\n          this.unnamedRegister.setText(text, linewise, blockwise);\n          return;\n        }\n\n        // If we've gotten to this point, we've actually specified a register\n        var append = isUpperCase(registerName);\n        if (append) {\n          register.pushText(text, linewise);\n        } else {\n          register.setText(text, linewise, blockwise);\n        }\n        // The unnamed register always has the same value as the last used\n        // register.\n        this.unnamedRegister.setText(register.toString(), linewise);\n      },\n      // Gets the register named @name.  If one of @name doesn't already exist,\n      // create it.  If @name is invalid, return the unnamedRegister.\n      getRegister: function(name) {\n        if (!this.isValidRegister(name)) {\n          return this.unnamedRegister;\n        }\n        name = name.toLowerCase();\n        if (!this.registers[name]) {\n          this.registers[name] = new Register();\n        }\n        return this.registers[name];\n      },\n      isValidRegister: function(name) {\n        return name && inArray(name, validRegisters);\n      },\n      shiftNumericRegisters_: function() {\n        for (var i = 9; i >= 2; i--) {\n          this.registers[i] = this.getRegister('' + (i - 1));\n        }\n      }\n    };\n    function HistoryController() {\n        this.historyBuffer = [];\n        this.iterator = 0;\n        this.initialPrefix = null;\n    }\n    HistoryController.prototype = {\n      // the input argument here acts a user entered prefix for a small time\n      // until we start autocompletion in which case it is the autocompleted.\n      nextMatch: function (input, up) {\n        var historyBuffer = this.historyBuffer;\n        var dir = up ? -1 : 1;\n        if (this.initialPrefix === null) this.initialPrefix = input;\n        for (var i = this.iterator + dir; up ? i >= 0 : i < historyBuffer.length; i+= dir) {\n          var element = historyBuffer[i];\n          for (var j = 0; j <= element.length; j++) {\n            if (this.initialPrefix == element.substring(0, j)) {\n              this.iterator = i;\n              return element;\n            }\n          }\n        }\n        // should return the user input in case we reach the end of buffer.\n        if (i >= historyBuffer.length) {\n          this.iterator = historyBuffer.length;\n          return this.initialPrefix;\n        }\n        // return the last autocompleted query or exCommand as it is.\n        if (i < 0 ) return input;\n      },\n      pushInput: function(input) {\n        var index = this.historyBuffer.indexOf(input);\n        if (index > -1) this.historyBuffer.splice(index, 1);\n        if (input.length) this.historyBuffer.push(input);\n      },\n      reset: function() {\n        this.initialPrefix = null;\n        this.iterator = this.historyBuffer.length;\n      }\n    };\n    var commandDispatcher = {\n      matchCommand: function(keys, keyMap, inputState, context) {\n        var matches = commandMatches(keys, keyMap, context, inputState);\n        if (!matches.full && !matches.partial) {\n          return {type: 'none'};\n        } else if (!matches.full && matches.partial) {\n          return {type: 'partial'};\n        }\n\n        var bestMatch;\n        for (var i = 0; i < matches.full.length; i++) {\n          var match = matches.full[i];\n          if (!bestMatch) {\n            bestMatch = match;\n          }\n        }\n        if (bestMatch.keys.slice(-11) == '<character>') {\n          var character = lastChar(keys);\n          if (!character) return {type: 'none'};\n          inputState.selectedCharacter = character;\n        }\n        return {type: 'full', command: bestMatch};\n      },\n      processCommand: function(cm, vim, command) {\n        vim.inputState.repeatOverride = command.repeatOverride;\n        switch (command.type) {\n          case 'motion':\n            this.processMotion(cm, vim, command);\n            break;\n          case 'operator':\n            this.processOperator(cm, vim, command);\n            break;\n          case 'operatorMotion':\n            this.processOperatorMotion(cm, vim, command);\n            break;\n          case 'action':\n            this.processAction(cm, vim, command);\n            break;\n          case 'search':\n            this.processSearch(cm, vim, command);\n            break;\n          case 'ex':\n          case 'keyToEx':\n            this.processEx(cm, vim, command);\n            break;\n          default:\n            break;\n        }\n      },\n      processMotion: function(cm, vim, command) {\n        vim.inputState.motion = command.motion;\n        vim.inputState.motionArgs = copyArgs(command.motionArgs);\n        this.evalInput(cm, vim);\n      },\n      processOperator: function(cm, vim, command) {\n        var inputState = vim.inputState;\n        if (inputState.operator) {\n          if (inputState.operator == command.operator) {\n            // Typing an operator twice like 'dd' makes the operator operate\n            // linewise\n            inputState.motion = 'expandToLine';\n            inputState.motionArgs = { linewise: true };\n            this.evalInput(cm, vim);\n            return;\n          } else {\n            // 2 different operators in a row doesn't make sense.\n            clearInputState(cm);\n          }\n        }\n        inputState.operator = command.operator;\n        inputState.operatorArgs = copyArgs(command.operatorArgs);\n        if (command.exitVisualBlock) {\n            vim.visualBlock = false;\n            updateCmSelection(cm);\n        }\n        if (vim.visualMode) {\n          // Operating on a selection in visual mode. We don't need a motion.\n          this.evalInput(cm, vim);\n        }\n      },\n      processOperatorMotion: function(cm, vim, command) {\n        var visualMode = vim.visualMode;\n        var operatorMotionArgs = copyArgs(command.operatorMotionArgs);\n        if (operatorMotionArgs) {\n          // Operator motions may have special behavior in visual mode.\n          if (visualMode && operatorMotionArgs.visualLine) {\n            vim.visualLine = true;\n          }\n        }\n        this.processOperator(cm, vim, command);\n        if (!visualMode) {\n          this.processMotion(cm, vim, command);\n        }\n      },\n      processAction: function(cm, vim, command) {\n        var inputState = vim.inputState;\n        var repeat = inputState.getRepeat();\n        var repeatIsExplicit = !!repeat;\n        var actionArgs = copyArgs(command.actionArgs) || {};\n        if (inputState.selectedCharacter) {\n          actionArgs.selectedCharacter = inputState.selectedCharacter;\n        }\n        // Actions may or may not have motions and operators. Do these first.\n        if (command.operator) {\n          this.processOperator(cm, vim, command);\n        }\n        if (command.motion) {\n          this.processMotion(cm, vim, command);\n        }\n        if (command.motion || command.operator) {\n          this.evalInput(cm, vim);\n        }\n        actionArgs.repeat = repeat || 1;\n        actionArgs.repeatIsExplicit = repeatIsExplicit;\n        actionArgs.registerName = inputState.registerName;\n        clearInputState(cm);\n        vim.lastMotion = null;\n        if (command.isEdit) {\n          this.recordLastEdit(vim, inputState, command);\n        }\n        actions[command.action](cm, actionArgs, vim);\n      },\n      processSearch: function(cm, vim, command) {\n        if (!cm.getSearchCursor) {\n          // Search depends on SearchCursor.\n          return;\n        }\n        var forward = command.searchArgs.forward;\n        var wholeWordOnly = command.searchArgs.wholeWordOnly;\n        getSearchState(cm).setReversed(!forward);\n        var promptPrefix = (forward) ? '/' : '?';\n        var originalQuery = getSearchState(cm).getQuery();\n        var originalScrollPos = cm.getScrollInfo();\n        function handleQuery(query, ignoreCase, smartCase) {\n          vimGlobalState.searchHistoryController.pushInput(query);\n          vimGlobalState.searchHistoryController.reset();\n          try {\n            updateSearchQuery(cm, query, ignoreCase, smartCase);\n          } catch (e) {\n            showConfirm(cm, 'Invalid regex: ' + query);\n            clearInputState(cm);\n            return;\n          }\n          commandDispatcher.processMotion(cm, vim, {\n            type: 'motion',\n            motion: 'findNext',\n            motionArgs: { forward: true, toJumplist: command.searchArgs.toJumplist }\n          });\n        }\n        function onPromptClose(query) {\n          cm.scrollTo(originalScrollPos.left, originalScrollPos.top);\n          handleQuery(query, true /** ignoreCase */, true /** smartCase */);\n          var macroModeState = vimGlobalState.macroModeState;\n          if (macroModeState.isRecording) {\n            logSearchQuery(macroModeState, query);\n          }\n        }\n        function onPromptKeyUp(e, query, close) {\n          var keyName = CodeMirror.keyName(e), up, offset;\n          if (keyName == 'Up' || keyName == 'Down') {\n            up = keyName == 'Up' ? true : false;\n            offset = e.target ? e.target.selectionEnd : 0;\n            query = vimGlobalState.searchHistoryController.nextMatch(query, up) || '';\n            close(query);\n            if (offset && e.target) e.target.selectionEnd = e.target.selectionStart = Math.min(offset, e.target.value.length);\n          } else {\n            if ( keyName != 'Left' && keyName != 'Right' && keyName != 'Ctrl' && keyName != 'Alt' && keyName != 'Shift')\n              vimGlobalState.searchHistoryController.reset();\n          }\n          var parsedQuery;\n          try {\n            parsedQuery = updateSearchQuery(cm, query,\n                true /** ignoreCase */, true /** smartCase */);\n          } catch (e) {\n            // Swallow bad regexes for incremental search.\n          }\n          if (parsedQuery) {\n            cm.scrollIntoView(findNext(cm, !forward, parsedQuery), 30);\n          } else {\n            clearSearchHighlight(cm);\n            cm.scrollTo(originalScrollPos.left, originalScrollPos.top);\n          }\n        }\n        function onPromptKeyDown(e, query, close) {\n          var keyName = CodeMirror.keyName(e);\n          if (keyName == 'Esc' || keyName == 'Ctrl-C' || keyName == 'Ctrl-[' ||\n              (keyName == 'Backspace' && query == '')) {\n            vimGlobalState.searchHistoryController.pushInput(query);\n            vimGlobalState.searchHistoryController.reset();\n            updateSearchQuery(cm, originalQuery);\n            clearSearchHighlight(cm);\n            cm.scrollTo(originalScrollPos.left, originalScrollPos.top);\n            CodeMirror.e_stop(e);\n            clearInputState(cm);\n            close();\n            cm.focus();\n          } else if (keyName == 'Up' || keyName == 'Down') {\n            CodeMirror.e_stop(e);\n          } else if (keyName == 'Ctrl-U') {\n            // Ctrl-U clears input.\n            CodeMirror.e_stop(e);\n            close('');\n          }\n        }\n        switch (command.searchArgs.querySrc) {\n          case 'prompt':\n            var macroModeState = vimGlobalState.macroModeState;\n            if (macroModeState.isPlaying) {\n              var query = macroModeState.replaySearchQueries.shift();\n              handleQuery(query, true /** ignoreCase */, false /** smartCase */);\n            } else {\n              showPrompt(cm, {\n                  onClose: onPromptClose,\n                  prefix: promptPrefix,\n                  desc: searchPromptDesc,\n                  onKeyUp: onPromptKeyUp,\n                  onKeyDown: onPromptKeyDown\n              });\n            }\n            break;\n          case 'wordUnderCursor':\n            var word = expandWordUnderCursor(cm, false /** inclusive */,\n                true /** forward */, false /** bigWord */,\n                true /** noSymbol */);\n            var isKeyword = true;\n            if (!word) {\n              word = expandWordUnderCursor(cm, false /** inclusive */,\n                  true /** forward */, false /** bigWord */,\n                  false /** noSymbol */);\n              isKeyword = false;\n            }\n            if (!word) {\n              return;\n            }\n            var query = cm.getLine(word.start.line).substring(word.start.ch,\n                word.end.ch);\n            if (isKeyword && wholeWordOnly) {\n                query = '\\\\b' + query + '\\\\b';\n            } else {\n              query = escapeRegex(query);\n            }\n\n            // cachedCursor is used to save the old position of the cursor\n            // when * or # causes vim to seek for the nearest word and shift\n            // the cursor before entering the motion.\n            vimGlobalState.jumpList.cachedCursor = cm.getCursor();\n            cm.setCursor(word.start);\n\n            handleQuery(query, true /** ignoreCase */, false /** smartCase */);\n            break;\n        }\n      },\n      processEx: function(cm, vim, command) {\n        function onPromptClose(input) {\n          // Give the prompt some time to close so that if processCommand shows\n          // an error, the elements don't overlap.\n          vimGlobalState.exCommandHistoryController.pushInput(input);\n          vimGlobalState.exCommandHistoryController.reset();\n          exCommandDispatcher.processCommand(cm, input);\n        }\n        function onPromptKeyDown(e, input, close) {\n          var keyName = CodeMirror.keyName(e), up, offset;\n          if (keyName == 'Esc' || keyName == 'Ctrl-C' || keyName == 'Ctrl-[' ||\n              (keyName == 'Backspace' && input == '')) {\n            vimGlobalState.exCommandHistoryController.pushInput(input);\n            vimGlobalState.exCommandHistoryController.reset();\n            CodeMirror.e_stop(e);\n            clearInputState(cm);\n            close();\n            cm.focus();\n          }\n          if (keyName == 'Up' || keyName == 'Down') {\n            CodeMirror.e_stop(e);\n            up = keyName == 'Up' ? true : false;\n            offset = e.target ? e.target.selectionEnd : 0;\n            input = vimGlobalState.exCommandHistoryController.nextMatch(input, up) || '';\n            close(input);\n            if (offset && e.target) e.target.selectionEnd = e.target.selectionStart = Math.min(offset, e.target.value.length);\n          } else if (keyName == 'Ctrl-U') {\n            // Ctrl-U clears input.\n            CodeMirror.e_stop(e);\n            close('');\n          } else {\n            if ( keyName != 'Left' && keyName != 'Right' && keyName != 'Ctrl' && keyName != 'Alt' && keyName != 'Shift')\n              vimGlobalState.exCommandHistoryController.reset();\n          }\n        }\n        if (command.type == 'keyToEx') {\n          // Handle user defined Ex to Ex mappings\n          exCommandDispatcher.processCommand(cm, command.exArgs.input);\n        } else {\n          if (vim.visualMode) {\n            showPrompt(cm, { onClose: onPromptClose, prefix: ':', value: '\\'<,\\'>',\n                onKeyDown: onPromptKeyDown, selectValueOnOpen: false});\n          } else {\n            showPrompt(cm, { onClose: onPromptClose, prefix: ':',\n                onKeyDown: onPromptKeyDown});\n          }\n        }\n      },\n      evalInput: function(cm, vim) {\n        // If the motion command is set, execute both the operator and motion.\n        // Otherwise return.\n        var inputState = vim.inputState;\n        var motion = inputState.motion;\n        var motionArgs = inputState.motionArgs || {};\n        var operator = inputState.operator;\n        var operatorArgs = inputState.operatorArgs || {};\n        var registerName = inputState.registerName;\n        var sel = vim.sel;\n        // TODO: Make sure cm and vim selections are identical outside visual mode.\n        var origHead = copyCursor(vim.visualMode ? clipCursorToContent(cm, sel.head): cm.getCursor('head'));\n        var origAnchor = copyCursor(vim.visualMode ? clipCursorToContent(cm, sel.anchor) : cm.getCursor('anchor'));\n        var oldHead = copyCursor(origHead);\n        var oldAnchor = copyCursor(origAnchor);\n        var newHead, newAnchor;\n        var repeat;\n        if (operator) {\n          this.recordLastEdit(vim, inputState);\n        }\n        if (inputState.repeatOverride !== undefined) {\n          // If repeatOverride is specified, that takes precedence over the\n          // input state's repeat. Used by Ex mode and can be user defined.\n          repeat = inputState.repeatOverride;\n        } else {\n          repeat = inputState.getRepeat();\n        }\n        if (repeat > 0 && motionArgs.explicitRepeat) {\n          motionArgs.repeatIsExplicit = true;\n        } else if (motionArgs.noRepeat ||\n            (!motionArgs.explicitRepeat && repeat === 0)) {\n          repeat = 1;\n          motionArgs.repeatIsExplicit = false;\n        }\n        if (inputState.selectedCharacter) {\n          // If there is a character input, stick it in all of the arg arrays.\n          motionArgs.selectedCharacter = operatorArgs.selectedCharacter =\n              inputState.selectedCharacter;\n        }\n        motionArgs.repeat = repeat;\n        clearInputState(cm);\n        if (motion) {\n          var motionResult = motions[motion](cm, origHead, motionArgs, vim);\n          vim.lastMotion = motions[motion];\n          if (!motionResult) {\n            return;\n          }\n          if (motionArgs.toJumplist) {\n            var jumpList = vimGlobalState.jumpList;\n            // if the current motion is # or *, use cachedCursor\n            var cachedCursor = jumpList.cachedCursor;\n            if (cachedCursor) {\n              recordJumpPosition(cm, cachedCursor, motionResult);\n              delete jumpList.cachedCursor;\n            } else {\n              recordJumpPosition(cm, origHead, motionResult);\n            }\n          }\n          if (motionResult instanceof Array) {\n            newAnchor = motionResult[0];\n            newHead = motionResult[1];\n          } else {\n            newHead = motionResult;\n          }\n          // TODO: Handle null returns from motion commands better.\n          if (!newHead) {\n            newHead = copyCursor(origHead);\n          }\n          if (vim.visualMode) {\n            if (!(vim.visualBlock && newHead.ch === Infinity)) {\n              newHead = clipCursorToContent(cm, newHead);\n            }\n            if (newAnchor) {\n              newAnchor = clipCursorToContent(cm, newAnchor);\n            }\n            newAnchor = newAnchor || oldAnchor;\n            sel.anchor = newAnchor;\n            sel.head = newHead;\n            updateCmSelection(cm);\n            updateMark(cm, vim, '<',\n                cursorIsBefore(newAnchor, newHead) ? newAnchor\n                    : newHead);\n            updateMark(cm, vim, '>',\n                cursorIsBefore(newAnchor, newHead) ? newHead\n                    : newAnchor);\n          } else if (!operator) {\n            newHead = clipCursorToContent(cm, newHead);\n            cm.setCursor(newHead.line, newHead.ch);\n          }\n        }\n        if (operator) {\n          if (operatorArgs.lastSel) {\n            // Replaying a visual mode operation\n            newAnchor = oldAnchor;\n            var lastSel = operatorArgs.lastSel;\n            var lineOffset = Math.abs(lastSel.head.line - lastSel.anchor.line);\n            var chOffset = Math.abs(lastSel.head.ch - lastSel.anchor.ch);\n            if (lastSel.visualLine) {\n              // Linewise Visual mode: The same number of lines.\n              newHead = Pos(oldAnchor.line + lineOffset, oldAnchor.ch);\n            } else if (lastSel.visualBlock) {\n              // Blockwise Visual mode: The same number of lines and columns.\n              newHead = Pos(oldAnchor.line + lineOffset, oldAnchor.ch + chOffset);\n            } else if (lastSel.head.line == lastSel.anchor.line) {\n              // Normal Visual mode within one line: The same number of characters.\n              newHead = Pos(oldAnchor.line, oldAnchor.ch + chOffset);\n            } else {\n              // Normal Visual mode with several lines: The same number of lines, in the\n              // last line the same number of characters as in the last line the last time.\n              newHead = Pos(oldAnchor.line + lineOffset, oldAnchor.ch);\n            }\n            vim.visualMode = true;\n            vim.visualLine = lastSel.visualLine;\n            vim.visualBlock = lastSel.visualBlock;\n            sel = vim.sel = {\n              anchor: newAnchor,\n              head: newHead\n            };\n            updateCmSelection(cm);\n          } else if (vim.visualMode) {\n            operatorArgs.lastSel = {\n              anchor: copyCursor(sel.anchor),\n              head: copyCursor(sel.head),\n              visualBlock: vim.visualBlock,\n              visualLine: vim.visualLine\n            };\n          }\n          var curStart, curEnd, linewise, mode;\n          var cmSel;\n          if (vim.visualMode) {\n            // Init visual op\n            curStart = cursorMin(sel.head, sel.anchor);\n            curEnd = cursorMax(sel.head, sel.anchor);\n            linewise = vim.visualLine || operatorArgs.linewise;\n            mode = vim.visualBlock ? 'block' :\n                   linewise ? 'line' :\n                   'char';\n            cmSel = makeCmSelection(cm, {\n              anchor: curStart,\n              head: curEnd\n            }, mode);\n            if (linewise) {\n              var ranges = cmSel.ranges;\n              if (mode == 'block') {\n                // Linewise operators in visual block mode extend to end of line\n                for (var i = 0; i < ranges.length; i++) {\n                  ranges[i].head.ch = lineLength(cm, ranges[i].head.line);\n                }\n              } else if (mode == 'line') {\n                ranges[0].head = Pos(ranges[0].head.line + 1, 0);\n              }\n            }\n          } else {\n            // Init motion op\n            curStart = copyCursor(newAnchor || oldAnchor);\n            curEnd = copyCursor(newHead || oldHead);\n            if (cursorIsBefore(curEnd, curStart)) {\n              var tmp = curStart;\n              curStart = curEnd;\n              curEnd = tmp;\n            }\n            linewise = motionArgs.linewise || operatorArgs.linewise;\n            if (linewise) {\n              // Expand selection to entire line.\n              expandSelectionToLine(cm, curStart, curEnd);\n            } else if (motionArgs.forward) {\n              // Clip to trailing newlines only if the motion goes forward.\n              clipToLine(cm, curStart, curEnd);\n            }\n            mode = 'char';\n            var exclusive = !motionArgs.inclusive || linewise;\n            cmSel = makeCmSelection(cm, {\n              anchor: curStart,\n              head: curEnd\n            }, mode, exclusive);\n          }\n          cm.setSelections(cmSel.ranges, cmSel.primary);\n          vim.lastMotion = null;\n          operatorArgs.repeat = repeat; // For indent in visual mode.\n          operatorArgs.registerName = registerName;\n          // Keep track of linewise as it affects how paste and change behave.\n          operatorArgs.linewise = linewise;\n          var operatorMoveTo = operators[operator](\n            cm, operatorArgs, cmSel.ranges, oldAnchor, newHead);\n          if (vim.visualMode) {\n            exitVisualMode(cm, operatorMoveTo != null);\n          }\n          if (operatorMoveTo) {\n            cm.setCursor(operatorMoveTo);\n          }\n        }\n      },\n      recordLastEdit: function(vim, inputState, actionCommand) {\n        var macroModeState = vimGlobalState.macroModeState;\n        if (macroModeState.isPlaying) { return; }\n        vim.lastEditInputState = inputState;\n        vim.lastEditActionCommand = actionCommand;\n        macroModeState.lastInsertModeChanges.changes = [];\n        macroModeState.lastInsertModeChanges.expectCursorActivityForChange = false;\n        macroModeState.lastInsertModeChanges.visualBlock = vim.visualBlock ? vim.sel.head.line - vim.sel.anchor.line : 0;\n      }\n    };\n\n    /**\n     * typedef {Object{line:number,ch:number}} Cursor An object containing the\n     *     position of the cursor.\n     */\n    // All of the functions below return Cursor objects.\n    var motions = {\n      moveToTopLine: function(cm, _head, motionArgs) {\n        var line = getUserVisibleLines(cm).top + motionArgs.repeat -1;\n        return Pos(line, findFirstNonWhiteSpaceCharacter(cm.getLine(line)));\n      },\n      moveToMiddleLine: function(cm) {\n        var range = getUserVisibleLines(cm);\n        var line = Math.floor((range.top + range.bottom) * 0.5);\n        return Pos(line, findFirstNonWhiteSpaceCharacter(cm.getLine(line)));\n      },\n      moveToBottomLine: function(cm, _head, motionArgs) {\n        var line = getUserVisibleLines(cm).bottom - motionArgs.repeat +1;\n        return Pos(line, findFirstNonWhiteSpaceCharacter(cm.getLine(line)));\n      },\n      expandToLine: function(_cm, head, motionArgs) {\n        // Expands forward to end of line, and then to next line if repeat is\n        // >1. Does not handle backward motion!\n        var cur = head;\n        return Pos(cur.line + motionArgs.repeat - 1, Infinity);\n      },\n      findNext: function(cm, _head, motionArgs) {\n        var state = getSearchState(cm);\n        var query = state.getQuery();\n        if (!query) {\n          return;\n        }\n        var prev = !motionArgs.forward;\n        // If search is initiated with ? instead of /, negate direction.\n        prev = (state.isReversed()) ? !prev : prev;\n        highlightSearchMatches(cm, query);\n        return findNext(cm, prev/** prev */, query, motionArgs.repeat);\n      },\n      goToMark: function(cm, _head, motionArgs, vim) {\n        var pos = getMarkPos(cm, vim, motionArgs.selectedCharacter);\n        if (pos) {\n          return motionArgs.linewise ? { line: pos.line, ch: findFirstNonWhiteSpaceCharacter(cm.getLine(pos.line)) } : pos;\n        }\n        return null;\n      },\n      moveToOtherHighlightedEnd: function(cm, _head, motionArgs, vim) {\n        if (vim.visualBlock && motionArgs.sameLine) {\n          var sel = vim.sel;\n          return [\n            clipCursorToContent(cm, Pos(sel.anchor.line, sel.head.ch)),\n            clipCursorToContent(cm, Pos(sel.head.line, sel.anchor.ch))\n          ];\n        } else {\n          return ([vim.sel.head, vim.sel.anchor]);\n        }\n      },\n      jumpToMark: function(cm, head, motionArgs, vim) {\n        var best = head;\n        for (var i = 0; i < motionArgs.repeat; i++) {\n          var cursor = best;\n          for (var key in vim.marks) {\n            if (!isLowerCase(key)) {\n              continue;\n            }\n            var mark = vim.marks[key].find();\n            var isWrongDirection = (motionArgs.forward) ?\n              cursorIsBefore(mark, cursor) : cursorIsBefore(cursor, mark);\n\n            if (isWrongDirection) {\n              continue;\n            }\n            if (motionArgs.linewise && (mark.line == cursor.line)) {\n              continue;\n            }\n\n            var equal = cursorEqual(cursor, best);\n            var between = (motionArgs.forward) ?\n              cursorIsBetween(cursor, mark, best) :\n              cursorIsBetween(best, mark, cursor);\n\n            if (equal || between) {\n              best = mark;\n            }\n          }\n        }\n\n        if (motionArgs.linewise) {\n          // Vim places the cursor on the first non-whitespace character of\n          // the line if there is one, else it places the cursor at the end\n          // of the line, regardless of whether a mark was found.\n          best = Pos(best.line, findFirstNonWhiteSpaceCharacter(cm.getLine(best.line)));\n        }\n        return best;\n      },\n      moveByCharacters: function(_cm, head, motionArgs) {\n        var cur = head;\n        var repeat = motionArgs.repeat;\n        var ch = motionArgs.forward ? cur.ch + repeat : cur.ch - repeat;\n        return Pos(cur.line, ch);\n      },\n      moveByLines: function(cm, head, motionArgs, vim) {\n        var cur = head;\n        var endCh = cur.ch;\n        // Depending what our last motion was, we may want to do different\n        // things. If our last motion was moving vertically, we want to\n        // preserve the HPos from our last horizontal move.  If our last motion\n        // was going to the end of a line, moving vertically we should go to\n        // the end of the line, etc.\n        switch (vim.lastMotion) {\n          case this.moveByLines:\n          case this.moveByDisplayLines:\n          case this.moveByScroll:\n          case this.moveToColumn:\n          case this.moveToEol:\n            endCh = vim.lastHPos;\n            break;\n          default:\n            vim.lastHPos = endCh;\n        }\n        var repeat = motionArgs.repeat+(motionArgs.repeatOffset||0);\n        var line = motionArgs.forward ? cur.line + repeat : cur.line - repeat;\n        var first = cm.firstLine();\n        var last = cm.lastLine();\n        var posV = cm.findPosV(cur, (motionArgs.forward ? repeat : -repeat), 'line', vim.lastHSPos);\n        var hasMarkedText = motionArgs.forward ? posV.line > line : posV.line < line;\n        if (hasMarkedText) {\n          line = posV.line;\n          endCh = posV.ch;\n        }\n        // Vim go to line begin or line end when cursor at first/last line and\n        // move to previous/next line is triggered.\n        if (line < first && cur.line == first){\n          return this.moveToStartOfLine(cm, head, motionArgs, vim);\n        }else if (line > last && cur.line == last){\n            return this.moveToEol(cm, head, motionArgs, vim, true);\n        }\n        if (motionArgs.toFirstChar){\n          endCh=findFirstNonWhiteSpaceCharacter(cm.getLine(line));\n          vim.lastHPos = endCh;\n        }\n        vim.lastHSPos = cm.charCoords(Pos(line, endCh),'div').left;\n        return Pos(line, endCh);\n      },\n      moveByDisplayLines: function(cm, head, motionArgs, vim) {\n        var cur = head;\n        switch (vim.lastMotion) {\n          case this.moveByDisplayLines:\n          case this.moveByScroll:\n          case this.moveByLines:\n          case this.moveToColumn:\n          case this.moveToEol:\n            break;\n          default:\n            vim.lastHSPos = cm.charCoords(cur,'div').left;\n        }\n        var repeat = motionArgs.repeat;\n        var res=cm.findPosV(cur,(motionArgs.forward ? repeat : -repeat),'line',vim.lastHSPos);\n        if (res.hitSide) {\n          if (motionArgs.forward) {\n            var lastCharCoords = cm.charCoords(res, 'div');\n            var goalCoords = { top: lastCharCoords.top + 8, left: vim.lastHSPos };\n            var res = cm.coordsChar(goalCoords, 'div');\n          } else {\n            var resCoords = cm.charCoords(Pos(cm.firstLine(), 0), 'div');\n            resCoords.left = vim.lastHSPos;\n            res = cm.coordsChar(resCoords, 'div');\n          }\n        }\n        vim.lastHPos = res.ch;\n        return res;\n      },\n      moveByPage: function(cm, head, motionArgs) {\n        // CodeMirror only exposes functions that move the cursor page down, so\n        // doing this bad hack to move the cursor and move it back. evalInput\n        // will move the cursor to where it should be in the end.\n        var curStart = head;\n        var repeat = motionArgs.repeat;\n        return cm.findPosV(curStart, (motionArgs.forward ? repeat : -repeat), 'page');\n      },\n      moveByParagraph: function(cm, head, motionArgs) {\n        var dir = motionArgs.forward ? 1 : -1;\n        return findParagraph(cm, head, motionArgs.repeat, dir);\n      },\n      moveBySentence: function(cm, head, motionArgs) {\n        var dir = motionArgs.forward ? 1 : -1;\n        return findSentence(cm, head, motionArgs.repeat, dir);\n      },\n      moveByScroll: function(cm, head, motionArgs, vim) {\n        var scrollbox = cm.getScrollInfo();\n        var curEnd = null;\n        var repeat = motionArgs.repeat;\n        if (!repeat) {\n          repeat = scrollbox.clientHeight / (2 * cm.defaultTextHeight());\n        }\n        var orig = cm.charCoords(head, 'local');\n        motionArgs.repeat = repeat;\n        var curEnd = motions.moveByDisplayLines(cm, head, motionArgs, vim);\n        if (!curEnd) {\n          return null;\n        }\n        var dest = cm.charCoords(curEnd, 'local');\n        cm.scrollTo(null, scrollbox.top + dest.top - orig.top);\n        return curEnd;\n      },\n      moveByWords: function(cm, head, motionArgs) {\n        return moveToWord(cm, head, motionArgs.repeat, !!motionArgs.forward,\n            !!motionArgs.wordEnd, !!motionArgs.bigWord);\n      },\n      moveTillCharacter: function(cm, _head, motionArgs) {\n        var repeat = motionArgs.repeat;\n        var curEnd = moveToCharacter(cm, repeat, motionArgs.forward,\n            motionArgs.selectedCharacter);\n        var increment = motionArgs.forward ? -1 : 1;\n        recordLastCharacterSearch(increment, motionArgs);\n        if (!curEnd) return null;\n        curEnd.ch += increment;\n        return curEnd;\n      },\n      moveToCharacter: function(cm, head, motionArgs) {\n        var repeat = motionArgs.repeat;\n        recordLastCharacterSearch(0, motionArgs);\n        return moveToCharacter(cm, repeat, motionArgs.forward,\n            motionArgs.selectedCharacter) || head;\n      },\n      moveToSymbol: function(cm, head, motionArgs) {\n        var repeat = motionArgs.repeat;\n        return findSymbol(cm, repeat, motionArgs.forward,\n            motionArgs.selectedCharacter) || head;\n      },\n      moveToColumn: function(cm, head, motionArgs, vim) {\n        var repeat = motionArgs.repeat;\n        // repeat is equivalent to which column we want to move to!\n        vim.lastHPos = repeat - 1;\n        vim.lastHSPos = cm.charCoords(head,'div').left;\n        return moveToColumn(cm, repeat);\n      },\n      moveToEol: function(cm, head, motionArgs, vim, keepHPos) {\n        var cur = head;\n        var retval= Pos(cur.line + motionArgs.repeat - 1, Infinity);\n        var end=cm.clipPos(retval);\n        end.ch--;\n        if (!keepHPos) {\n          vim.lastHPos = Infinity;\n          vim.lastHSPos = cm.charCoords(end,'div').left;\n        }\n        return retval;\n      },\n      moveToFirstNonWhiteSpaceCharacter: function(cm, head) {\n        // Go to the start of the line where the text begins, or the end for\n        // whitespace-only lines\n        var cursor = head;\n        return Pos(cursor.line,\n                   findFirstNonWhiteSpaceCharacter(cm.getLine(cursor.line)));\n      },\n      moveToMatchedSymbol: function(cm, head) {\n        var cursor = head;\n        var line = cursor.line;\n        var ch = cursor.ch;\n        var lineText = cm.getLine(line);\n        var symbol;\n        for (; ch < lineText.length; ch++) {\n          symbol = lineText.charAt(ch);\n          if (symbol && isMatchableSymbol(symbol)) {\n            var style = cm.getTokenTypeAt(Pos(line, ch + 1));\n            if (style !== \"string\" && style !== \"comment\") {\n              break;\n            }\n          }\n        }\n        if (ch < lineText.length) {\n          // Only include angle brackets in analysis if they are being matched.\n          var re = (ch === '<' || ch === '>') ? /[(){}[\\]<>]/ : /[(){}[\\]]/;\n          var matched = cm.findMatchingBracket(Pos(line, ch), {bracketRegex: re});\n          return matched.to;\n        } else {\n          return cursor;\n        }\n      },\n      moveToStartOfLine: function(_cm, head) {\n        return Pos(head.line, 0);\n      },\n      moveToLineOrEdgeOfDocument: function(cm, _head, motionArgs) {\n        var lineNum = motionArgs.forward ? cm.lastLine() : cm.firstLine();\n        if (motionArgs.repeatIsExplicit) {\n          lineNum = motionArgs.repeat - cm.getOption('firstLineNumber');\n        }\n        return Pos(lineNum,\n                   findFirstNonWhiteSpaceCharacter(cm.getLine(lineNum)));\n      },\n      textObjectManipulation: function(cm, head, motionArgs, vim) {\n        // TODO: lots of possible exceptions that can be thrown here. Try da(\n        //     outside of a () block.\n        var mirroredPairs = {'(': ')', ')': '(',\n                             '{': '}', '}': '{',\n                             '[': ']', ']': '[',\n                             '<': '>', '>': '<'};\n        var selfPaired = {'\\'': true, '\"': true, '`': true};\n\n        var character = motionArgs.selectedCharacter;\n        // 'b' refers to  '()' block.\n        // 'B' refers to  '{}' block.\n        if (character == 'b') {\n          character = '(';\n        } else if (character == 'B') {\n          character = '{';\n        }\n\n        // Inclusive is the difference between a and i\n        // TODO: Instead of using the additional text object map to perform text\n        //     object operations, merge the map into the defaultKeyMap and use\n        //     motionArgs to define behavior. Define separate entries for 'aw',\n        //     'iw', 'a[', 'i[', etc.\n        var inclusive = !motionArgs.textObjectInner;\n\n        var tmp;\n        if (mirroredPairs[character]) {\n          tmp = selectCompanionObject(cm, head, character, inclusive);\n        } else if (selfPaired[character]) {\n          tmp = findBeginningAndEnd(cm, head, character, inclusive);\n        } else if (character === 'W') {\n          tmp = expandWordUnderCursor(cm, inclusive, true /** forward */,\n                                                     true /** bigWord */);\n        } else if (character === 'w') {\n          tmp = expandWordUnderCursor(cm, inclusive, true /** forward */,\n                                                     false /** bigWord */);\n        } else if (character === 'p') {\n          tmp = findParagraph(cm, head, motionArgs.repeat, 0, inclusive);\n          motionArgs.linewise = true;\n          if (vim.visualMode) {\n            if (!vim.visualLine) { vim.visualLine = true; }\n          } else {\n            var operatorArgs = vim.inputState.operatorArgs;\n            if (operatorArgs) { operatorArgs.linewise = true; }\n            tmp.end.line--;\n          }\n        } else {\n          // No text object defined for this, don't move.\n          return null;\n        }\n\n        if (!cm.state.vim.visualMode) {\n          return [tmp.start, tmp.end];\n        } else {\n          return expandSelection(cm, tmp.start, tmp.end);\n        }\n      },\n\n      repeatLastCharacterSearch: function(cm, head, motionArgs) {\n        var lastSearch = vimGlobalState.lastCharacterSearch;\n        var repeat = motionArgs.repeat;\n        var forward = motionArgs.forward === lastSearch.forward;\n        var increment = (lastSearch.increment ? 1 : 0) * (forward ? -1 : 1);\n        cm.moveH(-increment, 'char');\n        motionArgs.inclusive = forward ? true : false;\n        var curEnd = moveToCharacter(cm, repeat, forward, lastSearch.selectedCharacter);\n        if (!curEnd) {\n          cm.moveH(increment, 'char');\n          return head;\n        }\n        curEnd.ch += increment;\n        return curEnd;\n      }\n    };\n\n    function defineMotion(name, fn) {\n      motions[name] = fn;\n    }\n\n    function fillArray(val, times) {\n      var arr = [];\n      for (var i = 0; i < times; i++) {\n        arr.push(val);\n      }\n      return arr;\n    }\n    /**\n     * An operator acts on a text selection. It receives the list of selections\n     * as input. The corresponding CodeMirror selection is guaranteed to\n    * match the input selection.\n     */\n    var operators = {\n      change: function(cm, args, ranges) {\n        var finalHead, text;\n        var vim = cm.state.vim;\n        var anchor = ranges[0].anchor,\n            head = ranges[0].head;\n        if (!vim.visualMode) {\n          text = cm.getRange(anchor, head);\n          var lastState = vim.lastEditInputState || {};\n          if (lastState.motion == \"moveByWords\" && !isWhiteSpaceString(text)) {\n            // Exclude trailing whitespace if the range is not all whitespace.\n            var match = (/\\s+$/).exec(text);\n            if (match && lastState.motionArgs && lastState.motionArgs.forward) {\n              head = offsetCursor(head, 0, - match[0].length);\n              text = text.slice(0, - match[0].length);\n            }\n          }\n          var prevLineEnd = new Pos(anchor.line - 1, Number.MAX_VALUE);\n          var wasLastLine = cm.firstLine() == cm.lastLine();\n          if (head.line > cm.lastLine() && args.linewise && !wasLastLine) {\n            cm.replaceRange('', prevLineEnd, head);\n          } else {\n            cm.replaceRange('', anchor, head);\n          }\n          if (args.linewise) {\n            // Push the next line back down, if there is a next line.\n            if (!wasLastLine) {\n              cm.setCursor(prevLineEnd);\n              CodeMirror.commands.newlineAndIndent(cm);\n            }\n            // make sure cursor ends up at the end of the line.\n            anchor.ch = Number.MAX_VALUE;\n          }\n          finalHead = anchor;\n        } else if (args.fullLine) {\n            head.ch = Number.MAX_VALUE;\n            head.line--;\n            cm.setSelection(anchor, head)\n            text = cm.getSelection();\n            cm.replaceSelection(\"\");\n            finalHead = anchor;\n        } else {\n          text = cm.getSelection();\n          var replacement = fillArray('', ranges.length);\n          cm.replaceSelections(replacement);\n          finalHead = cursorMin(ranges[0].head, ranges[0].anchor);\n        }\n        vimGlobalState.registerController.pushText(\n            args.registerName, 'change', text,\n            args.linewise, ranges.length > 1);\n        actions.enterInsertMode(cm, {head: finalHead}, cm.state.vim);\n      },\n      // delete is a javascript keyword.\n      'delete': function(cm, args, ranges) {\n        var finalHead, text;\n        var vim = cm.state.vim;\n        if (!vim.visualBlock) {\n          var anchor = ranges[0].anchor,\n              head = ranges[0].head;\n          if (args.linewise &&\n              head.line != cm.firstLine() &&\n              anchor.line == cm.lastLine() &&\n              anchor.line == head.line - 1) {\n            // Special case for dd on last line (and first line).\n            if (anchor.line == cm.firstLine()) {\n              anchor.ch = 0;\n            } else {\n              anchor = Pos(anchor.line - 1, lineLength(cm, anchor.line - 1));\n            }\n          }\n          text = cm.getRange(anchor, head);\n          cm.replaceRange('', anchor, head);\n          finalHead = anchor;\n          if (args.linewise) {\n            finalHead = motions.moveToFirstNonWhiteSpaceCharacter(cm, anchor);\n          }\n        } else {\n          text = cm.getSelection();\n          var replacement = fillArray('', ranges.length);\n          cm.replaceSelections(replacement);\n          finalHead = ranges[0].anchor;\n        }\n        vimGlobalState.registerController.pushText(\n            args.registerName, 'delete', text,\n            args.linewise, vim.visualBlock);\n        return clipCursorToContent(cm, finalHead);\n      },\n      indent: function(cm, args, ranges) {\n        var vim = cm.state.vim;\n        var startLine = ranges[0].anchor.line;\n        var endLine = vim.visualBlock ?\n          ranges[ranges.length - 1].anchor.line :\n          ranges[0].head.line;\n        // In visual mode, n> shifts the selection right n times, instead of\n        // shifting n lines right once.\n        var repeat = (vim.visualMode) ? args.repeat : 1;\n        if (args.linewise) {\n          // The only way to delete a newline is to delete until the start of\n          // the next line, so in linewise mode evalInput will include the next\n          // line. We don't want this in indent, so we go back a line.\n          endLine--;\n        }\n        for (var i = startLine; i <= endLine; i++) {\n          for (var j = 0; j < repeat; j++) {\n            cm.indentLine(i, args.indentRight);\n          }\n        }\n        return motions.moveToFirstNonWhiteSpaceCharacter(cm, ranges[0].anchor);\n      },\n      indentAuto: function(cm, _args, ranges) {\n        cm.execCommand(\"indentAuto\");\n        return motions.moveToFirstNonWhiteSpaceCharacter(cm, ranges[0].anchor);\n      },\n      changeCase: function(cm, args, ranges, oldAnchor, newHead) {\n        var selections = cm.getSelections();\n        var swapped = [];\n        var toLower = args.toLower;\n        for (var j = 0; j < selections.length; j++) {\n          var toSwap = selections[j];\n          var text = '';\n          if (toLower === true) {\n            text = toSwap.toLowerCase();\n          } else if (toLower === false) {\n            text = toSwap.toUpperCase();\n          } else {\n            for (var i = 0; i < toSwap.length; i++) {\n              var character = toSwap.charAt(i);\n              text += isUpperCase(character) ? character.toLowerCase() :\n                  character.toUpperCase();\n            }\n          }\n          swapped.push(text);\n        }\n        cm.replaceSelections(swapped);\n        if (args.shouldMoveCursor){\n          return newHead;\n        } else if (!cm.state.vim.visualMode && args.linewise && ranges[0].anchor.line + 1 == ranges[0].head.line) {\n          return motions.moveToFirstNonWhiteSpaceCharacter(cm, oldAnchor);\n        } else if (args.linewise){\n          return oldAnchor;\n        } else {\n          return cursorMin(ranges[0].anchor, ranges[0].head);\n        }\n      },\n      yank: function(cm, args, ranges, oldAnchor) {\n        var vim = cm.state.vim;\n        var text = cm.getSelection();\n        var endPos = vim.visualMode\n          ? cursorMin(vim.sel.anchor, vim.sel.head, ranges[0].head, ranges[0].anchor)\n          : oldAnchor;\n        vimGlobalState.registerController.pushText(\n            args.registerName, 'yank',\n            text, args.linewise, vim.visualBlock);\n        return endPos;\n      }\n    };\n\n    function defineOperator(name, fn) {\n      operators[name] = fn;\n    }\n\n    var actions = {\n      jumpListWalk: function(cm, actionArgs, vim) {\n        if (vim.visualMode) {\n          return;\n        }\n        var repeat = actionArgs.repeat;\n        var forward = actionArgs.forward;\n        var jumpList = vimGlobalState.jumpList;\n\n        var mark = jumpList.move(cm, forward ? repeat : -repeat);\n        var markPos = mark ? mark.find() : undefined;\n        markPos = markPos ? markPos : cm.getCursor();\n        cm.setCursor(markPos);\n      },\n      scroll: function(cm, actionArgs, vim) {\n        if (vim.visualMode) {\n          return;\n        }\n        var repeat = actionArgs.repeat || 1;\n        var lineHeight = cm.defaultTextHeight();\n        var top = cm.getScrollInfo().top;\n        var delta = lineHeight * repeat;\n        var newPos = actionArgs.forward ? top + delta : top - delta;\n        var cursor = copyCursor(cm.getCursor());\n        var cursorCoords = cm.charCoords(cursor, 'local');\n        if (actionArgs.forward) {\n          if (newPos > cursorCoords.top) {\n             cursor.line += (newPos - cursorCoords.top) / lineHeight;\n             cursor.line = Math.ceil(cursor.line);\n             cm.setCursor(cursor);\n             cursorCoords = cm.charCoords(cursor, 'local');\n             cm.scrollTo(null, cursorCoords.top);\n          } else {\n             // Cursor stays within bounds.  Just reposition the scroll window.\n             cm.scrollTo(null, newPos);\n          }\n        } else {\n          var newBottom = newPos + cm.getScrollInfo().clientHeight;\n          if (newBottom < cursorCoords.bottom) {\n             cursor.line -= (cursorCoords.bottom - newBottom) / lineHeight;\n             cursor.line = Math.floor(cursor.line);\n             cm.setCursor(cursor);\n             cursorCoords = cm.charCoords(cursor, 'local');\n             cm.scrollTo(\n                 null, cursorCoords.bottom - cm.getScrollInfo().clientHeight);\n          } else {\n             // Cursor stays within bounds.  Just reposition the scroll window.\n             cm.scrollTo(null, newPos);\n          }\n        }\n      },\n      scrollToCursor: function(cm, actionArgs) {\n        var lineNum = cm.getCursor().line;\n        var charCoords = cm.charCoords(Pos(lineNum, 0), 'local');\n        var height = cm.getScrollInfo().clientHeight;\n        var y = charCoords.top;\n        var lineHeight = charCoords.bottom - y;\n        switch (actionArgs.position) {\n          case 'center': y = y - (height / 2) + lineHeight;\n            break;\n          case 'bottom': y = y - height + lineHeight;\n            break;\n        }\n        cm.scrollTo(null, y);\n      },\n      replayMacro: function(cm, actionArgs, vim) {\n        var registerName = actionArgs.selectedCharacter;\n        var repeat = actionArgs.repeat;\n        var macroModeState = vimGlobalState.macroModeState;\n        if (registerName == '@') {\n          registerName = macroModeState.latestRegister;\n        } else {\n          macroModeState.latestRegister = registerName;\n        }\n        while(repeat--){\n          executeMacroRegister(cm, vim, macroModeState, registerName);\n        }\n      },\n      enterMacroRecordMode: function(cm, actionArgs) {\n        var macroModeState = vimGlobalState.macroModeState;\n        var registerName = actionArgs.selectedCharacter;\n        if (vimGlobalState.registerController.isValidRegister(registerName)) {\n          macroModeState.enterMacroRecordMode(cm, registerName);\n        }\n      },\n      toggleOverwrite: function(cm) {\n        if (!cm.state.overwrite) {\n          cm.toggleOverwrite(true);\n          cm.setOption('keyMap', 'vim-replace');\n          CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"replace\"});\n        } else {\n          cm.toggleOverwrite(false);\n          cm.setOption('keyMap', 'vim-insert');\n          CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"insert\"});\n        }\n      },\n      enterInsertMode: function(cm, actionArgs, vim) {\n        if (cm.getOption('readOnly')) { return; }\n        vim.insertMode = true;\n        vim.insertModeRepeat = actionArgs && actionArgs.repeat || 1;\n        var insertAt = (actionArgs) ? actionArgs.insertAt : null;\n        var sel = vim.sel;\n        var head = actionArgs.head || cm.getCursor('head');\n        var height = cm.listSelections().length;\n        if (insertAt == 'eol') {\n          head = Pos(head.line, lineLength(cm, head.line));\n        } else if (insertAt == 'bol') {\n          head = Pos(head.line, 0);\n        } else if (insertAt == 'charAfter') {\n          head = offsetCursor(head, 0, 1);\n        } else if (insertAt == 'firstNonBlank') {\n          head = motions.moveToFirstNonWhiteSpaceCharacter(cm, head);\n        } else if (insertAt == 'startOfSelectedArea') {\n          if (!vim.visualMode)\n              return;\n          if (!vim.visualBlock) {\n            if (sel.head.line < sel.anchor.line) {\n              head = sel.head;\n            } else {\n              head = Pos(sel.anchor.line, 0);\n            }\n          } else {\n            head = Pos(\n                Math.min(sel.head.line, sel.anchor.line),\n                Math.min(sel.head.ch, sel.anchor.ch));\n            height = Math.abs(sel.head.line - sel.anchor.line) + 1;\n          }\n        } else if (insertAt == 'endOfSelectedArea') {\n            if (!vim.visualMode)\n              return;\n          if (!vim.visualBlock) {\n            if (sel.head.line >= sel.anchor.line) {\n              head = offsetCursor(sel.head, 0, 1);\n            } else {\n              head = Pos(sel.anchor.line, 0);\n            }\n          } else {\n            head = Pos(\n                Math.min(sel.head.line, sel.anchor.line),\n                Math.max(sel.head.ch + 1, sel.anchor.ch));\n            height = Math.abs(sel.head.line - sel.anchor.line) + 1;\n          }\n        } else if (insertAt == 'inplace') {\n          if (vim.visualMode){\n            return;\n          }\n        } else if (insertAt == 'lastEdit') {\n          head = getLastEditPos(cm) || head;\n        }\n        cm.setOption('disableInput', false);\n        if (actionArgs && actionArgs.replace) {\n          // Handle Replace-mode as a special case of insert mode.\n          cm.toggleOverwrite(true);\n          cm.setOption('keyMap', 'vim-replace');\n          CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"replace\"});\n        } else {\n          cm.toggleOverwrite(false);\n          cm.setOption('keyMap', 'vim-insert');\n          CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"insert\"});\n        }\n        if (!vimGlobalState.macroModeState.isPlaying) {\n          // Only record if not replaying.\n          cm.on('change', onChange);\n          CodeMirror.on(cm.getInputField(), 'keydown', onKeyEventTargetKeyDown);\n        }\n        if (vim.visualMode) {\n          exitVisualMode(cm);\n        }\n        selectForInsert(cm, head, height);\n      },\n      toggleVisualMode: function(cm, actionArgs, vim) {\n        var repeat = actionArgs.repeat;\n        var anchor = cm.getCursor();\n        var head;\n        // TODO: The repeat should actually select number of characters/lines\n        //     equal to the repeat times the size of the previous visual\n        //     operation.\n        if (!vim.visualMode) {\n          // Entering visual mode\n          vim.visualMode = true;\n          vim.visualLine = !!actionArgs.linewise;\n          vim.visualBlock = !!actionArgs.blockwise;\n          head = clipCursorToContent(\n              cm, Pos(anchor.line, anchor.ch + repeat - 1));\n          vim.sel = {\n            anchor: anchor,\n            head: head\n          };\n          CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"visual\", subMode: vim.visualLine ? \"linewise\" : vim.visualBlock ? \"blockwise\" : \"\"});\n          updateCmSelection(cm);\n          updateMark(cm, vim, '<', cursorMin(anchor, head));\n          updateMark(cm, vim, '>', cursorMax(anchor, head));\n        } else if (vim.visualLine ^ actionArgs.linewise ||\n            vim.visualBlock ^ actionArgs.blockwise) {\n          // Toggling between modes\n          vim.visualLine = !!actionArgs.linewise;\n          vim.visualBlock = !!actionArgs.blockwise;\n          CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"visual\", subMode: vim.visualLine ? \"linewise\" : vim.visualBlock ? \"blockwise\" : \"\"});\n          updateCmSelection(cm);\n        } else {\n          exitVisualMode(cm);\n        }\n      },\n      reselectLastSelection: function(cm, _actionArgs, vim) {\n        var lastSelection = vim.lastSelection;\n        if (vim.visualMode) {\n          updateLastSelection(cm, vim);\n        }\n        if (lastSelection) {\n          var anchor = lastSelection.anchorMark.find();\n          var head = lastSelection.headMark.find();\n          if (!anchor || !head) {\n            // If the marks have been destroyed due to edits, do nothing.\n            return;\n          }\n          vim.sel = {\n            anchor: anchor,\n            head: head\n          };\n          vim.visualMode = true;\n          vim.visualLine = lastSelection.visualLine;\n          vim.visualBlock = lastSelection.visualBlock;\n          updateCmSelection(cm);\n          updateMark(cm, vim, '<', cursorMin(anchor, head));\n          updateMark(cm, vim, '>', cursorMax(anchor, head));\n          CodeMirror.signal(cm, 'vim-mode-change', {\n            mode: 'visual',\n            subMode: vim.visualLine ? 'linewise' :\n                     vim.visualBlock ? 'blockwise' : ''});\n        }\n      },\n      joinLines: function(cm, actionArgs, vim) {\n        var curStart, curEnd;\n        if (vim.visualMode) {\n          curStart = cm.getCursor('anchor');\n          curEnd = cm.getCursor('head');\n          if (cursorIsBefore(curEnd, curStart)) {\n            var tmp = curEnd;\n            curEnd = curStart;\n            curStart = tmp;\n          }\n          curEnd.ch = lineLength(cm, curEnd.line) - 1;\n        } else {\n          // Repeat is the number of lines to join. Minimum 2 lines.\n          var repeat = Math.max(actionArgs.repeat, 2);\n          curStart = cm.getCursor();\n          curEnd = clipCursorToContent(cm, Pos(curStart.line + repeat - 1,\n                                               Infinity));\n        }\n        var finalCh = 0;\n        for (var i = curStart.line; i < curEnd.line; i++) {\n          finalCh = lineLength(cm, curStart.line);\n          var tmp = Pos(curStart.line + 1,\n                        lineLength(cm, curStart.line + 1));\n          var text = cm.getRange(curStart, tmp);\n          text = actionArgs.keepSpaces\n            ? text.replace(/\\n\\r?/g, '')\n            : text.replace(/\\n\\s*/g, ' ');\n          cm.replaceRange(text, curStart, tmp);\n        }\n        var curFinalPos = Pos(curStart.line, finalCh);\n        if (vim.visualMode) {\n          exitVisualMode(cm, false);\n        }\n        cm.setCursor(curFinalPos);\n      },\n      newLineAndEnterInsertMode: function(cm, actionArgs, vim) {\n        vim.insertMode = true;\n        var insertAt = copyCursor(cm.getCursor());\n        if (insertAt.line === cm.firstLine() && !actionArgs.after) {\n          // Special case for inserting newline before start of document.\n          cm.replaceRange('\\n', Pos(cm.firstLine(), 0));\n          cm.setCursor(cm.firstLine(), 0);\n        } else {\n          insertAt.line = (actionArgs.after) ? insertAt.line :\n              insertAt.line - 1;\n          insertAt.ch = lineLength(cm, insertAt.line);\n          cm.setCursor(insertAt);\n          var newlineFn = CodeMirror.commands.newlineAndIndentContinueComment ||\n              CodeMirror.commands.newlineAndIndent;\n          newlineFn(cm);\n        }\n        this.enterInsertMode(cm, { repeat: actionArgs.repeat }, vim);\n      },\n      paste: function(cm, actionArgs, vim) {\n        var cur = copyCursor(cm.getCursor());\n        var register = vimGlobalState.registerController.getRegister(\n            actionArgs.registerName);\n        var text = register.toString();\n        if (!text) {\n          return;\n        }\n        if (actionArgs.matchIndent) {\n          var tabSize = cm.getOption(\"tabSize\");\n          // length that considers tabs and tabSize\n          var whitespaceLength = function(str) {\n            var tabs = (str.split(\"\\t\").length - 1);\n            var spaces = (str.split(\" \").length - 1);\n            return tabs * tabSize + spaces * 1;\n          };\n          var currentLine = cm.getLine(cm.getCursor().line);\n          var indent = whitespaceLength(currentLine.match(/^\\s*/)[0]);\n          // chomp last newline b/c don't want it to match /^\\s*/gm\n          var chompedText = text.replace(/\\n$/, '');\n          var wasChomped = text !== chompedText;\n          var firstIndent = whitespaceLength(text.match(/^\\s*/)[0]);\n          var text = chompedText.replace(/^\\s*/gm, function(wspace) {\n            var newIndent = indent + (whitespaceLength(wspace) - firstIndent);\n            if (newIndent < 0) {\n              return \"\";\n            }\n            else if (cm.getOption(\"indentWithTabs\")) {\n              var quotient = Math.floor(newIndent / tabSize);\n              return Array(quotient + 1).join('\\t');\n            }\n            else {\n              return Array(newIndent + 1).join(' ');\n            }\n          });\n          text += wasChomped ? \"\\n\" : \"\";\n        }\n        if (actionArgs.repeat > 1) {\n          var text = Array(actionArgs.repeat + 1).join(text);\n        }\n        var linewise = register.linewise;\n        var blockwise = register.blockwise;\n        if (blockwise) {\n          text = text.split('\\n');\n          if (linewise) {\n              text.pop();\n          }\n          for (var i = 0; i < text.length; i++) {\n            text[i] = (text[i] == '') ? ' ' : text[i];\n          }\n          cur.ch += actionArgs.after ? 1 : 0;\n          cur.ch = Math.min(lineLength(cm, cur.line), cur.ch);\n        } else if (linewise) {\n          if(vim.visualMode) {\n            text = vim.visualLine ? text.slice(0, -1) : '\\n' + text.slice(0, text.length - 1) + '\\n';\n          } else if (actionArgs.after) {\n            // Move the newline at the end to the start instead, and paste just\n            // before the newline character of the line we are on right now.\n            text = '\\n' + text.slice(0, text.length - 1);\n            cur.ch = lineLength(cm, cur.line);\n          } else {\n            cur.ch = 0;\n          }\n        } else {\n          cur.ch += actionArgs.after ? 1 : 0;\n        }\n        var curPosFinal;\n        var idx;\n        if (vim.visualMode) {\n          //  save the pasted text for reselection if the need arises\n          vim.lastPastedText = text;\n          var lastSelectionCurEnd;\n          var selectedArea = getSelectedAreaRange(cm, vim);\n          var selectionStart = selectedArea[0];\n          var selectionEnd = selectedArea[1];\n          var selectedText = cm.getSelection();\n          var selections = cm.listSelections();\n          var emptyStrings = new Array(selections.length).join('1').split('1');\n          // save the curEnd marker before it get cleared due to cm.replaceRange.\n          if (vim.lastSelection) {\n            lastSelectionCurEnd = vim.lastSelection.headMark.find();\n          }\n          // push the previously selected text to unnamed register\n          vimGlobalState.registerController.unnamedRegister.setText(selectedText);\n          if (blockwise) {\n            // first delete the selected text\n            cm.replaceSelections(emptyStrings);\n            // Set new selections as per the block length of the yanked text\n            selectionEnd = Pos(selectionStart.line + text.length-1, selectionStart.ch);\n            cm.setCursor(selectionStart);\n            selectBlock(cm, selectionEnd);\n            cm.replaceSelections(text);\n            curPosFinal = selectionStart;\n          } else if (vim.visualBlock) {\n            cm.replaceSelections(emptyStrings);\n            cm.setCursor(selectionStart);\n            cm.replaceRange(text, selectionStart, selectionStart);\n            curPosFinal = selectionStart;\n          } else {\n            cm.replaceRange(text, selectionStart, selectionEnd);\n            curPosFinal = cm.posFromIndex(cm.indexFromPos(selectionStart) + text.length - 1);\n          }\n          // restore the the curEnd marker\n          if(lastSelectionCurEnd) {\n            vim.lastSelection.headMark = cm.setBookmark(lastSelectionCurEnd);\n          }\n          if (linewise) {\n            curPosFinal.ch=0;\n          }\n        } else {\n          if (blockwise) {\n            cm.setCursor(cur);\n            for (var i = 0; i < text.length; i++) {\n              var line = cur.line+i;\n              if (line > cm.lastLine()) {\n                cm.replaceRange('\\n',  Pos(line, 0));\n              }\n              var lastCh = lineLength(cm, line);\n              if (lastCh < cur.ch) {\n                extendLineToColumn(cm, line, cur.ch);\n              }\n            }\n            cm.setCursor(cur);\n            selectBlock(cm, Pos(cur.line + text.length-1, cur.ch));\n            cm.replaceSelections(text);\n            curPosFinal = cur;\n          } else {\n            cm.replaceRange(text, cur);\n            // Now fine tune the cursor to where we want it.\n            if (linewise && actionArgs.after) {\n              curPosFinal = Pos(\n              cur.line + 1,\n              findFirstNonWhiteSpaceCharacter(cm.getLine(cur.line + 1)));\n            } else if (linewise && !actionArgs.after) {\n              curPosFinal = Pos(\n                cur.line,\n                findFirstNonWhiteSpaceCharacter(cm.getLine(cur.line)));\n            } else if (!linewise && actionArgs.after) {\n              idx = cm.indexFromPos(cur);\n              curPosFinal = cm.posFromIndex(idx + text.length - 1);\n            } else {\n              idx = cm.indexFromPos(cur);\n              curPosFinal = cm.posFromIndex(idx + text.length);\n            }\n          }\n        }\n        if (vim.visualMode) {\n          exitVisualMode(cm, false);\n        }\n        cm.setCursor(curPosFinal);\n      },\n      undo: function(cm, actionArgs) {\n        cm.operation(function() {\n          repeatFn(cm, CodeMirror.commands.undo, actionArgs.repeat)();\n          cm.setCursor(cm.getCursor('anchor'));\n        });\n      },\n      redo: function(cm, actionArgs) {\n        repeatFn(cm, CodeMirror.commands.redo, actionArgs.repeat)();\n      },\n      setRegister: function(_cm, actionArgs, vim) {\n        vim.inputState.registerName = actionArgs.selectedCharacter;\n      },\n      setMark: function(cm, actionArgs, vim) {\n        var markName = actionArgs.selectedCharacter;\n        updateMark(cm, vim, markName, cm.getCursor());\n      },\n      replace: function(cm, actionArgs, vim) {\n        var replaceWith = actionArgs.selectedCharacter;\n        var curStart = cm.getCursor();\n        var replaceTo;\n        var curEnd;\n        var selections = cm.listSelections();\n        if (vim.visualMode) {\n          curStart = cm.getCursor('start');\n          curEnd = cm.getCursor('end');\n        } else {\n          var line = cm.getLine(curStart.line);\n          replaceTo = curStart.ch + actionArgs.repeat;\n          if (replaceTo > line.length) {\n            replaceTo=line.length;\n          }\n          curEnd = Pos(curStart.line, replaceTo);\n        }\n        if (replaceWith=='\\n') {\n          if (!vim.visualMode) cm.replaceRange('', curStart, curEnd);\n          // special case, where vim help says to replace by just one line-break\n          (CodeMirror.commands.newlineAndIndentContinueComment || CodeMirror.commands.newlineAndIndent)(cm);\n        } else {\n          var replaceWithStr = cm.getRange(curStart, curEnd);\n          //replace all characters in range by selected, but keep linebreaks\n          replaceWithStr = replaceWithStr.replace(/[^\\n]/g, replaceWith);\n          if (vim.visualBlock) {\n            // Tabs are split in visua block before replacing\n            var spaces = new Array(cm.getOption(\"tabSize\")+1).join(' ');\n            replaceWithStr = cm.getSelection();\n            replaceWithStr = replaceWithStr.replace(/\\t/g, spaces).replace(/[^\\n]/g, replaceWith).split('\\n');\n            cm.replaceSelections(replaceWithStr);\n          } else {\n            cm.replaceRange(replaceWithStr, curStart, curEnd);\n          }\n          if (vim.visualMode) {\n            curStart = cursorIsBefore(selections[0].anchor, selections[0].head) ?\n                         selections[0].anchor : selections[0].head;\n            cm.setCursor(curStart);\n            exitVisualMode(cm, false);\n          } else {\n            cm.setCursor(offsetCursor(curEnd, 0, -1));\n          }\n        }\n      },\n      incrementNumberToken: function(cm, actionArgs) {\n        var cur = cm.getCursor();\n        var lineStr = cm.getLine(cur.line);\n        var re = /(-?)(?:(0x)([\\da-f]+)|(0b|0|)(\\d+))/gi;\n        var match;\n        var start;\n        var end;\n        var numberStr;\n        while ((match = re.exec(lineStr)) !== null) {\n          start = match.index;\n          end = start + match[0].length;\n          if (cur.ch < end)break;\n        }\n        if (!actionArgs.backtrack && (end <= cur.ch))return;\n        if (match) {\n          var baseStr = match[2] || match[4]\n          var digits = match[3] || match[5]\n          var increment = actionArgs.increase ? 1 : -1;\n          var base = {'0b': 2, '0': 8, '': 10, '0x': 16}[baseStr.toLowerCase()];\n          var number = parseInt(match[1] + digits, base) + (increment * actionArgs.repeat);\n          numberStr = number.toString(base);\n          var zeroPadding = baseStr ? new Array(digits.length - numberStr.length + 1 + match[1].length).join('0') : ''\n          if (numberStr.charAt(0) === '-') {\n            numberStr = '-' + baseStr + zeroPadding + numberStr.substr(1);\n          } else {\n            numberStr = baseStr + zeroPadding + numberStr;\n          }\n          var from = Pos(cur.line, start);\n          var to = Pos(cur.line, end);\n          cm.replaceRange(numberStr, from, to);\n        } else {\n          return;\n        }\n        cm.setCursor(Pos(cur.line, start + numberStr.length - 1));\n      },\n      repeatLastEdit: function(cm, actionArgs, vim) {\n        var lastEditInputState = vim.lastEditInputState;\n        if (!lastEditInputState) { return; }\n        var repeat = actionArgs.repeat;\n        if (repeat && actionArgs.repeatIsExplicit) {\n          vim.lastEditInputState.repeatOverride = repeat;\n        } else {\n          repeat = vim.lastEditInputState.repeatOverride || repeat;\n        }\n        repeatLastEdit(cm, vim, repeat, false /** repeatForInsert */);\n      },\n      indent: function(cm, actionArgs) {\n        cm.indentLine(cm.getCursor().line, actionArgs.indentRight);\n      },\n      exitInsertMode: exitInsertMode\n    };\n\n    function defineAction(name, fn) {\n      actions[name] = fn;\n    }\n\n    /*\n     * Below are miscellaneous utility functions used by vim.js\n     */\n\n    /**\n     * Clips cursor to ensure that line is within the buffer's range\n     * If includeLineBreak is true, then allow cur.ch == lineLength.\n     */\n    function clipCursorToContent(cm, cur) {\n      var vim = cm.state.vim;\n      var includeLineBreak = vim.insertMode || vim.visualMode;\n      var line = Math.min(Math.max(cm.firstLine(), cur.line), cm.lastLine() );\n      var maxCh = lineLength(cm, line) - 1 + !!includeLineBreak;\n      var ch = Math.min(Math.max(0, cur.ch), maxCh);\n      return Pos(line, ch);\n    }\n    function copyArgs(args) {\n      var ret = {};\n      for (var prop in args) {\n        if (args.hasOwnProperty(prop)) {\n          ret[prop] = args[prop];\n        }\n      }\n      return ret;\n    }\n    function offsetCursor(cur, offsetLine, offsetCh) {\n      if (typeof offsetLine === 'object') {\n        offsetCh = offsetLine.ch;\n        offsetLine = offsetLine.line;\n      }\n      return Pos(cur.line + offsetLine, cur.ch + offsetCh);\n    }\n    function commandMatches(keys, keyMap, context, inputState) {\n      // Partial matches are not applied. They inform the key handler\n      // that the current key sequence is a subsequence of a valid key\n      // sequence, so that the key buffer is not cleared.\n      var match, partial = [], full = [];\n      for (var i = 0; i < keyMap.length; i++) {\n        var command = keyMap[i];\n        if (context == 'insert' && command.context != 'insert' ||\n            command.context && command.context != context ||\n            inputState.operator && command.type == 'action' ||\n            !(match = commandMatch(keys, command.keys))) { continue; }\n        if (match == 'partial') { partial.push(command); }\n        if (match == 'full') { full.push(command); }\n      }\n      return {\n        partial: partial.length && partial,\n        full: full.length && full\n      };\n    }\n    function commandMatch(pressed, mapped) {\n      if (mapped.slice(-11) == '<character>') {\n        // Last character matches anything.\n        var prefixLen = mapped.length - 11;\n        var pressedPrefix = pressed.slice(0, prefixLen);\n        var mappedPrefix = mapped.slice(0, prefixLen);\n        return pressedPrefix == mappedPrefix && pressed.length > prefixLen ? 'full' :\n               mappedPrefix.indexOf(pressedPrefix) == 0 ? 'partial' : false;\n      } else {\n        return pressed == mapped ? 'full' :\n               mapped.indexOf(pressed) == 0 ? 'partial' : false;\n      }\n    }\n    function lastChar(keys) {\n      var match = /^.*(<[^>]+>)$/.exec(keys);\n      var selectedCharacter = match ? match[1] : keys.slice(-1);\n      if (selectedCharacter.length > 1){\n        switch(selectedCharacter){\n          case '<CR>':\n            selectedCharacter='\\n';\n            break;\n          case '<Space>':\n            selectedCharacter=' ';\n            break;\n          default:\n            selectedCharacter='';\n            break;\n        }\n      }\n      return selectedCharacter;\n    }\n    function repeatFn(cm, fn, repeat) {\n      return function() {\n        for (var i = 0; i < repeat; i++) {\n          fn(cm);\n        }\n      };\n    }\n    function copyCursor(cur) {\n      return Pos(cur.line, cur.ch);\n    }\n    function cursorEqual(cur1, cur2) {\n      return cur1.ch == cur2.ch && cur1.line == cur2.line;\n    }\n    function cursorIsBefore(cur1, cur2) {\n      if (cur1.line < cur2.line) {\n        return true;\n      }\n      if (cur1.line == cur2.line && cur1.ch < cur2.ch) {\n        return true;\n      }\n      return false;\n    }\n    function cursorMin(cur1, cur2) {\n      if (arguments.length > 2) {\n        cur2 = cursorMin.apply(undefined, Array.prototype.slice.call(arguments, 1));\n      }\n      return cursorIsBefore(cur1, cur2) ? cur1 : cur2;\n    }\n    function cursorMax(cur1, cur2) {\n      if (arguments.length > 2) {\n        cur2 = cursorMax.apply(undefined, Array.prototype.slice.call(arguments, 1));\n      }\n      return cursorIsBefore(cur1, cur2) ? cur2 : cur1;\n    }\n    function cursorIsBetween(cur1, cur2, cur3) {\n      // returns true if cur2 is between cur1 and cur3.\n      var cur1before2 = cursorIsBefore(cur1, cur2);\n      var cur2before3 = cursorIsBefore(cur2, cur3);\n      return cur1before2 && cur2before3;\n    }\n    function lineLength(cm, lineNum) {\n      return cm.getLine(lineNum).length;\n    }\n    function trim(s) {\n      if (s.trim) {\n        return s.trim();\n      }\n      return s.replace(/^\\s+|\\s+$/g, '');\n    }\n    function escapeRegex(s) {\n      return s.replace(/([.?*+$\\[\\]\\/\\\\(){}|\\-])/g, '\\\\$1');\n    }\n    function extendLineToColumn(cm, lineNum, column) {\n      var endCh = lineLength(cm, lineNum);\n      var spaces = new Array(column-endCh+1).join(' ');\n      cm.setCursor(Pos(lineNum, endCh));\n      cm.replaceRange(spaces, cm.getCursor());\n    }\n    // This functions selects a rectangular block\n    // of text with selectionEnd as any of its corner\n    // Height of block:\n    // Difference in selectionEnd.line and first/last selection.line\n    // Width of the block:\n    // Distance between selectionEnd.ch and any(first considered here) selection.ch\n    function selectBlock(cm, selectionEnd) {\n      var selections = [], ranges = cm.listSelections();\n      var head = copyCursor(cm.clipPos(selectionEnd));\n      var isClipped = !cursorEqual(selectionEnd, head);\n      var curHead = cm.getCursor('head');\n      var primIndex = getIndex(ranges, curHead);\n      var wasClipped = cursorEqual(ranges[primIndex].head, ranges[primIndex].anchor);\n      var max = ranges.length - 1;\n      var index = max - primIndex > primIndex ? max : 0;\n      var base = ranges[index].anchor;\n\n      var firstLine = Math.min(base.line, head.line);\n      var lastLine = Math.max(base.line, head.line);\n      var baseCh = base.ch, headCh = head.ch;\n\n      var dir = ranges[index].head.ch - baseCh;\n      var newDir = headCh - baseCh;\n      if (dir > 0 && newDir <= 0) {\n        baseCh++;\n        if (!isClipped) { headCh--; }\n      } else if (dir < 0 && newDir >= 0) {\n        baseCh--;\n        if (!wasClipped) { headCh++; }\n      } else if (dir < 0 && newDir == -1) {\n        baseCh--;\n        headCh++;\n      }\n      for (var line = firstLine; line <= lastLine; line++) {\n        var range = {anchor: new Pos(line, baseCh), head: new Pos(line, headCh)};\n        selections.push(range);\n      }\n      cm.setSelections(selections);\n      selectionEnd.ch = headCh;\n      base.ch = baseCh;\n      return base;\n    }\n    function selectForInsert(cm, head, height) {\n      var sel = [];\n      for (var i = 0; i < height; i++) {\n        var lineHead = offsetCursor(head, i, 0);\n        sel.push({anchor: lineHead, head: lineHead});\n      }\n      cm.setSelections(sel, 0);\n    }\n    // getIndex returns the index of the cursor in the selections.\n    function getIndex(ranges, cursor, end) {\n      for (var i = 0; i < ranges.length; i++) {\n        var atAnchor = end != 'head' && cursorEqual(ranges[i].anchor, cursor);\n        var atHead = end != 'anchor' && cursorEqual(ranges[i].head, cursor);\n        if (atAnchor || atHead) {\n          return i;\n        }\n      }\n      return -1;\n    }\n    function getSelectedAreaRange(cm, vim) {\n      var lastSelection = vim.lastSelection;\n      var getCurrentSelectedAreaRange = function() {\n        var selections = cm.listSelections();\n        var start =  selections[0];\n        var end = selections[selections.length-1];\n        var selectionStart = cursorIsBefore(start.anchor, start.head) ? start.anchor : start.head;\n        var selectionEnd = cursorIsBefore(end.anchor, end.head) ? end.head : end.anchor;\n        return [selectionStart, selectionEnd];\n      };\n      var getLastSelectedAreaRange = function() {\n        var selectionStart = cm.getCursor();\n        var selectionEnd = cm.getCursor();\n        var block = lastSelection.visualBlock;\n        if (block) {\n          var width = block.width;\n          var height = block.height;\n          selectionEnd = Pos(selectionStart.line + height, selectionStart.ch + width);\n          var selections = [];\n          // selectBlock creates a 'proper' rectangular block.\n          // We do not want that in all cases, so we manually set selections.\n          for (var i = selectionStart.line; i < selectionEnd.line; i++) {\n            var anchor = Pos(i, selectionStart.ch);\n            var head = Pos(i, selectionEnd.ch);\n            var range = {anchor: anchor, head: head};\n            selections.push(range);\n          }\n          cm.setSelections(selections);\n        } else {\n          var start = lastSelection.anchorMark.find();\n          var end = lastSelection.headMark.find();\n          var line = end.line - start.line;\n          var ch = end.ch - start.ch;\n          selectionEnd = {line: selectionEnd.line + line, ch: line ? selectionEnd.ch : ch + selectionEnd.ch};\n          if (lastSelection.visualLine) {\n            selectionStart = Pos(selectionStart.line, 0);\n            selectionEnd = Pos(selectionEnd.line, lineLength(cm, selectionEnd.line));\n          }\n          cm.setSelection(selectionStart, selectionEnd);\n        }\n        return [selectionStart, selectionEnd];\n      };\n      if (!vim.visualMode) {\n      // In case of replaying the action.\n        return getLastSelectedAreaRange();\n      } else {\n        return getCurrentSelectedAreaRange();\n      }\n    }\n    // Updates the previous selection with the current selection's values. This\n    // should only be called in visual mode.\n    function updateLastSelection(cm, vim) {\n      var anchor = vim.sel.anchor;\n      var head = vim.sel.head;\n      // To accommodate the effect of lastPastedText in the last selection\n      if (vim.lastPastedText) {\n        head = cm.posFromIndex(cm.indexFromPos(anchor) + vim.lastPastedText.length);\n        vim.lastPastedText = null;\n      }\n      vim.lastSelection = {'anchorMark': cm.setBookmark(anchor),\n                           'headMark': cm.setBookmark(head),\n                           'anchor': copyCursor(anchor),\n                           'head': copyCursor(head),\n                           'visualMode': vim.visualMode,\n                           'visualLine': vim.visualLine,\n                           'visualBlock': vim.visualBlock};\n    }\n    function expandSelection(cm, start, end) {\n      var sel = cm.state.vim.sel;\n      var head = sel.head;\n      var anchor = sel.anchor;\n      var tmp;\n      if (cursorIsBefore(end, start)) {\n        tmp = end;\n        end = start;\n        start = tmp;\n      }\n      if (cursorIsBefore(head, anchor)) {\n        head = cursorMin(start, head);\n        anchor = cursorMax(anchor, end);\n      } else {\n        anchor = cursorMin(start, anchor);\n        head = cursorMax(head, end);\n        head = offsetCursor(head, 0, -1);\n        if (head.ch == -1 && head.line != cm.firstLine()) {\n          head = Pos(head.line - 1, lineLength(cm, head.line - 1));\n        }\n      }\n      return [anchor, head];\n    }\n    /**\n     * Updates the CodeMirror selection to match the provided vim selection.\n     * If no arguments are given, it uses the current vim selection state.\n     */\n    function updateCmSelection(cm, sel, mode) {\n      var vim = cm.state.vim;\n      sel = sel || vim.sel;\n      var mode = mode ||\n        vim.visualLine ? 'line' : vim.visualBlock ? 'block' : 'char';\n      var cmSel = makeCmSelection(cm, sel, mode);\n      cm.setSelections(cmSel.ranges, cmSel.primary);\n      updateFakeCursor(cm);\n    }\n    function makeCmSelection(cm, sel, mode, exclusive) {\n      var head = copyCursor(sel.head);\n      var anchor = copyCursor(sel.anchor);\n      if (mode == 'char') {\n        var headOffset = !exclusive && !cursorIsBefore(sel.head, sel.anchor) ? 1 : 0;\n        var anchorOffset = cursorIsBefore(sel.head, sel.anchor) ? 1 : 0;\n        head = offsetCursor(sel.head, 0, headOffset);\n        anchor = offsetCursor(sel.anchor, 0, anchorOffset);\n        return {\n          ranges: [{anchor: anchor, head: head}],\n          primary: 0\n        };\n      } else if (mode == 'line') {\n        if (!cursorIsBefore(sel.head, sel.anchor)) {\n          anchor.ch = 0;\n\n          var lastLine = cm.lastLine();\n          if (head.line > lastLine) {\n            head.line = lastLine;\n          }\n          head.ch = lineLength(cm, head.line);\n        } else {\n          head.ch = 0;\n          anchor.ch = lineLength(cm, anchor.line);\n        }\n        return {\n          ranges: [{anchor: anchor, head: head}],\n          primary: 0\n        };\n      } else if (mode == 'block') {\n        var top = Math.min(anchor.line, head.line),\n            left = Math.min(anchor.ch, head.ch),\n            bottom = Math.max(anchor.line, head.line),\n            right = Math.max(anchor.ch, head.ch) + 1;\n        var height = bottom - top + 1;\n        var primary = head.line == top ? 0 : height - 1;\n        var ranges = [];\n        for (var i = 0; i < height; i++) {\n          ranges.push({\n            anchor: Pos(top + i, left),\n            head: Pos(top + i, right)\n          });\n        }\n        return {\n          ranges: ranges,\n          primary: primary\n        };\n      }\n    }\n    function getHead(cm) {\n      var cur = cm.getCursor('head');\n      if (cm.getSelection().length == 1) {\n        // Small corner case when only 1 character is selected. The \"real\"\n        // head is the left of head and anchor.\n        cur = cursorMin(cur, cm.getCursor('anchor'));\n      }\n      return cur;\n    }\n\n    /**\n     * If moveHead is set to false, the CodeMirror selection will not be\n     * touched. The caller assumes the responsibility of putting the cursor\n    * in the right place.\n     */\n    function exitVisualMode(cm, moveHead) {\n      var vim = cm.state.vim;\n      if (moveHead !== false) {\n        cm.setCursor(clipCursorToContent(cm, vim.sel.head));\n      }\n      updateLastSelection(cm, vim);\n      vim.visualMode = false;\n      vim.visualLine = false;\n      vim.visualBlock = false;\n      if (!vim.insertMode) CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"normal\"});\n      clearFakeCursor(vim);\n    }\n\n    // Remove any trailing newlines from the selection. For\n    // example, with the caret at the start of the last word on the line,\n    // 'dw' should word, but not the newline, while 'w' should advance the\n    // caret to the first character of the next line.\n    function clipToLine(cm, curStart, curEnd) {\n      var selection = cm.getRange(curStart, curEnd);\n      // Only clip if the selection ends with trailing newline + whitespace\n      if (/\\n\\s*$/.test(selection)) {\n        var lines = selection.split('\\n');\n        // We know this is all whitespace.\n        lines.pop();\n\n        // Cases:\n        // 1. Last word is an empty line - do not clip the trailing '\\n'\n        // 2. Last word is not an empty line - clip the trailing '\\n'\n        var line;\n        // Find the line containing the last word, and clip all whitespace up\n        // to it.\n        for (var line = lines.pop(); lines.length > 0 && line && isWhiteSpaceString(line); line = lines.pop()) {\n          curEnd.line--;\n          curEnd.ch = 0;\n        }\n        // If the last word is not an empty line, clip an additional newline\n        if (line) {\n          curEnd.line--;\n          curEnd.ch = lineLength(cm, curEnd.line);\n        } else {\n          curEnd.ch = 0;\n        }\n      }\n    }\n\n    // Expand the selection to line ends.\n    function expandSelectionToLine(_cm, curStart, curEnd) {\n      curStart.ch = 0;\n      curEnd.ch = 0;\n      curEnd.line++;\n    }\n\n    function findFirstNonWhiteSpaceCharacter(text) {\n      if (!text) {\n        return 0;\n      }\n      var firstNonWS = text.search(/\\S/);\n      return firstNonWS == -1 ? text.length : firstNonWS;\n    }\n\n    function expandWordUnderCursor(cm, inclusive, _forward, bigWord, noSymbol) {\n      var cur = getHead(cm);\n      var line = cm.getLine(cur.line);\n      var idx = cur.ch;\n\n      // Seek to first word or non-whitespace character, depending on if\n      // noSymbol is true.\n      var test = noSymbol ? wordCharTest[0] : bigWordCharTest [0];\n      while (!test(line.charAt(idx))) {\n        idx++;\n        if (idx >= line.length) { return null; }\n      }\n\n      if (bigWord) {\n        test = bigWordCharTest[0];\n      } else {\n        test = wordCharTest[0];\n        if (!test(line.charAt(idx))) {\n          test = wordCharTest[1];\n        }\n      }\n\n      var end = idx, start = idx;\n      while (test(line.charAt(end)) && end < line.length) { end++; }\n      while (test(line.charAt(start)) && start >= 0) { start--; }\n      start++;\n\n      if (inclusive) {\n        // If present, include all whitespace after word.\n        // Otherwise, include all whitespace before word, except indentation.\n        var wordEnd = end;\n        while (/\\s/.test(line.charAt(end)) && end < line.length) { end++; }\n        if (wordEnd == end) {\n          var wordStart = start;\n          while (/\\s/.test(line.charAt(start - 1)) && start > 0) { start--; }\n          if (!start) { start = wordStart; }\n        }\n      }\n      return { start: Pos(cur.line, start), end: Pos(cur.line, end) };\n    }\n\n    function recordJumpPosition(cm, oldCur, newCur) {\n      if (!cursorEqual(oldCur, newCur)) {\n        vimGlobalState.jumpList.add(cm, oldCur, newCur);\n      }\n    }\n\n    function recordLastCharacterSearch(increment, args) {\n        vimGlobalState.lastCharacterSearch.increment = increment;\n        vimGlobalState.lastCharacterSearch.forward = args.forward;\n        vimGlobalState.lastCharacterSearch.selectedCharacter = args.selectedCharacter;\n    }\n\n    var symbolToMode = {\n        '(': 'bracket', ')': 'bracket', '{': 'bracket', '}': 'bracket',\n        '[': 'section', ']': 'section',\n        '*': 'comment', '/': 'comment',\n        'm': 'method', 'M': 'method',\n        '#': 'preprocess'\n    };\n    var findSymbolModes = {\n      bracket: {\n        isComplete: function(state) {\n          if (state.nextCh === state.symb) {\n            state.depth++;\n            if (state.depth >= 1)return true;\n          } else if (state.nextCh === state.reverseSymb) {\n            state.depth--;\n          }\n          return false;\n        }\n      },\n      section: {\n        init: function(state) {\n          state.curMoveThrough = true;\n          state.symb = (state.forward ? ']' : '[') === state.symb ? '{' : '}';\n        },\n        isComplete: function(state) {\n          return state.index === 0 && state.nextCh === state.symb;\n        }\n      },\n      comment: {\n        isComplete: function(state) {\n          var found = state.lastCh === '*' && state.nextCh === '/';\n          state.lastCh = state.nextCh;\n          return found;\n        }\n      },\n      // TODO: The original Vim implementation only operates on level 1 and 2.\n      // The current implementation doesn't check for code block level and\n      // therefore it operates on any levels.\n      method: {\n        init: function(state) {\n          state.symb = (state.symb === 'm' ? '{' : '}');\n          state.reverseSymb = state.symb === '{' ? '}' : '{';\n        },\n        isComplete: function(state) {\n          if (state.nextCh === state.symb)return true;\n          return false;\n        }\n      },\n      preprocess: {\n        init: function(state) {\n          state.index = 0;\n        },\n        isComplete: function(state) {\n          if (state.nextCh === '#') {\n            var token = state.lineText.match(/#(\\w+)/)[1];\n            if (token === 'endif') {\n              if (state.forward && state.depth === 0) {\n                return true;\n              }\n              state.depth++;\n            } else if (token === 'if') {\n              if (!state.forward && state.depth === 0) {\n                return true;\n              }\n              state.depth--;\n            }\n            if (token === 'else' && state.depth === 0)return true;\n          }\n          return false;\n        }\n      }\n    };\n    function findSymbol(cm, repeat, forward, symb) {\n      var cur = copyCursor(cm.getCursor());\n      var increment = forward ? 1 : -1;\n      var endLine = forward ? cm.lineCount() : -1;\n      var curCh = cur.ch;\n      var line = cur.line;\n      var lineText = cm.getLine(line);\n      var state = {\n        lineText: lineText,\n        nextCh: lineText.charAt(curCh),\n        lastCh: null,\n        index: curCh,\n        symb: symb,\n        reverseSymb: (forward ?  { ')': '(', '}': '{' } : { '(': ')', '{': '}' })[symb],\n        forward: forward,\n        depth: 0,\n        curMoveThrough: false\n      };\n      var mode = symbolToMode[symb];\n      if (!mode)return cur;\n      var init = findSymbolModes[mode].init;\n      var isComplete = findSymbolModes[mode].isComplete;\n      if (init) { init(state); }\n      while (line !== endLine && repeat) {\n        state.index += increment;\n        state.nextCh = state.lineText.charAt(state.index);\n        if (!state.nextCh) {\n          line += increment;\n          state.lineText = cm.getLine(line) || '';\n          if (increment > 0) {\n            state.index = 0;\n          } else {\n            var lineLen = state.lineText.length;\n            state.index = (lineLen > 0) ? (lineLen-1) : 0;\n          }\n          state.nextCh = state.lineText.charAt(state.index);\n        }\n        if (isComplete(state)) {\n          cur.line = line;\n          cur.ch = state.index;\n          repeat--;\n        }\n      }\n      if (state.nextCh || state.curMoveThrough) {\n        return Pos(line, state.index);\n      }\n      return cur;\n    }\n\n    /*\n     * Returns the boundaries of the next word. If the cursor in the middle of\n     * the word, then returns the boundaries of the current word, starting at\n     * the cursor. If the cursor is at the start/end of a word, and we are going\n     * forward/backward, respectively, find the boundaries of the next word.\n     *\n     * @param {CodeMirror} cm CodeMirror object.\n     * @param {Cursor} cur The cursor position.\n     * @param {boolean} forward True to search forward. False to search\n     *     backward.\n     * @param {boolean} bigWord True if punctuation count as part of the word.\n     *     False if only [a-zA-Z0-9] characters count as part of the word.\n     * @param {boolean} emptyLineIsWord True if empty lines should be treated\n     *     as words.\n     * @return {Object{from:number, to:number, line: number}} The boundaries of\n     *     the word, or null if there are no more words.\n     */\n    function findWord(cm, cur, forward, bigWord, emptyLineIsWord) {\n      var lineNum = cur.line;\n      var pos = cur.ch;\n      var line = cm.getLine(lineNum);\n      var dir = forward ? 1 : -1;\n      var charTests = bigWord ? bigWordCharTest: wordCharTest;\n\n      if (emptyLineIsWord && line == '') {\n        lineNum += dir;\n        line = cm.getLine(lineNum);\n        if (!isLine(cm, lineNum)) {\n          return null;\n        }\n        pos = (forward) ? 0 : line.length;\n      }\n\n      while (true) {\n        if (emptyLineIsWord && line == '') {\n          return { from: 0, to: 0, line: lineNum };\n        }\n        var stop = (dir > 0) ? line.length : -1;\n        var wordStart = stop, wordEnd = stop;\n        // Find bounds of next word.\n        while (pos != stop) {\n          var foundWord = false;\n          for (var i = 0; i < charTests.length && !foundWord; ++i) {\n            if (charTests[i](line.charAt(pos))) {\n              wordStart = pos;\n              // Advance to end of word.\n              while (pos != stop && charTests[i](line.charAt(pos))) {\n                pos += dir;\n              }\n              wordEnd = pos;\n              foundWord = wordStart != wordEnd;\n              if (wordStart == cur.ch && lineNum == cur.line &&\n                  wordEnd == wordStart + dir) {\n                // We started at the end of a word. Find the next one.\n                continue;\n              } else {\n                return {\n                  from: Math.min(wordStart, wordEnd + 1),\n                  to: Math.max(wordStart, wordEnd),\n                  line: lineNum };\n              }\n            }\n          }\n          if (!foundWord) {\n            pos += dir;\n          }\n        }\n        // Advance to next/prev line.\n        lineNum += dir;\n        if (!isLine(cm, lineNum)) {\n          return null;\n        }\n        line = cm.getLine(lineNum);\n        pos = (dir > 0) ? 0 : line.length;\n      }\n    }\n\n    /**\n     * @param {CodeMirror} cm CodeMirror object.\n     * @param {Pos} cur The position to start from.\n     * @param {int} repeat Number of words to move past.\n     * @param {boolean} forward True to search forward. False to search\n     *     backward.\n     * @param {boolean} wordEnd True to move to end of word. False to move to\n     *     beginning of word.\n     * @param {boolean} bigWord True if punctuation count as part of the word.\n     *     False if only alphabet characters count as part of the word.\n     * @return {Cursor} The position the cursor should move to.\n     */\n    function moveToWord(cm, cur, repeat, forward, wordEnd, bigWord) {\n      var curStart = copyCursor(cur);\n      var words = [];\n      if (forward && !wordEnd || !forward && wordEnd) {\n        repeat++;\n      }\n      // For 'e', empty lines are not considered words, go figure.\n      var emptyLineIsWord = !(forward && wordEnd);\n      for (var i = 0; i < repeat; i++) {\n        var word = findWord(cm, cur, forward, bigWord, emptyLineIsWord);\n        if (!word) {\n          var eodCh = lineLength(cm, cm.lastLine());\n          words.push(forward\n              ? {line: cm.lastLine(), from: eodCh, to: eodCh}\n              : {line: 0, from: 0, to: 0});\n          break;\n        }\n        words.push(word);\n        cur = Pos(word.line, forward ? (word.to - 1) : word.from);\n      }\n      var shortCircuit = words.length != repeat;\n      var firstWord = words[0];\n      var lastWord = words.pop();\n      if (forward && !wordEnd) {\n        // w\n        if (!shortCircuit && (firstWord.from != curStart.ch || firstWord.line != curStart.line)) {\n          // We did not start in the middle of a word. Discard the extra word at the end.\n          lastWord = words.pop();\n        }\n        return Pos(lastWord.line, lastWord.from);\n      } else if (forward && wordEnd) {\n        return Pos(lastWord.line, lastWord.to - 1);\n      } else if (!forward && wordEnd) {\n        // ge\n        if (!shortCircuit && (firstWord.to != curStart.ch || firstWord.line != curStart.line)) {\n          // We did not start in the middle of a word. Discard the extra word at the end.\n          lastWord = words.pop();\n        }\n        return Pos(lastWord.line, lastWord.to);\n      } else {\n        // b\n        return Pos(lastWord.line, lastWord.from);\n      }\n    }\n\n    function moveToCharacter(cm, repeat, forward, character) {\n      var cur = cm.getCursor();\n      var start = cur.ch;\n      var idx;\n      for (var i = 0; i < repeat; i ++) {\n        var line = cm.getLine(cur.line);\n        idx = charIdxInLine(start, line, character, forward, true);\n        if (idx == -1) {\n          return null;\n        }\n        start = idx;\n      }\n      return Pos(cm.getCursor().line, idx);\n    }\n\n    function moveToColumn(cm, repeat) {\n      // repeat is always >= 1, so repeat - 1 always corresponds\n      // to the column we want to go to.\n      var line = cm.getCursor().line;\n      return clipCursorToContent(cm, Pos(line, repeat - 1));\n    }\n\n    function updateMark(cm, vim, markName, pos) {\n      if (!inArray(markName, validMarks)) {\n        return;\n      }\n      if (vim.marks[markName]) {\n        vim.marks[markName].clear();\n      }\n      vim.marks[markName] = cm.setBookmark(pos);\n    }\n\n    function charIdxInLine(start, line, character, forward, includeChar) {\n      // Search for char in line.\n      // motion_options: {forward, includeChar}\n      // If includeChar = true, include it too.\n      // If forward = true, search forward, else search backwards.\n      // If char is not found on this line, do nothing\n      var idx;\n      if (forward) {\n        idx = line.indexOf(character, start + 1);\n        if (idx != -1 && !includeChar) {\n          idx -= 1;\n        }\n      } else {\n        idx = line.lastIndexOf(character, start - 1);\n        if (idx != -1 && !includeChar) {\n          idx += 1;\n        }\n      }\n      return idx;\n    }\n\n    function findParagraph(cm, head, repeat, dir, inclusive) {\n      var line = head.line;\n      var min = cm.firstLine();\n      var max = cm.lastLine();\n      var start, end, i = line;\n      function isEmpty(i) { return !cm.getLine(i); }\n      function isBoundary(i, dir, any) {\n        if (any) { return isEmpty(i) != isEmpty(i + dir); }\n        return !isEmpty(i) && isEmpty(i + dir);\n      }\n      if (dir) {\n        while (min <= i && i <= max && repeat > 0) {\n          if (isBoundary(i, dir)) { repeat--; }\n          i += dir;\n        }\n        return new Pos(i, 0);\n      }\n\n      var vim = cm.state.vim;\n      if (vim.visualLine && isBoundary(line, 1, true)) {\n        var anchor = vim.sel.anchor;\n        if (isBoundary(anchor.line, -1, true)) {\n          if (!inclusive || anchor.line != line) {\n            line += 1;\n          }\n        }\n      }\n      var startState = isEmpty(line);\n      for (i = line; i <= max && repeat; i++) {\n        if (isBoundary(i, 1, true)) {\n          if (!inclusive || isEmpty(i) != startState) {\n            repeat--;\n          }\n        }\n      }\n      end = new Pos(i, 0);\n      // select boundary before paragraph for the last one\n      if (i > max && !startState) { startState = true; }\n      else { inclusive = false; }\n      for (i = line; i > min; i--) {\n        if (!inclusive || isEmpty(i) == startState || i == line) {\n          if (isBoundary(i, -1, true)) { break; }\n        }\n      }\n      start = new Pos(i, 0);\n      return { start: start, end: end };\n    }\n\n    function findSentence(cm, cur, repeat, dir) {\n\n      /*\n        Takes an index object\n        {\n          line: the line string,\n          ln: line number,\n          pos: index in line,\n          dir: direction of traversal (-1 or 1)\n        }\n        and modifies the line, ln, and pos members to represent the\n        next valid position or sets them to null if there are\n        no more valid positions.\n       */\n      function nextChar(cm, idx) {\n        if (idx.pos + idx.dir < 0 || idx.pos + idx.dir >= idx.line.length) {\n          idx.ln += idx.dir;\n          if (!isLine(cm, idx.ln)) {\n            idx.line = null;\n            idx.ln = null;\n            idx.pos = null;\n            return;\n          }\n          idx.line = cm.getLine(idx.ln);\n          idx.pos = (idx.dir > 0) ? 0 : idx.line.length - 1;\n        }\n        else {\n          idx.pos += idx.dir;\n        }\n      }\n\n      /*\n        Performs one iteration of traversal in forward direction\n        Returns an index object of the new location\n       */\n      function forward(cm, ln, pos, dir) {\n        var line = cm.getLine(ln);\n        var stop = (line === \"\");\n\n        var curr = {\n          line: line,\n          ln: ln,\n          pos: pos,\n          dir: dir,\n        }\n\n        var last_valid = {\n          ln: curr.ln,\n          pos: curr.pos,\n        }\n\n        var skip_empty_lines = (curr.line === \"\");\n\n        // Move one step to skip character we start on\n        nextChar(cm, curr);\n\n        while (curr.line !== null) {\n          last_valid.ln = curr.ln;\n          last_valid.pos = curr.pos;\n\n          if (curr.line === \"\" && !skip_empty_lines) {\n            return { ln: curr.ln, pos: curr.pos, };\n          }\n          else if (stop && curr.line !== \"\" && !isWhiteSpaceString(curr.line[curr.pos])) {\n            return { ln: curr.ln, pos: curr.pos, };\n          }\n          else if (isEndOfSentenceSymbol(curr.line[curr.pos])\n            && !stop\n            && (curr.pos === curr.line.length - 1\n              || isWhiteSpaceString(curr.line[curr.pos + 1]))) {\n            stop = true;\n          }\n\n          nextChar(cm, curr);\n        }\n\n        /*\n          Set the position to the last non whitespace character on the last\n          valid line in the case that we reach the end of the document.\n        */\n        var line = cm.getLine(last_valid.ln);\n        last_valid.pos = 0;\n        for(var i = line.length - 1; i >= 0; --i) {\n          if (!isWhiteSpaceString(line[i])) {\n            last_valid.pos = i;\n            break;\n          }\n        }\n\n        return last_valid;\n\n      }\n\n      /*\n        Performs one iteration of traversal in reverse direction\n        Returns an index object of the new location\n       */\n      function reverse(cm, ln, pos, dir) {\n        var line = cm.getLine(ln);\n\n        var curr = {\n          line: line,\n          ln: ln,\n          pos: pos,\n          dir: dir,\n        }\n\n        var last_valid = {\n          ln: curr.ln,\n          pos: null,\n        };\n\n        var skip_empty_lines = (curr.line === \"\");\n\n        // Move one step to skip character we start on\n        nextChar(cm, curr);\n\n        while (curr.line !== null) {\n\n          if (curr.line === \"\" && !skip_empty_lines) {\n            if (last_valid.pos !== null) {\n              return last_valid;\n            }\n            else {\n              return { ln: curr.ln, pos: curr.pos };\n            }\n          }\n          else if (isEndOfSentenceSymbol(curr.line[curr.pos])\n              && last_valid.pos !== null\n              && !(curr.ln === last_valid.ln && curr.pos + 1 === last_valid.pos)) {\n            return last_valid;\n          }\n          else if (curr.line !== \"\" && !isWhiteSpaceString(curr.line[curr.pos])) {\n            skip_empty_lines = false;\n            last_valid = { ln: curr.ln, pos: curr.pos }\n          }\n\n          nextChar(cm, curr);\n        }\n\n        /*\n          Set the position to the first non whitespace character on the last\n          valid line in the case that we reach the beginning of the document.\n        */\n        var line = cm.getLine(last_valid.ln);\n        last_valid.pos = 0;\n        for(var i = 0; i < line.length; ++i) {\n          if (!isWhiteSpaceString(line[i])) {\n            last_valid.pos = i;\n            break;\n          }\n        }\n        return last_valid;\n      }\n\n      var curr_index = {\n        ln: cur.line,\n        pos: cur.ch,\n      };\n\n      while (repeat > 0) {\n        if (dir < 0) {\n          curr_index = reverse(cm, curr_index.ln, curr_index.pos, dir);\n        }\n        else {\n          curr_index = forward(cm, curr_index.ln, curr_index.pos, dir);\n        }\n        repeat--;\n      }\n\n      return Pos(curr_index.ln, curr_index.pos);\n    }\n\n    // TODO: perhaps this finagling of start and end positions belonds\n    // in codemirror/replaceRange?\n    function selectCompanionObject(cm, head, symb, inclusive) {\n      var cur = head, start, end;\n\n      var bracketRegexp = ({\n        '(': /[()]/, ')': /[()]/,\n        '[': /[[\\]]/, ']': /[[\\]]/,\n        '{': /[{}]/, '}': /[{}]/,\n        '<': /[<>]/, '>': /[<>]/})[symb];\n      var openSym = ({\n        '(': '(', ')': '(',\n        '[': '[', ']': '[',\n        '{': '{', '}': '{',\n        '<': '<', '>': '<'})[symb];\n      var curChar = cm.getLine(cur.line).charAt(cur.ch);\n      // Due to the behavior of scanForBracket, we need to add an offset if the\n      // cursor is on a matching open bracket.\n      var offset = curChar === openSym ? 1 : 0;\n\n      start = cm.scanForBracket(Pos(cur.line, cur.ch + offset), -1, undefined, {'bracketRegex': bracketRegexp});\n      end = cm.scanForBracket(Pos(cur.line, cur.ch + offset), 1, undefined, {'bracketRegex': bracketRegexp});\n\n      if (!start || !end) {\n        return { start: cur, end: cur };\n      }\n\n      start = start.pos;\n      end = end.pos;\n\n      if ((start.line == end.line && start.ch > end.ch)\n          || (start.line > end.line)) {\n        var tmp = start;\n        start = end;\n        end = tmp;\n      }\n\n      if (inclusive) {\n        end.ch += 1;\n      } else {\n        start.ch += 1;\n      }\n\n      return { start: start, end: end };\n    }\n\n    // Takes in a symbol and a cursor and tries to simulate text objects that\n    // have identical opening and closing symbols\n    // TODO support across multiple lines\n    function findBeginningAndEnd(cm, head, symb, inclusive) {\n      var cur = copyCursor(head);\n      var line = cm.getLine(cur.line);\n      var chars = line.split('');\n      var start, end, i, len;\n      var firstIndex = chars.indexOf(symb);\n\n      // the decision tree is to always look backwards for the beginning first,\n      // but if the cursor is in front of the first instance of the symb,\n      // then move the cursor forward\n      if (cur.ch < firstIndex) {\n        cur.ch = firstIndex;\n        // Why is this line even here???\n        // cm.setCursor(cur.line, firstIndex+1);\n      }\n      // otherwise if the cursor is currently on the closing symbol\n      else if (firstIndex < cur.ch && chars[cur.ch] == symb) {\n        end = cur.ch; // assign end to the current cursor\n        --cur.ch; // make sure to look backwards\n      }\n\n      // if we're currently on the symbol, we've got a start\n      if (chars[cur.ch] == symb && !end) {\n        start = cur.ch + 1; // assign start to ahead of the cursor\n      } else {\n        // go backwards to find the start\n        for (i = cur.ch; i > -1 && !start; i--) {\n          if (chars[i] == symb) {\n            start = i + 1;\n          }\n        }\n      }\n\n      // look forwards for the end symbol\n      if (start && !end) {\n        for (i = start, len = chars.length; i < len && !end; i++) {\n          if (chars[i] == symb) {\n            end = i;\n          }\n        }\n      }\n\n      // nothing found\n      if (!start || !end) {\n        return { start: cur, end: cur };\n      }\n\n      // include the symbols\n      if (inclusive) {\n        --start; ++end;\n      }\n\n      return {\n        start: Pos(cur.line, start),\n        end: Pos(cur.line, end)\n      };\n    }\n\n    // Search functions\n    defineOption('pcre', true, 'boolean');\n    function SearchState() {}\n    SearchState.prototype = {\n      getQuery: function() {\n        return vimGlobalState.query;\n      },\n      setQuery: function(query) {\n        vimGlobalState.query = query;\n      },\n      getOverlay: function() {\n        return this.searchOverlay;\n      },\n      setOverlay: function(overlay) {\n        this.searchOverlay = overlay;\n      },\n      isReversed: function() {\n        return vimGlobalState.isReversed;\n      },\n      setReversed: function(reversed) {\n        vimGlobalState.isReversed = reversed;\n      },\n      getScrollbarAnnotate: function() {\n        return this.annotate;\n      },\n      setScrollbarAnnotate: function(annotate) {\n        this.annotate = annotate;\n      }\n    };\n    function getSearchState(cm) {\n      var vim = cm.state.vim;\n      return vim.searchState_ || (vim.searchState_ = new SearchState());\n    }\n    function dialog(cm, template, shortText, onClose, options) {\n      if (cm.openDialog) {\n        cm.openDialog(template, onClose, { bottom: true, value: options.value,\n            onKeyDown: options.onKeyDown, onKeyUp: options.onKeyUp,\n            selectValueOnOpen: false});\n      }\n      else {\n        onClose(prompt(shortText, ''));\n      }\n    }\n    function splitBySlash(argString) {\n      return splitBySeparator(argString, '/');\n    }\n\n    function findUnescapedSlashes(argString) {\n      return findUnescapedSeparators(argString, '/');\n    }\n\n    function splitBySeparator(argString, separator) {\n      var slashes = findUnescapedSeparators(argString, separator) || [];\n      if (!slashes.length) return [];\n      var tokens = [];\n      // in case of strings like foo/bar\n      if (slashes[0] !== 0) return;\n      for (var i = 0; i < slashes.length; i++) {\n        if (typeof slashes[i] == 'number')\n          tokens.push(argString.substring(slashes[i] + 1, slashes[i+1]));\n      }\n      return tokens;\n    }\n\n    function findUnescapedSeparators(str, separator) {\n      if (!separator)\n        separator = '/';\n\n      var escapeNextChar = false;\n      var slashes = [];\n      for (var i = 0; i < str.length; i++) {\n        var c = str.charAt(i);\n        if (!escapeNextChar && c == separator) {\n          slashes.push(i);\n        }\n        escapeNextChar = !escapeNextChar && (c == '\\\\');\n      }\n      return slashes;\n    }\n\n    // Translates a search string from ex (vim) syntax into javascript form.\n    function translateRegex(str) {\n      // When these match, add a '\\' if unescaped or remove one if escaped.\n      var specials = '|(){';\n      // Remove, but never add, a '\\' for these.\n      var unescape = '}';\n      var escapeNextChar = false;\n      var out = [];\n      for (var i = -1; i < str.length; i++) {\n        var c = str.charAt(i) || '';\n        var n = str.charAt(i+1) || '';\n        var specialComesNext = (n && specials.indexOf(n) != -1);\n        if (escapeNextChar) {\n          if (c !== '\\\\' || !specialComesNext) {\n            out.push(c);\n          }\n          escapeNextChar = false;\n        } else {\n          if (c === '\\\\') {\n            escapeNextChar = true;\n            // Treat the unescape list as special for removing, but not adding '\\'.\n            if (n && unescape.indexOf(n) != -1) {\n              specialComesNext = true;\n            }\n            // Not passing this test means removing a '\\'.\n            if (!specialComesNext || n === '\\\\') {\n              out.push(c);\n            }\n          } else {\n            out.push(c);\n            if (specialComesNext && n !== '\\\\') {\n              out.push('\\\\');\n            }\n          }\n        }\n      }\n      return out.join('');\n    }\n\n    // Translates the replace part of a search and replace from ex (vim) syntax into\n    // javascript form.  Similar to translateRegex, but additionally fixes back references\n    // (translates '\\[0..9]' to '$[0..9]') and follows different rules for escaping '$'.\n    var charUnescapes = {'\\\\n': '\\n', '\\\\r': '\\r', '\\\\t': '\\t'};\n    function translateRegexReplace(str) {\n      var escapeNextChar = false;\n      var out = [];\n      for (var i = -1; i < str.length; i++) {\n        var c = str.charAt(i) || '';\n        var n = str.charAt(i+1) || '';\n        if (charUnescapes[c + n]) {\n          out.push(charUnescapes[c+n]);\n          i++;\n        } else if (escapeNextChar) {\n          // At any point in the loop, escapeNextChar is true if the previous\n          // character was a '\\' and was not escaped.\n          out.push(c);\n          escapeNextChar = false;\n        } else {\n          if (c === '\\\\') {\n            escapeNextChar = true;\n            if ((isNumber(n) || n === '$')) {\n              out.push('$');\n            } else if (n !== '/' && n !== '\\\\') {\n              out.push('\\\\');\n            }\n          } else {\n            if (c === '$') {\n              out.push('$');\n            }\n            out.push(c);\n            if (n === '/') {\n              out.push('\\\\');\n            }\n          }\n        }\n      }\n      return out.join('');\n    }\n\n    // Unescape \\ and / in the replace part, for PCRE mode.\n    var unescapes = {'\\\\/': '/', '\\\\\\\\': '\\\\', '\\\\n': '\\n', '\\\\r': '\\r', '\\\\t': '\\t', '\\\\&':'&'};\n    function unescapeRegexReplace(str) {\n      var stream = new CodeMirror.StringStream(str);\n      var output = [];\n      while (!stream.eol()) {\n        // Search for \\.\n        while (stream.peek() && stream.peek() != '\\\\') {\n          output.push(stream.next());\n        }\n        var matched = false;\n        for (var matcher in unescapes) {\n          if (stream.match(matcher, true)) {\n            matched = true;\n            output.push(unescapes[matcher]);\n            break;\n          }\n        }\n        if (!matched) {\n          // Don't change anything\n          output.push(stream.next());\n        }\n      }\n      return output.join('');\n    }\n\n    /**\n     * Extract the regular expression from the query and return a Regexp object.\n     * Returns null if the query is blank.\n     * If ignoreCase is passed in, the Regexp object will have the 'i' flag set.\n     * If smartCase is passed in, and the query contains upper case letters,\n     *   then ignoreCase is overridden, and the 'i' flag will not be set.\n     * If the query contains the /i in the flag part of the regular expression,\n     *   then both ignoreCase and smartCase are ignored, and 'i' will be passed\n     *   through to the Regex object.\n     */\n    function parseQuery(query, ignoreCase, smartCase) {\n      // First update the last search register\n      var lastSearchRegister = vimGlobalState.registerController.getRegister('/');\n      lastSearchRegister.setText(query);\n      // Check if the query is already a regex.\n      if (query instanceof RegExp) { return query; }\n      // First try to extract regex + flags from the input. If no flags found,\n      // extract just the regex. IE does not accept flags directly defined in\n      // the regex string in the form /regex/flags\n      var slashes = findUnescapedSlashes(query);\n      var regexPart;\n      var forceIgnoreCase;\n      if (!slashes.length) {\n        // Query looks like 'regexp'\n        regexPart = query;\n      } else {\n        // Query looks like 'regexp/...'\n        regexPart = query.substring(0, slashes[0]);\n        var flagsPart = query.substring(slashes[0]);\n        forceIgnoreCase = (flagsPart.indexOf('i') != -1);\n      }\n      if (!regexPart) {\n        return null;\n      }\n      if (!getOption('pcre')) {\n        regexPart = translateRegex(regexPart);\n      }\n      if (smartCase) {\n        ignoreCase = (/^[^A-Z]*$/).test(regexPart);\n      }\n      var regexp = new RegExp(regexPart,\n          (ignoreCase || forceIgnoreCase) ? 'i' : undefined);\n      return regexp;\n    }\n    function showConfirm(cm, text) {\n      if (cm.openNotification) {\n        cm.openNotification('<span style=\"color: red\">' + text + '</span>',\n                            {bottom: true, duration: 5000});\n      } else {\n        alert(text);\n      }\n    }\n    function makePrompt(prefix, desc) {\n      var raw = '<span style=\"font-family: monospace; white-space: pre\">' +\n          (prefix || \"\") + '<input type=\"text\" autocorrect=\"off\" ' +\n          'autocapitalize=\"off\" spellcheck=\"false\"></span>';\n      if (desc)\n        raw += ' <span style=\"color: #888\">' + desc + '</span>';\n      return raw;\n    }\n    var searchPromptDesc = '(Javascript regexp)';\n    function showPrompt(cm, options) {\n      var shortText = (options.prefix || '') + ' ' + (options.desc || '');\n      var prompt = makePrompt(options.prefix, options.desc);\n      dialog(cm, prompt, shortText, options.onClose, options);\n    }\n    function regexEqual(r1, r2) {\n      if (r1 instanceof RegExp && r2 instanceof RegExp) {\n          var props = ['global', 'multiline', 'ignoreCase', 'source'];\n          for (var i = 0; i < props.length; i++) {\n              var prop = props[i];\n              if (r1[prop] !== r2[prop]) {\n                  return false;\n              }\n          }\n          return true;\n      }\n      return false;\n    }\n    // Returns true if the query is valid.\n    function updateSearchQuery(cm, rawQuery, ignoreCase, smartCase) {\n      if (!rawQuery) {\n        return;\n      }\n      var state = getSearchState(cm);\n      var query = parseQuery(rawQuery, !!ignoreCase, !!smartCase);\n      if (!query) {\n        return;\n      }\n      highlightSearchMatches(cm, query);\n      if (regexEqual(query, state.getQuery())) {\n        return query;\n      }\n      state.setQuery(query);\n      return query;\n    }\n    function searchOverlay(query) {\n      if (query.source.charAt(0) == '^') {\n        var matchSol = true;\n      }\n      return {\n        token: function(stream) {\n          if (matchSol && !stream.sol()) {\n            stream.skipToEnd();\n            return;\n          }\n          var match = stream.match(query, false);\n          if (match) {\n            if (match[0].length == 0) {\n              // Matched empty string, skip to next.\n              stream.next();\n              return 'searching';\n            }\n            if (!stream.sol()) {\n              // Backtrack 1 to match \\b\n              stream.backUp(1);\n              if (!query.exec(stream.next() + match[0])) {\n                stream.next();\n                return null;\n              }\n            }\n            stream.match(query);\n            return 'searching';\n          }\n          while (!stream.eol()) {\n            stream.next();\n            if (stream.match(query, false)) break;\n          }\n        },\n        query: query\n      };\n    }\n    var highlightTimeout = 0;\n    function highlightSearchMatches(cm, query) {\n      clearTimeout(highlightTimeout);\n      highlightTimeout = setTimeout(function() {\n        var searchState = getSearchState(cm);\n        var overlay = searchState.getOverlay();\n        if (!overlay || query != overlay.query) {\n          if (overlay) {\n            cm.removeOverlay(overlay);\n          }\n          overlay = searchOverlay(query);\n          cm.addOverlay(overlay);\n          if (cm.showMatchesOnScrollbar) {\n            if (searchState.getScrollbarAnnotate()) {\n              searchState.getScrollbarAnnotate().clear();\n            }\n            searchState.setScrollbarAnnotate(cm.showMatchesOnScrollbar(query));\n          }\n          searchState.setOverlay(overlay);\n        }\n      }, 50);\n    }\n    function findNext(cm, prev, query, repeat) {\n      if (repeat === undefined) { repeat = 1; }\n      return cm.operation(function() {\n        var pos = cm.getCursor();\n        var cursor = cm.getSearchCursor(query, pos);\n        for (var i = 0; i < repeat; i++) {\n          var found = cursor.find(prev);\n          if (i == 0 && found && cursorEqual(cursor.from(), pos)) { found = cursor.find(prev); }\n          if (!found) {\n            // SearchCursor may have returned null because it hit EOF, wrap\n            // around and try again.\n            cursor = cm.getSearchCursor(query,\n                (prev) ? Pos(cm.lastLine()) : Pos(cm.firstLine(), 0) );\n            if (!cursor.find(prev)) {\n              return;\n            }\n          }\n        }\n        return cursor.from();\n      });\n    }\n    function clearSearchHighlight(cm) {\n      var state = getSearchState(cm);\n      cm.removeOverlay(getSearchState(cm).getOverlay());\n      state.setOverlay(null);\n      if (state.getScrollbarAnnotate()) {\n        state.getScrollbarAnnotate().clear();\n        state.setScrollbarAnnotate(null);\n      }\n    }\n    /**\n     * Check if pos is in the specified range, INCLUSIVE.\n     * Range can be specified with 1 or 2 arguments.\n     * If the first range argument is an array, treat it as an array of line\n     * numbers. Match pos against any of the lines.\n     * If the first range argument is a number,\n     *   if there is only 1 range argument, check if pos has the same line\n     *       number\n     *   if there are 2 range arguments, then check if pos is in between the two\n     *       range arguments.\n     */\n    function isInRange(pos, start, end) {\n      if (typeof pos != 'number') {\n        // Assume it is a cursor position. Get the line number.\n        pos = pos.line;\n      }\n      if (start instanceof Array) {\n        return inArray(pos, start);\n      } else {\n        if (end) {\n          return (pos >= start && pos <= end);\n        } else {\n          return pos == start;\n        }\n      }\n    }\n    function getUserVisibleLines(cm) {\n      var scrollInfo = cm.getScrollInfo();\n      var occludeToleranceTop = 6;\n      var occludeToleranceBottom = 10;\n      var from = cm.coordsChar({left:0, top: occludeToleranceTop + scrollInfo.top}, 'local');\n      var bottomY = scrollInfo.clientHeight - occludeToleranceBottom + scrollInfo.top;\n      var to = cm.coordsChar({left:0, top: bottomY}, 'local');\n      return {top: from.line, bottom: to.line};\n    }\n\n    function getMarkPos(cm, vim, markName) {\n      if (markName == '\\'' || markName == '`') {\n        return vimGlobalState.jumpList.find(cm, -1) || Pos(0, 0);\n      } else if (markName == '.') {\n        return getLastEditPos(cm);\n      }\n\n      var mark = vim.marks[markName];\n      return mark && mark.find();\n    }\n\n    function getLastEditPos(cm) {\n      var done = cm.doc.history.done;\n      for (var i = done.length; i--;) {\n        if (done[i].changes) {\n          return copyCursor(done[i].changes[0].to);\n        }\n      }\n    }\n\n    var ExCommandDispatcher = function() {\n      this.buildCommandMap_();\n    };\n    ExCommandDispatcher.prototype = {\n      processCommand: function(cm, input, opt_params) {\n        var that = this;\n        cm.operation(function () {\n          cm.curOp.isVimOp = true;\n          that._processCommand(cm, input, opt_params);\n        });\n      },\n      _processCommand: function(cm, input, opt_params) {\n        var vim = cm.state.vim;\n        var commandHistoryRegister = vimGlobalState.registerController.getRegister(':');\n        var previousCommand = commandHistoryRegister.toString();\n        if (vim.visualMode) {\n          exitVisualMode(cm);\n        }\n        var inputStream = new CodeMirror.StringStream(input);\n        // update \": with the latest command whether valid or invalid\n        commandHistoryRegister.setText(input);\n        var params = opt_params || {};\n        params.input = input;\n        try {\n          this.parseInput_(cm, inputStream, params);\n        } catch(e) {\n          showConfirm(cm, e);\n          throw e;\n        }\n        var command;\n        var commandName;\n        if (!params.commandName) {\n          // If only a line range is defined, move to the line.\n          if (params.line !== undefined) {\n            commandName = 'move';\n          }\n        } else {\n          command = this.matchCommand_(params.commandName);\n          if (command) {\n            commandName = command.name;\n            if (command.excludeFromCommandHistory) {\n              commandHistoryRegister.setText(previousCommand);\n            }\n            this.parseCommandArgs_(inputStream, params, command);\n            if (command.type == 'exToKey') {\n              // Handle Ex to Key mapping.\n              for (var i = 0; i < command.toKeys.length; i++) {\n                CodeMirror.Vim.handleKey(cm, command.toKeys[i], 'mapping');\n              }\n              return;\n            } else if (command.type == 'exToEx') {\n              // Handle Ex to Ex mapping.\n              this.processCommand(cm, command.toInput);\n              return;\n            }\n          }\n        }\n        if (!commandName) {\n          showConfirm(cm, 'Not an editor command \":' + input + '\"');\n          return;\n        }\n        try {\n          exCommands[commandName](cm, params);\n          // Possibly asynchronous commands (e.g. substitute, which might have a\n          // user confirmation), are responsible for calling the callback when\n          // done. All others have it taken care of for them here.\n          if ((!command || !command.possiblyAsync) && params.callback) {\n            params.callback();\n          }\n        } catch(e) {\n          showConfirm(cm, e);\n          throw e;\n        }\n      },\n      parseInput_: function(cm, inputStream, result) {\n        inputStream.eatWhile(':');\n        // Parse range.\n        if (inputStream.eat('%')) {\n          result.line = cm.firstLine();\n          result.lineEnd = cm.lastLine();\n        } else {\n          result.line = this.parseLineSpec_(cm, inputStream);\n          if (result.line !== undefined && inputStream.eat(',')) {\n            result.lineEnd = this.parseLineSpec_(cm, inputStream);\n          }\n        }\n\n        // Parse command name.\n        var commandMatch = inputStream.match(/^(\\w+|!!|@@|[!#&*<=>@~])/);\n        if (commandMatch) {\n          result.commandName = commandMatch[1];\n        } else {\n          result.commandName = inputStream.match(/.*/)[0];\n        }\n\n        return result;\n      },\n      parseLineSpec_: function(cm, inputStream) {\n        var numberMatch = inputStream.match(/^(\\d+)/);\n        if (numberMatch) {\n          // Absolute line number plus offset (N+M or N-M) is probably a typo,\n          // not something the user actually wanted. (NB: vim does allow this.)\n          return parseInt(numberMatch[1], 10) - 1;\n        }\n        switch (inputStream.next()) {\n          case '.':\n            return this.parseLineSpecOffset_(inputStream, cm.getCursor().line);\n          case '$':\n            return this.parseLineSpecOffset_(inputStream, cm.lastLine());\n          case '\\'':\n            var markName = inputStream.next();\n            var markPos = getMarkPos(cm, cm.state.vim, markName);\n            if (!markPos) throw new Error('Mark not set');\n            return this.parseLineSpecOffset_(inputStream, markPos.line);\n          case '-':\n          case '+':\n            inputStream.backUp(1);\n            // Offset is relative to current line if not otherwise specified.\n            return this.parseLineSpecOffset_(inputStream, cm.getCursor().line);\n          default:\n            inputStream.backUp(1);\n            return undefined;\n        }\n      },\n      parseLineSpecOffset_: function(inputStream, line) {\n        var offsetMatch = inputStream.match(/^([+-])?(\\d+)/);\n        if (offsetMatch) {\n          var offset = parseInt(offsetMatch[2], 10);\n          if (offsetMatch[1] == \"-\") {\n            line -= offset;\n          } else {\n            line += offset;\n          }\n        }\n        return line;\n      },\n      parseCommandArgs_: function(inputStream, params, command) {\n        if (inputStream.eol()) {\n          return;\n        }\n        params.argString = inputStream.match(/.*/)[0];\n        // Parse command-line arguments\n        var delim = command.argDelimiter || /\\s+/;\n        var args = trim(params.argString).split(delim);\n        if (args.length && args[0]) {\n          params.args = args;\n        }\n      },\n      matchCommand_: function(commandName) {\n        // Return the command in the command map that matches the shortest\n        // prefix of the passed in command name. The match is guaranteed to be\n        // unambiguous if the defaultExCommandMap's shortNames are set up\n        // correctly. (see @code{defaultExCommandMap}).\n        for (var i = commandName.length; i > 0; i--) {\n          var prefix = commandName.substring(0, i);\n          if (this.commandMap_[prefix]) {\n            var command = this.commandMap_[prefix];\n            if (command.name.indexOf(commandName) === 0) {\n              return command;\n            }\n          }\n        }\n        return null;\n      },\n      buildCommandMap_: function() {\n        this.commandMap_ = {};\n        for (var i = 0; i < defaultExCommandMap.length; i++) {\n          var command = defaultExCommandMap[i];\n          var key = command.shortName || command.name;\n          this.commandMap_[key] = command;\n        }\n      },\n      map: function(lhs, rhs, ctx) {\n        if (lhs != ':' && lhs.charAt(0) == ':') {\n          if (ctx) { throw Error('Mode not supported for ex mappings'); }\n          var commandName = lhs.substring(1);\n          if (rhs != ':' && rhs.charAt(0) == ':') {\n            // Ex to Ex mapping\n            this.commandMap_[commandName] = {\n              name: commandName,\n              type: 'exToEx',\n              toInput: rhs.substring(1),\n              user: true\n            };\n          } else {\n            // Ex to key mapping\n            this.commandMap_[commandName] = {\n              name: commandName,\n              type: 'exToKey',\n              toKeys: rhs,\n              user: true\n            };\n          }\n        } else {\n          if (rhs != ':' && rhs.charAt(0) == ':') {\n            // Key to Ex mapping.\n            var mapping = {\n              keys: lhs,\n              type: 'keyToEx',\n              exArgs: { input: rhs.substring(1) }\n            };\n            if (ctx) { mapping.context = ctx; }\n            defaultKeymap.unshift(mapping);\n          } else {\n            // Key to key mapping\n            var mapping = {\n              keys: lhs,\n              type: 'keyToKey',\n              toKeys: rhs\n            };\n            if (ctx) { mapping.context = ctx; }\n            defaultKeymap.unshift(mapping);\n          }\n        }\n      },\n      unmap: function(lhs, ctx) {\n        if (lhs != ':' && lhs.charAt(0) == ':') {\n          // Ex to Ex or Ex to key mapping\n          if (ctx) { throw Error('Mode not supported for ex mappings'); }\n          var commandName = lhs.substring(1);\n          if (this.commandMap_[commandName] && this.commandMap_[commandName].user) {\n            delete this.commandMap_[commandName];\n            return;\n          }\n        } else {\n          // Key to Ex or key to key mapping\n          var keys = lhs;\n          for (var i = 0; i < defaultKeymap.length; i++) {\n            if (keys == defaultKeymap[i].keys\n                && defaultKeymap[i].context === ctx) {\n              defaultKeymap.splice(i, 1);\n              return;\n            }\n          }\n        }\n        throw Error('No such mapping.');\n      }\n    };\n\n    var exCommands = {\n      colorscheme: function(cm, params) {\n        if (!params.args || params.args.length < 1) {\n          showConfirm(cm, cm.getOption('theme'));\n          return;\n        }\n        cm.setOption('theme', params.args[0]);\n      },\n      map: function(cm, params, ctx) {\n        var mapArgs = params.args;\n        if (!mapArgs || mapArgs.length < 2) {\n          if (cm) {\n            showConfirm(cm, 'Invalid mapping: ' + params.input);\n          }\n          return;\n        }\n        exCommandDispatcher.map(mapArgs[0], mapArgs[1], ctx);\n      },\n      imap: function(cm, params) { this.map(cm, params, 'insert'); },\n      nmap: function(cm, params) { this.map(cm, params, 'normal'); },\n      vmap: function(cm, params) { this.map(cm, params, 'visual'); },\n      unmap: function(cm, params, ctx) {\n        var mapArgs = params.args;\n        if (!mapArgs || mapArgs.length < 1) {\n          if (cm) {\n            showConfirm(cm, 'No such mapping: ' + params.input);\n          }\n          return;\n        }\n        exCommandDispatcher.unmap(mapArgs[0], ctx);\n      },\n      move: function(cm, params) {\n        commandDispatcher.processCommand(cm, cm.state.vim, {\n            type: 'motion',\n            motion: 'moveToLineOrEdgeOfDocument',\n            motionArgs: { forward: false, explicitRepeat: true,\n              linewise: true },\n            repeatOverride: params.line+1});\n      },\n      set: function(cm, params) {\n        var setArgs = params.args;\n        // Options passed through to the setOption/getOption calls. May be passed in by the\n        // local/global versions of the set command\n        var setCfg = params.setCfg || {};\n        if (!setArgs || setArgs.length < 1) {\n          if (cm) {\n            showConfirm(cm, 'Invalid mapping: ' + params.input);\n          }\n          return;\n        }\n        var expr = setArgs[0].split('=');\n        var optionName = expr[0];\n        var value = expr[1];\n        var forceGet = false;\n\n        if (optionName.charAt(optionName.length - 1) == '?') {\n          // If post-fixed with ?, then the set is actually a get.\n          if (value) { throw Error('Trailing characters: ' + params.argString); }\n          optionName = optionName.substring(0, optionName.length - 1);\n          forceGet = true;\n        }\n        if (value === undefined && optionName.substring(0, 2) == 'no') {\n          // To set boolean options to false, the option name is prefixed with\n          // 'no'.\n          optionName = optionName.substring(2);\n          value = false;\n        }\n\n        var optionIsBoolean = options[optionName] && options[optionName].type == 'boolean';\n        if (optionIsBoolean && value == undefined) {\n          // Calling set with a boolean option sets it to true.\n          value = true;\n        }\n        // If no value is provided, then we assume this is a get.\n        if (!optionIsBoolean && value === undefined || forceGet) {\n          var oldValue = getOption(optionName, cm, setCfg);\n          if (oldValue instanceof Error) {\n            showConfirm(cm, oldValue.message);\n          } else if (oldValue === true || oldValue === false) {\n            showConfirm(cm, ' ' + (oldValue ? '' : 'no') + optionName);\n          } else {\n            showConfirm(cm, '  ' + optionName + '=' + oldValue);\n          }\n        } else {\n          var setOptionReturn = setOption(optionName, value, cm, setCfg);\n          if (setOptionReturn instanceof Error) {\n            showConfirm(cm, setOptionReturn.message);\n          }\n        }\n      },\n      setlocal: function (cm, params) {\n        // setCfg is passed through to setOption\n        params.setCfg = {scope: 'local'};\n        this.set(cm, params);\n      },\n      setglobal: function (cm, params) {\n        // setCfg is passed through to setOption\n        params.setCfg = {scope: 'global'};\n        this.set(cm, params);\n      },\n      registers: function(cm, params) {\n        var regArgs = params.args;\n        var registers = vimGlobalState.registerController.registers;\n        var regInfo = '----------Registers----------<br><br>';\n        if (!regArgs) {\n          for (var registerName in registers) {\n            var text = registers[registerName].toString();\n            if (text.length) {\n              regInfo += '\"' + registerName + '    ' + text + '<br>';\n            }\n          }\n        } else {\n          var registerName;\n          regArgs = regArgs.join('');\n          for (var i = 0; i < regArgs.length; i++) {\n            registerName = regArgs.charAt(i);\n            if (!vimGlobalState.registerController.isValidRegister(registerName)) {\n              continue;\n            }\n            var register = registers[registerName] || new Register();\n            regInfo += '\"' + registerName + '    ' + register.toString() + '<br>';\n          }\n        }\n        showConfirm(cm, regInfo);\n      },\n      sort: function(cm, params) {\n        var reverse, ignoreCase, unique, number, pattern;\n        function parseArgs() {\n          if (params.argString) {\n            var args = new CodeMirror.StringStream(params.argString);\n            if (args.eat('!')) { reverse = true; }\n            if (args.eol()) { return; }\n            if (!args.eatSpace()) { return 'Invalid arguments'; }\n            var opts = args.match(/([dinuox]+)?\\s*(\\/.+\\/)?\\s*/);\n            if (!opts && !args.eol()) { return 'Invalid arguments'; }\n            if (opts[1]) {\n              ignoreCase = opts[1].indexOf('i') != -1;\n              unique = opts[1].indexOf('u') != -1;\n              var decimal = opts[1].indexOf('d') != -1 || opts[1].indexOf('n') != -1 && 1;\n              var hex = opts[1].indexOf('x') != -1 && 1;\n              var octal = opts[1].indexOf('o') != -1 && 1;\n              if (decimal + hex + octal > 1) { return 'Invalid arguments'; }\n              number = decimal && 'decimal' || hex && 'hex' || octal && 'octal';\n            }\n            if (opts[2]) {\n              pattern = new RegExp(opts[2].substr(1, opts[2].length - 2), ignoreCase ? 'i' : '');\n            }\n          }\n        }\n        var err = parseArgs();\n        if (err) {\n          showConfirm(cm, err + ': ' + params.argString);\n          return;\n        }\n        var lineStart = params.line || cm.firstLine();\n        var lineEnd = params.lineEnd || params.line || cm.lastLine();\n        if (lineStart == lineEnd) { return; }\n        var curStart = Pos(lineStart, 0);\n        var curEnd = Pos(lineEnd, lineLength(cm, lineEnd));\n        var text = cm.getRange(curStart, curEnd).split('\\n');\n        var numberRegex = pattern ? pattern :\n           (number == 'decimal') ? /(-?)([\\d]+)/ :\n           (number == 'hex') ? /(-?)(?:0x)?([0-9a-f]+)/i :\n           (number == 'octal') ? /([0-7]+)/ : null;\n        var radix = (number == 'decimal') ? 10 : (number == 'hex') ? 16 : (number == 'octal') ? 8 : null;\n        var numPart = [], textPart = [];\n        if (number || pattern) {\n          for (var i = 0; i < text.length; i++) {\n            var matchPart = pattern ? text[i].match(pattern) : null;\n            if (matchPart && matchPart[0] != '') {\n              numPart.push(matchPart);\n            } else if (!pattern && numberRegex.exec(text[i])) {\n              numPart.push(text[i]);\n            } else {\n              textPart.push(text[i]);\n            }\n          }\n        } else {\n          textPart = text;\n        }\n        function compareFn(a, b) {\n          if (reverse) { var tmp; tmp = a; a = b; b = tmp; }\n          if (ignoreCase) { a = a.toLowerCase(); b = b.toLowerCase(); }\n          var anum = number && numberRegex.exec(a);\n          var bnum = number && numberRegex.exec(b);\n          if (!anum) { return a < b ? -1 : 1; }\n          anum = parseInt((anum[1] + anum[2]).toLowerCase(), radix);\n          bnum = parseInt((bnum[1] + bnum[2]).toLowerCase(), radix);\n          return anum - bnum;\n        }\n        function comparePatternFn(a, b) {\n          if (reverse) { var tmp; tmp = a; a = b; b = tmp; }\n          if (ignoreCase) { a[0] = a[0].toLowerCase(); b[0] = b[0].toLowerCase(); }\n          return (a[0] < b[0]) ? -1 : 1;\n        }\n        numPart.sort(pattern ? comparePatternFn : compareFn);\n        if (pattern) {\n          for (var i = 0; i < numPart.length; i++) {\n            numPart[i] = numPart[i].input;\n          }\n        } else if (!number) { textPart.sort(compareFn); }\n        text = (!reverse) ? textPart.concat(numPart) : numPart.concat(textPart);\n        if (unique) { // Remove duplicate lines\n          var textOld = text;\n          var lastLine;\n          text = [];\n          for (var i = 0; i < textOld.length; i++) {\n            if (textOld[i] != lastLine) {\n              text.push(textOld[i]);\n            }\n            lastLine = textOld[i];\n          }\n        }\n        cm.replaceRange(text.join('\\n'), curStart, curEnd);\n      },\n      global: function(cm, params) {\n        // a global command is of the form\n        // :[range]g/pattern/[cmd]\n        // argString holds the string /pattern/[cmd]\n        var argString = params.argString;\n        if (!argString) {\n          showConfirm(cm, 'Regular Expression missing from global');\n          return;\n        }\n        // range is specified here\n        var lineStart = (params.line !== undefined) ? params.line : cm.firstLine();\n        var lineEnd = params.lineEnd || params.line || cm.lastLine();\n        // get the tokens from argString\n        var tokens = splitBySlash(argString);\n        var regexPart = argString, cmd;\n        if (tokens.length) {\n          regexPart = tokens[0];\n          cmd = tokens.slice(1, tokens.length).join('/');\n        }\n        if (regexPart) {\n          // If regex part is empty, then use the previous query. Otherwise\n          // use the regex part as the new query.\n          try {\n           updateSearchQuery(cm, regexPart, true /** ignoreCase */,\n             true /** smartCase */);\n          } catch (e) {\n           showConfirm(cm, 'Invalid regex: ' + regexPart);\n           return;\n          }\n        }\n        // now that we have the regexPart, search for regex matches in the\n        // specified range of lines\n        var query = getSearchState(cm).getQuery();\n        var matchedLines = [], content = '';\n        for (var i = lineStart; i <= lineEnd; i++) {\n          var matched = query.test(cm.getLine(i));\n          if (matched) {\n            matchedLines.push(i+1);\n            content+= cm.getLine(i) + '<br>';\n          }\n        }\n        // if there is no [cmd], just display the list of matched lines\n        if (!cmd) {\n          showConfirm(cm, content);\n          return;\n        }\n        var index = 0;\n        var nextCommand = function() {\n          if (index < matchedLines.length) {\n            var command = matchedLines[index] + cmd;\n            exCommandDispatcher.processCommand(cm, command, {\n              callback: nextCommand\n            });\n          }\n          index++;\n        };\n        nextCommand();\n      },\n      substitute: function(cm, params) {\n        if (!cm.getSearchCursor) {\n          throw new Error('Search feature not available. Requires searchcursor.js or ' +\n              'any other getSearchCursor implementation.');\n        }\n        var argString = params.argString;\n        var tokens = argString ? splitBySeparator(argString, argString[0]) : [];\n        var regexPart, replacePart = '', trailing, flagsPart, count;\n        var confirm = false; // Whether to confirm each replace.\n        var global = false; // True to replace all instances on a line, false to replace only 1.\n        if (tokens.length) {\n          regexPart = tokens[0];\n          if (getOption('pcre') && regexPart !== '') {\n              regexPart = new RegExp(regexPart).source; //normalize not escaped characters\n          }\n          replacePart = tokens[1];\n          if (regexPart && regexPart[regexPart.length - 1] === '$') {\n            regexPart = regexPart.slice(0, regexPart.length - 1) + '\\\\n';\n            replacePart = replacePart ? replacePart + '\\n' : '\\n';\n          }\n          if (replacePart !== undefined) {\n            if (getOption('pcre')) {\n              replacePart = unescapeRegexReplace(replacePart.replace(/([^\\\\])&/g,\"$1$$&\"));\n            } else {\n              replacePart = translateRegexReplace(replacePart);\n            }\n            vimGlobalState.lastSubstituteReplacePart = replacePart;\n          }\n          trailing = tokens[2] ? tokens[2].split(' ') : [];\n        } else {\n          // either the argString is empty or its of the form ' hello/world'\n          // actually splitBySlash returns a list of tokens\n          // only if the string starts with a '/'\n          if (argString && argString.length) {\n            showConfirm(cm, 'Substitutions should be of the form ' +\n                ':s/pattern/replace/');\n            return;\n          }\n        }\n        // After the 3rd slash, we can have flags followed by a space followed\n        // by count.\n        if (trailing) {\n          flagsPart = trailing[0];\n          count = parseInt(trailing[1]);\n          if (flagsPart) {\n            if (flagsPart.indexOf('c') != -1) {\n              confirm = true;\n              flagsPart.replace('c', '');\n            }\n            if (flagsPart.indexOf('g') != -1) {\n              global = true;\n              flagsPart.replace('g', '');\n            }\n            if (getOption('pcre')) {\n               regexPart = regexPart + '/' + flagsPart;\n            } else {\n               regexPart = regexPart.replace(/\\//g, \"\\\\/\") + '/' + flagsPart;\n            }\n          }\n        }\n        if (regexPart) {\n          // If regex part is empty, then use the previous query. Otherwise use\n          // the regex part as the new query.\n          try {\n            updateSearchQuery(cm, regexPart, true /** ignoreCase */,\n              true /** smartCase */);\n          } catch (e) {\n            showConfirm(cm, 'Invalid regex: ' + regexPart);\n            return;\n          }\n        }\n        replacePart = replacePart || vimGlobalState.lastSubstituteReplacePart;\n        if (replacePart === undefined) {\n          showConfirm(cm, 'No previous substitute regular expression');\n          return;\n        }\n        var state = getSearchState(cm);\n        var query = state.getQuery();\n        var lineStart = (params.line !== undefined) ? params.line : cm.getCursor().line;\n        var lineEnd = params.lineEnd || lineStart;\n        if (lineStart == cm.firstLine() && lineEnd == cm.lastLine()) {\n          lineEnd = Infinity;\n        }\n        if (count) {\n          lineStart = lineEnd;\n          lineEnd = lineStart + count - 1;\n        }\n        var startPos = clipCursorToContent(cm, Pos(lineStart, 0));\n        var cursor = cm.getSearchCursor(query, startPos);\n        doReplace(cm, confirm, global, lineStart, lineEnd, cursor, query, replacePart, params.callback);\n      },\n      redo: CodeMirror.commands.redo,\n      undo: CodeMirror.commands.undo,\n      write: function(cm) {\n        if (CodeMirror.commands.save) {\n          // If a save command is defined, call it.\n          CodeMirror.commands.save(cm);\n        } else if (cm.save) {\n          // Saves to text area if no save command is defined and cm.save() is available.\n          cm.save();\n        }\n      },\n      nohlsearch: function(cm) {\n        clearSearchHighlight(cm);\n      },\n      yank: function (cm) {\n        var cur = copyCursor(cm.getCursor());\n        var line = cur.line;\n        var lineText = cm.getLine(line);\n        vimGlobalState.registerController.pushText(\n          '0', 'yank', lineText, true, true);\n      },\n      delmarks: function(cm, params) {\n        if (!params.argString || !trim(params.argString)) {\n          showConfirm(cm, 'Argument required');\n          return;\n        }\n\n        var state = cm.state.vim;\n        var stream = new CodeMirror.StringStream(trim(params.argString));\n        while (!stream.eol()) {\n          stream.eatSpace();\n\n          // Record the streams position at the beginning of the loop for use\n          // in error messages.\n          var count = stream.pos;\n\n          if (!stream.match(/[a-zA-Z]/, false)) {\n            showConfirm(cm, 'Invalid argument: ' + params.argString.substring(count));\n            return;\n          }\n\n          var sym = stream.next();\n          // Check if this symbol is part of a range\n          if (stream.match('-', true)) {\n            // This symbol is part of a range.\n\n            // The range must terminate at an alphabetic character.\n            if (!stream.match(/[a-zA-Z]/, false)) {\n              showConfirm(cm, 'Invalid argument: ' + params.argString.substring(count));\n              return;\n            }\n\n            var startMark = sym;\n            var finishMark = stream.next();\n            // The range must terminate at an alphabetic character which\n            // shares the same case as the start of the range.\n            if (isLowerCase(startMark) && isLowerCase(finishMark) ||\n                isUpperCase(startMark) && isUpperCase(finishMark)) {\n              var start = startMark.charCodeAt(0);\n              var finish = finishMark.charCodeAt(0);\n              if (start >= finish) {\n                showConfirm(cm, 'Invalid argument: ' + params.argString.substring(count));\n                return;\n              }\n\n              // Because marks are always ASCII values, and we have\n              // determined that they are the same case, we can use\n              // their char codes to iterate through the defined range.\n              for (var j = 0; j <= finish - start; j++) {\n                var mark = String.fromCharCode(start + j);\n                delete state.marks[mark];\n              }\n            } else {\n              showConfirm(cm, 'Invalid argument: ' + startMark + '-');\n              return;\n            }\n          } else {\n            // This symbol is a valid mark, and is not part of a range.\n            delete state.marks[sym];\n          }\n        }\n      }\n    };\n\n    var exCommandDispatcher = new ExCommandDispatcher();\n\n    /**\n    * @param {CodeMirror} cm CodeMirror instance we are in.\n    * @param {boolean} confirm Whether to confirm each replace.\n    * @param {Cursor} lineStart Line to start replacing from.\n    * @param {Cursor} lineEnd Line to stop replacing at.\n    * @param {RegExp} query Query for performing matches with.\n    * @param {string} replaceWith Text to replace matches with. May contain $1,\n    *     $2, etc for replacing captured groups using Javascript replace.\n    * @param {function()} callback A callback for when the replace is done.\n    */\n    function doReplace(cm, confirm, global, lineStart, lineEnd, searchCursor, query,\n        replaceWith, callback) {\n      // Set up all the functions.\n      cm.state.vim.exMode = true;\n      var done = false;\n      var lastPos = searchCursor.from();\n      function replaceAll() {\n        cm.operation(function() {\n          while (!done) {\n            replace();\n            next();\n          }\n          stop();\n        });\n      }\n      function replace() {\n        var text = cm.getRange(searchCursor.from(), searchCursor.to());\n        var newText = text.replace(query, replaceWith);\n        searchCursor.replace(newText);\n      }\n      function next() {\n        // The below only loops to skip over multiple occurrences on the same\n        // line when 'global' is not true.\n        while(searchCursor.findNext() &&\n              isInRange(searchCursor.from(), lineStart, lineEnd)) {\n          if (!global && lastPos && searchCursor.from().line == lastPos.line) {\n            continue;\n          }\n          cm.scrollIntoView(searchCursor.from(), 30);\n          cm.setSelection(searchCursor.from(), searchCursor.to());\n          lastPos = searchCursor.from();\n          done = false;\n          return;\n        }\n        done = true;\n      }\n      function stop(close) {\n        if (close) { close(); }\n        cm.focus();\n        if (lastPos) {\n          cm.setCursor(lastPos);\n          var vim = cm.state.vim;\n          vim.exMode = false;\n          vim.lastHPos = vim.lastHSPos = lastPos.ch;\n        }\n        if (callback) { callback(); }\n      }\n      function onPromptKeyDown(e, _value, close) {\n        // Swallow all keys.\n        CodeMirror.e_stop(e);\n        var keyName = CodeMirror.keyName(e);\n        switch (keyName) {\n          case 'Y':\n            replace(); next(); break;\n          case 'N':\n            next(); break;\n          case 'A':\n            // replaceAll contains a call to close of its own. We don't want it\n            // to fire too early or multiple times.\n            var savedCallback = callback;\n            callback = undefined;\n            cm.operation(replaceAll);\n            callback = savedCallback;\n            break;\n          case 'L':\n            replace();\n            // fall through and exit.\n          case 'Q':\n          case 'Esc':\n          case 'Ctrl-C':\n          case 'Ctrl-[':\n            stop(close);\n            break;\n        }\n        if (done) { stop(close); }\n        return true;\n      }\n\n      // Actually do replace.\n      next();\n      if (done) {\n        showConfirm(cm, 'No matches for ' + query.source);\n        return;\n      }\n      if (!confirm) {\n        replaceAll();\n        if (callback) { callback(); }\n        return;\n      }\n      showPrompt(cm, {\n        prefix: 'replace with <strong>' + replaceWith + '</strong> (y/n/a/q/l)',\n        onKeyDown: onPromptKeyDown\n      });\n    }\n\n    CodeMirror.keyMap.vim = {\n      attach: attachVimMap,\n      detach: detachVimMap,\n      call: cmKey\n    };\n\n    function exitInsertMode(cm) {\n      var vim = cm.state.vim;\n      var macroModeState = vimGlobalState.macroModeState;\n      var insertModeChangeRegister = vimGlobalState.registerController.getRegister('.');\n      var isPlaying = macroModeState.isPlaying;\n      var lastChange = macroModeState.lastInsertModeChanges;\n      if (!isPlaying) {\n        cm.off('change', onChange);\n        CodeMirror.off(cm.getInputField(), 'keydown', onKeyEventTargetKeyDown);\n      }\n      if (!isPlaying && vim.insertModeRepeat > 1) {\n        // Perform insert mode repeat for commands like 3,a and 3,o.\n        repeatLastEdit(cm, vim, vim.insertModeRepeat - 1,\n            true /** repeatForInsert */);\n        vim.lastEditInputState.repeatOverride = vim.insertModeRepeat;\n      }\n      delete vim.insertModeRepeat;\n      vim.insertMode = false;\n      cm.setCursor(cm.getCursor().line, cm.getCursor().ch-1);\n      cm.setOption('keyMap', 'vim');\n      cm.setOption('disableInput', true);\n      cm.toggleOverwrite(false); // exit replace mode if we were in it.\n      // update the \". register before exiting insert mode\n      insertModeChangeRegister.setText(lastChange.changes.join(''));\n      CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"normal\"});\n      if (macroModeState.isRecording) {\n        logInsertModeChange(macroModeState);\n      }\n    }\n\n    function _mapCommand(command) {\n      defaultKeymap.unshift(command);\n    }\n\n    function mapCommand(keys, type, name, args, extra) {\n      var command = {keys: keys, type: type};\n      command[type] = name;\n      command[type + \"Args\"] = args;\n      for (var key in extra)\n        command[key] = extra[key];\n      _mapCommand(command);\n    }\n\n    // The timeout in milliseconds for the two-character ESC keymap should be\n    // adjusted according to your typing speed to prevent false positives.\n    defineOption('insertModeEscKeysTimeout', 200, 'number');\n\n    CodeMirror.keyMap['vim-insert'] = {\n      // TODO: override navigation keys so that Esc will cancel automatic\n      // indentation from o, O, i_<CR>\n      fallthrough: ['default'],\n      attach: attachVimMap,\n      detach: detachVimMap,\n      call: cmKey\n    };\n\n    CodeMirror.keyMap['vim-replace'] = {\n      'Backspace': 'goCharLeft',\n      fallthrough: ['vim-insert'],\n      attach: attachVimMap,\n      detach: detachVimMap,\n      call: cmKey\n    };\n\n    function executeMacroRegister(cm, vim, macroModeState, registerName) {\n      var register = vimGlobalState.registerController.getRegister(registerName);\n      if (registerName == ':') {\n        // Read-only register containing last Ex command.\n        if (register.keyBuffer[0]) {\n          exCommandDispatcher.processCommand(cm, register.keyBuffer[0]);\n        }\n        macroModeState.isPlaying = false;\n        return;\n      }\n      var keyBuffer = register.keyBuffer;\n      var imc = 0;\n      macroModeState.isPlaying = true;\n      macroModeState.replaySearchQueries = register.searchQueries.slice(0);\n      for (var i = 0; i < keyBuffer.length; i++) {\n        var text = keyBuffer[i];\n        var match, key;\n        while (text) {\n          // Pull off one command key, which is either a single character\n          // or a special sequence wrapped in '<' and '>', e.g. '<Space>'.\n          match = (/<\\w+-.+?>|<\\w+>|./).exec(text);\n          key = match[0];\n          text = text.substring(match.index + key.length);\n          CodeMirror.Vim.handleKey(cm, key, 'macro');\n          if (vim.insertMode) {\n            var changes = register.insertModeChanges[imc++].changes;\n            vimGlobalState.macroModeState.lastInsertModeChanges.changes =\n                changes;\n            repeatInsertModeChanges(cm, changes, 1);\n            exitInsertMode(cm);\n          }\n        }\n      }\n      macroModeState.isPlaying = false;\n    }\n\n    function logKey(macroModeState, key) {\n      if (macroModeState.isPlaying) { return; }\n      var registerName = macroModeState.latestRegister;\n      var register = vimGlobalState.registerController.getRegister(registerName);\n      if (register) {\n        register.pushText(key);\n      }\n    }\n\n    function logInsertModeChange(macroModeState) {\n      if (macroModeState.isPlaying) { return; }\n      var registerName = macroModeState.latestRegister;\n      var register = vimGlobalState.registerController.getRegister(registerName);\n      if (register && register.pushInsertModeChanges) {\n        register.pushInsertModeChanges(macroModeState.lastInsertModeChanges);\n      }\n    }\n\n    function logSearchQuery(macroModeState, query) {\n      if (macroModeState.isPlaying) { return; }\n      var registerName = macroModeState.latestRegister;\n      var register = vimGlobalState.registerController.getRegister(registerName);\n      if (register && register.pushSearchQuery) {\n        register.pushSearchQuery(query);\n      }\n    }\n\n    /**\n     * Listens for changes made in insert mode.\n     * Should only be active in insert mode.\n     */\n    function onChange(cm, changeObj) {\n      var macroModeState = vimGlobalState.macroModeState;\n      var lastChange = macroModeState.lastInsertModeChanges;\n      if (!macroModeState.isPlaying) {\n        while(changeObj) {\n          lastChange.expectCursorActivityForChange = true;\n          if (lastChange.ignoreCount > 1) {\n            lastChange.ignoreCount--;\n          } else if (changeObj.origin == '+input' || changeObj.origin == 'paste'\n              || changeObj.origin === undefined /* only in testing */) {\n            var selectionCount = cm.listSelections().length;\n            if (selectionCount > 1)\n              lastChange.ignoreCount = selectionCount;\n            var text = changeObj.text.join('\\n');\n            if (lastChange.maybeReset) {\n              lastChange.changes = [];\n              lastChange.maybeReset = false;\n            }\n            if (text) {\n              if (cm.state.overwrite && !/\\n/.test(text)) {\n                lastChange.changes.push([text]);\n              } else {\n                lastChange.changes.push(text);\n              }\n            }\n          }\n          // Change objects may be chained with next.\n          changeObj = changeObj.next;\n        }\n      }\n    }\n\n    /**\n    * Listens for any kind of cursor activity on CodeMirror.\n    */\n    function onCursorActivity(cm) {\n      var vim = cm.state.vim;\n      if (vim.insertMode) {\n        // Tracking cursor activity in insert mode (for macro support).\n        var macroModeState = vimGlobalState.macroModeState;\n        if (macroModeState.isPlaying) { return; }\n        var lastChange = macroModeState.lastInsertModeChanges;\n        if (lastChange.expectCursorActivityForChange) {\n          lastChange.expectCursorActivityForChange = false;\n        } else {\n          // Cursor moved outside the context of an edit. Reset the change.\n          lastChange.maybeReset = true;\n        }\n      } else if (!cm.curOp.isVimOp) {\n        handleExternalSelection(cm, vim);\n      }\n      if (vim.visualMode) {\n        updateFakeCursor(cm);\n      }\n    }\n    /**\n     * Keeps track of a fake cursor to support visual mode cursor behavior.\n     */\n    function updateFakeCursor(cm) {\n      var className = 'cm-animate-fat-cursor';\n      var vim = cm.state.vim;\n      var from = clipCursorToContent(cm, copyCursor(vim.sel.head));\n      var to = offsetCursor(from, 0, 1);\n      clearFakeCursor(vim);\n      // In visual mode, the cursor may be positioned over EOL.\n      if (from.ch == cm.getLine(from.line).length) {\n        var widget = document.createElement(\"span\");\n        widget.textContent = \"\\u00a0\";\n        widget.className = className;\n        vim.fakeCursorBookmark = cm.setBookmark(from, {widget: widget});\n      } else {\n        vim.fakeCursor = cm.markText(from, to, {className: className});\n      }\n    }\n    function clearFakeCursor(vim) {\n      if (vim.fakeCursor) {\n        vim.fakeCursor.clear();\n        vim.fakeCursor = null;\n      }\n      if (vim.fakeCursorBookmark) {\n        vim.fakeCursorBookmark.clear();\n        vim.fakeCursorBookmark = null;\n      }\n    }\n    function handleExternalSelection(cm, vim) {\n      var anchor = cm.getCursor('anchor');\n      var head = cm.getCursor('head');\n      // Enter or exit visual mode to match mouse selection.\n      if (vim.visualMode && !cm.somethingSelected()) {\n        exitVisualMode(cm, false);\n      } else if (!vim.visualMode && !vim.insertMode && cm.somethingSelected()) {\n        vim.visualMode = true;\n        vim.visualLine = false;\n        CodeMirror.signal(cm, \"vim-mode-change\", {mode: \"visual\"});\n      }\n      if (vim.visualMode) {\n        // Bind CodeMirror selection model to vim selection model.\n        // Mouse selections are considered visual characterwise.\n        var headOffset = !cursorIsBefore(head, anchor) ? -1 : 0;\n        var anchorOffset = cursorIsBefore(head, anchor) ? -1 : 0;\n        head = offsetCursor(head, 0, headOffset);\n        anchor = offsetCursor(anchor, 0, anchorOffset);\n        vim.sel = {\n          anchor: anchor,\n          head: head\n        };\n        updateMark(cm, vim, '<', cursorMin(head, anchor));\n        updateMark(cm, vim, '>', cursorMax(head, anchor));\n      } else if (!vim.insertMode) {\n        // Reset lastHPos if selection was modified by something outside of vim mode e.g. by mouse.\n        vim.lastHPos = cm.getCursor().ch;\n      }\n    }\n\n    /** Wrapper for special keys pressed in insert mode */\n    function InsertModeKey(keyName) {\n      this.keyName = keyName;\n    }\n\n    /**\n    * Handles raw key down events from the text area.\n    * - Should only be active in insert mode.\n    * - For recording deletes in insert mode.\n    */\n    function onKeyEventTargetKeyDown(e) {\n      var macroModeState = vimGlobalState.macroModeState;\n      var lastChange = macroModeState.lastInsertModeChanges;\n      var keyName = CodeMirror.keyName(e);\n      if (!keyName) { return; }\n      function onKeyFound() {\n        if (lastChange.maybeReset) {\n          lastChange.changes = [];\n          lastChange.maybeReset = false;\n        }\n        lastChange.changes.push(new InsertModeKey(keyName));\n        return true;\n      }\n      if (keyName.indexOf('Delete') != -1 || keyName.indexOf('Backspace') != -1) {\n        CodeMirror.lookupKey(keyName, 'vim-insert', onKeyFound);\n      }\n    }\n\n    /**\n     * Repeats the last edit, which includes exactly 1 command and at most 1\n     * insert. Operator and motion commands are read from lastEditInputState,\n     * while action commands are read from lastEditActionCommand.\n     *\n     * If repeatForInsert is true, then the function was called by\n     * exitInsertMode to repeat the insert mode changes the user just made. The\n     * corresponding enterInsertMode call was made with a count.\n     */\n    function repeatLastEdit(cm, vim, repeat, repeatForInsert) {\n      var macroModeState = vimGlobalState.macroModeState;\n      macroModeState.isPlaying = true;\n      var isAction = !!vim.lastEditActionCommand;\n      var cachedInputState = vim.inputState;\n      function repeatCommand() {\n        if (isAction) {\n          commandDispatcher.processAction(cm, vim, vim.lastEditActionCommand);\n        } else {\n          commandDispatcher.evalInput(cm, vim);\n        }\n      }\n      function repeatInsert(repeat) {\n        if (macroModeState.lastInsertModeChanges.changes.length > 0) {\n          // For some reason, repeat cw in desktop VIM does not repeat\n          // insert mode changes. Will conform to that behavior.\n          repeat = !vim.lastEditActionCommand ? 1 : repeat;\n          var changeObject = macroModeState.lastInsertModeChanges;\n          repeatInsertModeChanges(cm, changeObject.changes, repeat);\n        }\n      }\n      vim.inputState = vim.lastEditInputState;\n      if (isAction && vim.lastEditActionCommand.interlaceInsertRepeat) {\n        // o and O repeat have to be interlaced with insert repeats so that the\n        // insertions appear on separate lines instead of the last line.\n        for (var i = 0; i < repeat; i++) {\n          repeatCommand();\n          repeatInsert(1);\n        }\n      } else {\n        if (!repeatForInsert) {\n          // Hack to get the cursor to end up at the right place. If I is\n          // repeated in insert mode repeat, cursor will be 1 insert\n          // change set left of where it should be.\n          repeatCommand();\n        }\n        repeatInsert(repeat);\n      }\n      vim.inputState = cachedInputState;\n      if (vim.insertMode && !repeatForInsert) {\n        // Don't exit insert mode twice. If repeatForInsert is set, then we\n        // were called by an exitInsertMode call lower on the stack.\n        exitInsertMode(cm);\n      }\n      macroModeState.isPlaying = false;\n    }\n\n    function repeatInsertModeChanges(cm, changes, repeat) {\n      function keyHandler(binding) {\n        if (typeof binding == 'string') {\n          CodeMirror.commands[binding](cm);\n        } else {\n          binding(cm);\n        }\n        return true;\n      }\n      var head = cm.getCursor('head');\n      var visualBlock = vimGlobalState.macroModeState.lastInsertModeChanges.visualBlock;\n      if (visualBlock) {\n        // Set up block selection again for repeating the changes.\n        selectForInsert(cm, head, visualBlock + 1);\n        repeat = cm.listSelections().length;\n        cm.setCursor(head);\n      }\n      for (var i = 0; i < repeat; i++) {\n        if (visualBlock) {\n          cm.setCursor(offsetCursor(head, i, 0));\n        }\n        for (var j = 0; j < changes.length; j++) {\n          var change = changes[j];\n          if (change instanceof InsertModeKey) {\n            CodeMirror.lookupKey(change.keyName, 'vim-insert', keyHandler);\n          } else if (typeof change == \"string\") {\n            var cur = cm.getCursor();\n            cm.replaceRange(change, cur, cur);\n          } else {\n            var start = cm.getCursor();\n            var end = offsetCursor(start, 0, change[0].length);\n            cm.replaceRange(change[0], start, end);\n          }\n        }\n      }\n      if (visualBlock) {\n        cm.setCursor(offsetCursor(head, 0, 1));\n      }\n    }\n\n    resetVimGlobalState();\n    return vimApi;\n  };\n  // Initialize Vim and make it available as an API.\n  CodeMirror.Vim = Vim();\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {\n    this.id = null;\n    this.f = null;\n    this.time = 0;\n    this.handler = bind(this.onTimeout, this);\n  };\n  Delayed.prototype.onTimeout = function (self) {\n    self.id = 0;\n    if (self.time <= +new Date) {\n      self.f();\n    } else {\n      setTimeout(self.handler, self.time - +new Date);\n    }\n  };\n  Delayed.prototype.set = function (ms, f) {\n    this.f = f;\n    var time = +new Date + ms;\n    if (!this.id || time < this.time) {\n      clearTimeout(this.id);\n      this.id = setTimeout(this.handler, ms);\n      this.time = time;\n    }\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 50;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length, isRTL = direction == \"rtl\" ? 1 : 0;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              at += isRTL;\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers, arr = map && map[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range;\n    try {range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) { return false }\n    return range.compareEndPoints(\"StartToEnd\", range) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\\\s)\" + lineClass[2] + \"(?:$|\\\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    var isWidget = classTest(\"CodeMirror-linewidget\");\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\" + (widget.className ? \" \" + widget.className : \"\"));\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\", \"CodeMirror-line-like\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = outside; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight; box.bottom += widgetHeight;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\", null, \"CodeMirror-line-like\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor], \"CodeMirror-line-like\");\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e$1) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range = doc.sel.ranges[i];\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n        cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      onBlur(cm);\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName) &&\n        snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range = document.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      } else if (first) {\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\n      // is with selectLeft/Right\n      var preventCursorLeft = (\"selectLeft\" in m) ? !m.selectLeft : m.inclusiveLeft;\n      var preventCursorRight = (\"selectRight\" in m) ? !m.selectRight : m.inclusiveRight;\n\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\n      { doc.cantEdit = false; }\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        { if (op(this.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this.children.splice(++i, 0, leaf);\n              leaf.parent = this;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range.head; }\n      else if (start == \"anchor\") { pos = range.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to(); }\n      else { pos = range.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {\n      var this$1 = this;\n\n      this.history = new History(this.history.maxGeneration);\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\n    },\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\n                span.from == null && lineNo != from.line ||\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) { continue }\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\n        if (++read == n) {\n          operation(cm, function () {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\n          })();\n        }\n      };\n      var readTextFromFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          markAsReadAndPasteIfAllFilesAreRead();\n          return\n        }\n        var reader = new FileReader;\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\n        reader.onload = function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            markAsReadAndPasteIfAllFilesAreRead();\n            return\n          }\n          text[i] = content;\n          markAsReadAndPasteIfAllFilesAreRead();\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e$1){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map.fallthrough, handle, context) }\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      if (cm.doc.direction == \"rtl\") { dir = -dir; }\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\n      { document.execCommand(\"cut\"); }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if ((webkit && !safari) || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus({preventScroll: true}); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    delayBlurEvent(cm);\n    setTimeout(function () { return display.input.focus(); }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\n      else\n        { ourRange = range; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\n    var order = getOrder(anchorLine);\n    if (!order) { return range }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e$1) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200c\\u200e\\u200f\\u2028\\u2029\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n\n    option(\"screenReaderLabel\", null, function (cm, val) {\n      val = (val === '') ? null : val;\n      cm.display.input.screenReaderLabelChanged(val);\n    });\n\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(bind(onFocus, this), 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n    on(d.input.getField(), \"contextmenu\", function (e) {\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\n    });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          { indented = indentLine(cm, range.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function(map) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this.state.modeGen++;\n            regChange(this);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n          if (!range.empty()) {\n            var from = range.from(), to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this, j, how); }\n            var newRanges = this.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range.head.line > end) {\n            indentLine(this, range.head.line, how, true);\n            end = range.head.line;\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range = this.doc.sel.primary();\n        if (start == null) { pos = range.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range.from() : range.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range.from() : range.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range) {\n            var other = findPosH(doc, range.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse)\n            { return dir < 0 ? range.from() : range.to() }\n          var headPos = cursorCoords(this$1, range.head, \"div\");\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range, margin) {\n        if (range == null) {\n          range = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range == \"number\") {\n          range = {from: Pos(range, 0), to: null};\n        } else if (range.from == null) {\n          range = {from: range, to: null};\n        }\n        if (!range.to) { range.to = range.from; }\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5 || this.options.lineWrapping)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    var lineDir = visually && doc.direction == \"rtl\" ? -dir : dir;\n    function findNextLine() {\n      var l = pos.line + lineDir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    function belongsToInput(e) {\n      for (var t = e.target; t; t = t.parentNode) {\n        if (t == div) { return true }\n        if (/\\bCodeMirror-(?:line)?widget\\b/.test(t.className)) { break }\n      }\n      return false\n    }\n\n    on(div, \"paste\", function (e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.div.setAttribute('aria-label', label);\n    } else {\n      this.div.removeAttribute('aria-label');\n    }\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = document.activeElement == this.div;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor() || document.activeElement != this.div)\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find(0)))\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.textarea.setAttribute('aria-label', label);\n    } else {\n      this.textarea.removeAttribute('aria-label');\n    }\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, */) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.55.0\";\n\n  return CodeMirror;\n\n})));\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../markdown/markdown\"), require(\"../../addon/mode/overlay\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../markdown/markdown\", \"../../addon/mode/overlay\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nvar urlRE = /^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\\.beep|\\.lwz|\\.xpc|\\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\\.beeps?|xmpp|xri|ymsgr|z39\\.50[rs]?):(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]|\\([^\\s()<>]*\\))+(?:\\([^\\s()<>]*\\)|[^\\s`*!()\\[\\]{};:'\".,<>?]))/i\n\nCodeMirror.defineMode(\"gfm\", function(config, modeConfig) {\n  var codeDepth = 0;\n  function blankLine(state) {\n    state.code = false;\n    return null;\n  }\n  var gfmOverlay = {\n    startState: function() {\n      return {\n        code: false,\n        codeBlock: false,\n        ateSpace: false\n      };\n    },\n    copyState: function(s) {\n      return {\n        code: s.code,\n        codeBlock: s.codeBlock,\n        ateSpace: s.ateSpace\n      };\n    },\n    token: function(stream, state) {\n      state.combineTokens = null;\n\n      // Hack to prevent formatting override inside code blocks (block and inline)\n      if (state.codeBlock) {\n        if (stream.match(/^```+/)) {\n          state.codeBlock = false;\n          return null;\n        }\n        stream.skipToEnd();\n        return null;\n      }\n      if (stream.sol()) {\n        state.code = false;\n      }\n      if (stream.sol() && stream.match(/^```+/)) {\n        stream.skipToEnd();\n        state.codeBlock = true;\n        return null;\n      }\n      // If this block is changed, it may need to be updated in Markdown mode\n      if (stream.peek() === '`') {\n        stream.next();\n        var before = stream.pos;\n        stream.eatWhile('`');\n        var difference = 1 + stream.pos - before;\n        if (!state.code) {\n          codeDepth = difference;\n          state.code = true;\n        } else {\n          if (difference === codeDepth) { // Must be exact\n            state.code = false;\n          }\n        }\n        return null;\n      } else if (state.code) {\n        stream.next();\n        return null;\n      }\n      // Check if space. If so, links can be formatted later on\n      if (stream.eatSpace()) {\n        state.ateSpace = true;\n        return null;\n      }\n      if (stream.sol() || state.ateSpace) {\n        state.ateSpace = false;\n        if (modeConfig.gitHubSpice !== false) {\n          if(stream.match(/^(?:[a-zA-Z0-9\\-_]+\\/)?(?:[a-zA-Z0-9\\-_]+@)?(?=.{0,6}\\d)(?:[a-f0-9]{7,40}\\b)/)) {\n            // User/Project@SHA\n            // User@SHA\n            // SHA\n            state.combineTokens = true;\n            return \"link\";\n          } else if (stream.match(/^(?:[a-zA-Z0-9\\-_]+\\/)?(?:[a-zA-Z0-9\\-_]+)?#[0-9]+\\b/)) {\n            // User/Project#Num\n            // User#Num\n            // #Num\n            state.combineTokens = true;\n            return \"link\";\n          }\n        }\n      }\n      if (stream.match(urlRE) &&\n          stream.string.slice(stream.start - 2, stream.start) != \"](\" &&\n          (stream.start == 0 || /\\W/.test(stream.string.charAt(stream.start - 1)))) {\n        // URLs\n        // Taken from http://daringfireball.net/2010/07/improved_regex_for_matching_urls\n        // And then (issue #1160) simplified to make it not crash the Chrome Regexp engine\n        // And then limited url schemes to the CommonMark list, so foo:bar isn't matched as a URL\n        state.combineTokens = true;\n        return \"link\";\n      }\n      stream.next();\n      return null;\n    },\n    blankLine: blankLine\n  };\n\n  var markdownConfig = {\n    taskLists: true,\n    strikethrough: true,\n    emoji: true\n  };\n  for (var attr in modeConfig) {\n    markdownConfig[attr] = modeConfig[attr];\n  }\n  markdownConfig.name = \"markdown\";\n  return CodeMirror.overlayMode(CodeMirror.getMode(config, markdownConfig), gfmOverlay);\n\n}, \"markdown\");\n\n  CodeMirror.defineMIME(\"text/x-gfm\", \"gfm\");\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../xml/xml\"), require(\"../meta\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../xml/xml\", \"../meta\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"markdown\", function(cmCfg, modeCfg) {\n\n  var htmlMode = CodeMirror.getMode(cmCfg, \"text/html\");\n  var htmlModeMissing = htmlMode.name == \"null\"\n\n  function getMode(name) {\n    if (CodeMirror.findModeByName) {\n      var found = CodeMirror.findModeByName(name);\n      if (found) name = found.mime || found.mimes[0];\n    }\n    var mode = CodeMirror.getMode(cmCfg, name);\n    return mode.name == \"null\" ? null : mode;\n  }\n\n  // Should characters that affect highlighting be highlighted separate?\n  // Does not include characters that will be output (such as `1.` and `-` for lists)\n  if (modeCfg.highlightFormatting === undefined)\n    modeCfg.highlightFormatting = false;\n\n  // Maximum number of nested blockquotes. Set to 0 for infinite nesting.\n  // Excess `>` will emit `error` token.\n  if (modeCfg.maxBlockquoteDepth === undefined)\n    modeCfg.maxBlockquoteDepth = 0;\n\n  // Turn on task lists? (\"- [ ] \" and \"- [x] \")\n  if (modeCfg.taskLists === undefined) modeCfg.taskLists = false;\n\n  // Turn on strikethrough syntax\n  if (modeCfg.strikethrough === undefined)\n    modeCfg.strikethrough = false;\n\n  if (modeCfg.emoji === undefined)\n    modeCfg.emoji = false;\n\n  if (modeCfg.fencedCodeBlockHighlighting === undefined)\n    modeCfg.fencedCodeBlockHighlighting = true;\n\n  if (modeCfg.fencedCodeBlockDefaultMode === undefined)\n    modeCfg.fencedCodeBlockDefaultMode = 'text/plain';\n\n  if (modeCfg.xml === undefined)\n    modeCfg.xml = true;\n\n  // Allow token types to be overridden by user-provided token types.\n  if (modeCfg.tokenTypeOverrides === undefined)\n    modeCfg.tokenTypeOverrides = {};\n\n  var tokenTypes = {\n    header: \"header\",\n    code: \"comment\",\n    quote: \"quote\",\n    list1: \"variable-2\",\n    list2: \"variable-3\",\n    list3: \"keyword\",\n    hr: \"hr\",\n    image: \"image\",\n    imageAltText: \"image-alt-text\",\n    imageMarker: \"image-marker\",\n    formatting: \"formatting\",\n    linkInline: \"link\",\n    linkEmail: \"link\",\n    linkText: \"link\",\n    linkHref: \"string\",\n    em: \"em\",\n    strong: \"strong\",\n    strikethrough: \"strikethrough\",\n    emoji: \"builtin\"\n  };\n\n  for (var tokenType in tokenTypes) {\n    if (tokenTypes.hasOwnProperty(tokenType) && modeCfg.tokenTypeOverrides[tokenType]) {\n      tokenTypes[tokenType] = modeCfg.tokenTypeOverrides[tokenType];\n    }\n  }\n\n  var hrRE = /^([*\\-_])(?:\\s*\\1){2,}\\s*$/\n  ,   listRE = /^(?:[*\\-+]|^[0-9]+([.)]))\\s+/\n  ,   taskListRE = /^\\[(x| )\\](?=\\s)/i // Must follow listRE\n  ,   atxHeaderRE = modeCfg.allowAtxHeaderWithoutSpace ? /^(#+)/ : /^(#+)(?: |$)/\n  ,   setextHeaderRE = /^ {0,3}(?:\\={1,}|-{2,})\\s*$/\n  ,   textRE = /^[^#!\\[\\]*_\\\\<>` \"'(~:]+/\n  ,   fencedCodeRE = /^(~~~+|```+)[ \\t]*([\\w\\/+#-]*)[^\\n`]*$/\n  ,   linkDefRE = /^\\s*\\[[^\\]]+?\\]:.*$/ // naive link-definition\n  ,   punctuation = /[!\"#$%&'()*+,\\-.\\/:;<=>?@\\[\\\\\\]^_`{|}~\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0AF0\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E42\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC9\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDF3C-\\uDF3E]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]/\n  ,   expandedTab = \"    \" // CommonMark specifies tab as 4 spaces\n\n  function switchInline(stream, state, f) {\n    state.f = state.inline = f;\n    return f(stream, state);\n  }\n\n  function switchBlock(stream, state, f) {\n    state.f = state.block = f;\n    return f(stream, state);\n  }\n\n  function lineIsEmpty(line) {\n    return !line || !/\\S/.test(line.string)\n  }\n\n  // Blocks\n\n  function blankLine(state) {\n    // Reset linkTitle state\n    state.linkTitle = false;\n    state.linkHref = false;\n    state.linkText = false;\n    // Reset EM state\n    state.em = false;\n    // Reset STRONG state\n    state.strong = false;\n    // Reset strikethrough state\n    state.strikethrough = false;\n    // Reset state.quote\n    state.quote = 0;\n    // Reset state.indentedCode\n    state.indentedCode = false;\n    if (state.f == htmlBlock) {\n      var exit = htmlModeMissing\n      if (!exit) {\n        var inner = CodeMirror.innerMode(htmlMode, state.htmlState)\n        exit = inner.mode.name == \"xml\" && inner.state.tagStart === null &&\n          (!inner.state.context && inner.state.tokenize.isInText)\n      }\n      if (exit) {\n        state.f = inlineNormal;\n        state.block = blockNormal;\n        state.htmlState = null;\n      }\n    }\n    // Reset state.trailingSpace\n    state.trailingSpace = 0;\n    state.trailingSpaceNewLine = false;\n    // Mark this line as blank\n    state.prevLine = state.thisLine\n    state.thisLine = {stream: null}\n    return null;\n  }\n\n  function blockNormal(stream, state) {\n    var firstTokenOnLine = stream.column() === state.indentation;\n    var prevLineLineIsEmpty = lineIsEmpty(state.prevLine.stream);\n    var prevLineIsIndentedCode = state.indentedCode;\n    var prevLineIsHr = state.prevLine.hr;\n    var prevLineIsList = state.list !== false;\n    var maxNonCodeIndentation = (state.listStack[state.listStack.length - 1] || 0) + 3;\n\n    state.indentedCode = false;\n\n    var lineIndentation = state.indentation;\n    // compute once per line (on first token)\n    if (state.indentationDiff === null) {\n      state.indentationDiff = state.indentation;\n      if (prevLineIsList) {\n        state.list = null;\n        // While this list item's marker's indentation is less than the deepest\n        //  list item's content's indentation,pop the deepest list item\n        //  indentation off the stack, and update block indentation state\n        while (lineIndentation < state.listStack[state.listStack.length - 1]) {\n          state.listStack.pop();\n          if (state.listStack.length) {\n            state.indentation = state.listStack[state.listStack.length - 1];\n          // less than the first list's indent -> the line is no longer a list\n          } else {\n            state.list = false;\n          }\n        }\n        if (state.list !== false) {\n          state.indentationDiff = lineIndentation - state.listStack[state.listStack.length - 1]\n        }\n      }\n    }\n\n    // not comprehensive (currently only for setext detection purposes)\n    var allowsInlineContinuation = (\n        !prevLineLineIsEmpty && !prevLineIsHr && !state.prevLine.header &&\n        (!prevLineIsList || !prevLineIsIndentedCode) &&\n        !state.prevLine.fencedCodeEnd\n    );\n\n    var isHr = (state.list === false || prevLineIsHr || prevLineLineIsEmpty) &&\n      state.indentation <= maxNonCodeIndentation && stream.match(hrRE);\n\n    var match = null;\n    if (state.indentationDiff >= 4 && (prevLineIsIndentedCode || state.prevLine.fencedCodeEnd ||\n         state.prevLine.header || prevLineLineIsEmpty)) {\n      stream.skipToEnd();\n      state.indentedCode = true;\n      return tokenTypes.code;\n    } else if (stream.eatSpace()) {\n      return null;\n    } else if (firstTokenOnLine && state.indentation <= maxNonCodeIndentation && (match = stream.match(atxHeaderRE)) && match[1].length <= 6) {\n      state.quote = 0;\n      state.header = match[1].length;\n      state.thisLine.header = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"header\";\n      state.f = state.inline;\n      return getType(state);\n    } else if (state.indentation <= maxNonCodeIndentation && stream.eat('>')) {\n      state.quote = firstTokenOnLine ? 1 : state.quote + 1;\n      if (modeCfg.highlightFormatting) state.formatting = \"quote\";\n      stream.eatSpace();\n      return getType(state);\n    } else if (!isHr && !state.setext && firstTokenOnLine && state.indentation <= maxNonCodeIndentation && (match = stream.match(listRE))) {\n      var listType = match[1] ? \"ol\" : \"ul\";\n\n      state.indentation = lineIndentation + stream.current().length;\n      state.list = true;\n      state.quote = 0;\n\n      // Add this list item's content's indentation to the stack\n      state.listStack.push(state.indentation);\n      // Reset inline styles which shouldn't propagate aross list items\n      state.em = false;\n      state.strong = false;\n      state.code = false;\n      state.strikethrough = false;\n\n      if (modeCfg.taskLists && stream.match(taskListRE, false)) {\n        state.taskList = true;\n      }\n      state.f = state.inline;\n      if (modeCfg.highlightFormatting) state.formatting = [\"list\", \"list-\" + listType];\n      return getType(state);\n    } else if (firstTokenOnLine && state.indentation <= maxNonCodeIndentation && (match = stream.match(fencedCodeRE, true))) {\n      state.quote = 0;\n      state.fencedEndRE = new RegExp(match[1] + \"+ *$\");\n      // try switching mode\n      state.localMode = modeCfg.fencedCodeBlockHighlighting && getMode(match[2] || modeCfg.fencedCodeBlockDefaultMode );\n      if (state.localMode) state.localState = CodeMirror.startState(state.localMode);\n      state.f = state.block = local;\n      if (modeCfg.highlightFormatting) state.formatting = \"code-block\";\n      state.code = -1\n      return getType(state);\n    // SETEXT has lowest block-scope precedence after HR, so check it after\n    //  the others (code, blockquote, list...)\n    } else if (\n      // if setext set, indicates line after ---/===\n      state.setext || (\n        // line before ---/===\n        (!allowsInlineContinuation || !prevLineIsList) && !state.quote && state.list === false &&\n        !state.code && !isHr && !linkDefRE.test(stream.string) &&\n        (match = stream.lookAhead(1)) && (match = match.match(setextHeaderRE))\n      )\n    ) {\n      if ( !state.setext ) {\n        state.header = match[0].charAt(0) == '=' ? 1 : 2;\n        state.setext = state.header;\n      } else {\n        state.header = state.setext;\n        // has no effect on type so we can reset it now\n        state.setext = 0;\n        stream.skipToEnd();\n        if (modeCfg.highlightFormatting) state.formatting = \"header\";\n      }\n      state.thisLine.header = true;\n      state.f = state.inline;\n      return getType(state);\n    } else if (isHr) {\n      stream.skipToEnd();\n      state.hr = true;\n      state.thisLine.hr = true;\n      return tokenTypes.hr;\n    } else if (stream.peek() === '[') {\n      return switchInline(stream, state, footnoteLink);\n    }\n\n    return switchInline(stream, state, state.inline);\n  }\n\n  function htmlBlock(stream, state) {\n    var style = htmlMode.token(stream, state.htmlState);\n    if (!htmlModeMissing) {\n      var inner = CodeMirror.innerMode(htmlMode, state.htmlState)\n      if ((inner.mode.name == \"xml\" && inner.state.tagStart === null &&\n           (!inner.state.context && inner.state.tokenize.isInText)) ||\n          (state.md_inside && stream.current().indexOf(\">\") > -1)) {\n        state.f = inlineNormal;\n        state.block = blockNormal;\n        state.htmlState = null;\n      }\n    }\n    return style;\n  }\n\n  function local(stream, state) {\n    var currListInd = state.listStack[state.listStack.length - 1] || 0;\n    var hasExitedList = state.indentation < currListInd;\n    var maxFencedEndInd = currListInd + 3;\n    if (state.fencedEndRE && state.indentation <= maxFencedEndInd && (hasExitedList || stream.match(state.fencedEndRE))) {\n      if (modeCfg.highlightFormatting) state.formatting = \"code-block\";\n      var returnType;\n      if (!hasExitedList) returnType = getType(state)\n      state.localMode = state.localState = null;\n      state.block = blockNormal;\n      state.f = inlineNormal;\n      state.fencedEndRE = null;\n      state.code = 0\n      state.thisLine.fencedCodeEnd = true;\n      if (hasExitedList) return switchBlock(stream, state, state.block);\n      return returnType;\n    } else if (state.localMode) {\n      return state.localMode.token(stream, state.localState);\n    } else {\n      stream.skipToEnd();\n      return tokenTypes.code;\n    }\n  }\n\n  // Inline\n  function getType(state) {\n    var styles = [];\n\n    if (state.formatting) {\n      styles.push(tokenTypes.formatting);\n\n      if (typeof state.formatting === \"string\") state.formatting = [state.formatting];\n\n      for (var i = 0; i < state.formatting.length; i++) {\n        styles.push(tokenTypes.formatting + \"-\" + state.formatting[i]);\n\n        if (state.formatting[i] === \"header\") {\n          styles.push(tokenTypes.formatting + \"-\" + state.formatting[i] + \"-\" + state.header);\n        }\n\n        // Add `formatting-quote` and `formatting-quote-#` for blockquotes\n        // Add `error` instead if the maximum blockquote nesting depth is passed\n        if (state.formatting[i] === \"quote\") {\n          if (!modeCfg.maxBlockquoteDepth || modeCfg.maxBlockquoteDepth >= state.quote) {\n            styles.push(tokenTypes.formatting + \"-\" + state.formatting[i] + \"-\" + state.quote);\n          } else {\n            styles.push(\"error\");\n          }\n        }\n      }\n    }\n\n    if (state.taskOpen) {\n      styles.push(\"meta\");\n      return styles.length ? styles.join(' ') : null;\n    }\n    if (state.taskClosed) {\n      styles.push(\"property\");\n      return styles.length ? styles.join(' ') : null;\n    }\n\n    if (state.linkHref) {\n      styles.push(tokenTypes.linkHref, \"url\");\n    } else { // Only apply inline styles to non-url text\n      if (state.strong) { styles.push(tokenTypes.strong); }\n      if (state.em) { styles.push(tokenTypes.em); }\n      if (state.strikethrough) { styles.push(tokenTypes.strikethrough); }\n      if (state.emoji) { styles.push(tokenTypes.emoji); }\n      if (state.linkText) { styles.push(tokenTypes.linkText); }\n      if (state.code) { styles.push(tokenTypes.code); }\n      if (state.image) { styles.push(tokenTypes.image); }\n      if (state.imageAltText) { styles.push(tokenTypes.imageAltText, \"link\"); }\n      if (state.imageMarker) { styles.push(tokenTypes.imageMarker); }\n    }\n\n    if (state.header) { styles.push(tokenTypes.header, tokenTypes.header + \"-\" + state.header); }\n\n    if (state.quote) {\n      styles.push(tokenTypes.quote);\n\n      // Add `quote-#` where the maximum for `#` is modeCfg.maxBlockquoteDepth\n      if (!modeCfg.maxBlockquoteDepth || modeCfg.maxBlockquoteDepth >= state.quote) {\n        styles.push(tokenTypes.quote + \"-\" + state.quote);\n      } else {\n        styles.push(tokenTypes.quote + \"-\" + modeCfg.maxBlockquoteDepth);\n      }\n    }\n\n    if (state.list !== false) {\n      var listMod = (state.listStack.length - 1) % 3;\n      if (!listMod) {\n        styles.push(tokenTypes.list1);\n      } else if (listMod === 1) {\n        styles.push(tokenTypes.list2);\n      } else {\n        styles.push(tokenTypes.list3);\n      }\n    }\n\n    if (state.trailingSpaceNewLine) {\n      styles.push(\"trailing-space-new-line\");\n    } else if (state.trailingSpace) {\n      styles.push(\"trailing-space-\" + (state.trailingSpace % 2 ? \"a\" : \"b\"));\n    }\n\n    return styles.length ? styles.join(' ') : null;\n  }\n\n  function handleText(stream, state) {\n    if (stream.match(textRE, true)) {\n      return getType(state);\n    }\n    return undefined;\n  }\n\n  function inlineNormal(stream, state) {\n    var style = state.text(stream, state);\n    if (typeof style !== 'undefined')\n      return style;\n\n    if (state.list) { // List marker (*, +, -, 1., etc)\n      state.list = null;\n      return getType(state);\n    }\n\n    if (state.taskList) {\n      var taskOpen = stream.match(taskListRE, true)[1] === \" \";\n      if (taskOpen) state.taskOpen = true;\n      else state.taskClosed = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"task\";\n      state.taskList = false;\n      return getType(state);\n    }\n\n    state.taskOpen = false;\n    state.taskClosed = false;\n\n    if (state.header && stream.match(/^#+$/, true)) {\n      if (modeCfg.highlightFormatting) state.formatting = \"header\";\n      return getType(state);\n    }\n\n    var ch = stream.next();\n\n    // Matches link titles present on next line\n    if (state.linkTitle) {\n      state.linkTitle = false;\n      var matchCh = ch;\n      if (ch === '(') {\n        matchCh = ')';\n      }\n      matchCh = (matchCh+'').replace(/([.?*+^\\[\\]\\\\(){}|-])/g, \"\\\\$1\");\n      var regex = '^\\\\s*(?:[^' + matchCh + '\\\\\\\\]+|\\\\\\\\\\\\\\\\|\\\\\\\\.)' + matchCh;\n      if (stream.match(new RegExp(regex), true)) {\n        return tokenTypes.linkHref;\n      }\n    }\n\n    // If this block is changed, it may need to be updated in GFM mode\n    if (ch === '`') {\n      var previousFormatting = state.formatting;\n      if (modeCfg.highlightFormatting) state.formatting = \"code\";\n      stream.eatWhile('`');\n      var count = stream.current().length\n      if (state.code == 0 && (!state.quote || count == 1)) {\n        state.code = count\n        return getType(state)\n      } else if (count == state.code) { // Must be exact\n        var t = getType(state)\n        state.code = 0\n        return t\n      } else {\n        state.formatting = previousFormatting\n        return getType(state)\n      }\n    } else if (state.code) {\n      return getType(state);\n    }\n\n    if (ch === '\\\\') {\n      stream.next();\n      if (modeCfg.highlightFormatting) {\n        var type = getType(state);\n        var formattingEscape = tokenTypes.formatting + \"-escape\";\n        return type ? type + \" \" + formattingEscape : formattingEscape;\n      }\n    }\n\n    if (ch === '!' && stream.match(/\\[[^\\]]*\\] ?(?:\\(|\\[)/, false)) {\n      state.imageMarker = true;\n      state.image = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"image\";\n      return getType(state);\n    }\n\n    if (ch === '[' && state.imageMarker && stream.match(/[^\\]]*\\](\\(.*?\\)| ?\\[.*?\\])/, false)) {\n      state.imageMarker = false;\n      state.imageAltText = true\n      if (modeCfg.highlightFormatting) state.formatting = \"image\";\n      return getType(state);\n    }\n\n    if (ch === ']' && state.imageAltText) {\n      if (modeCfg.highlightFormatting) state.formatting = \"image\";\n      var type = getType(state);\n      state.imageAltText = false;\n      state.image = false;\n      state.inline = state.f = linkHref;\n      return type;\n    }\n\n    if (ch === '[' && !state.image) {\n      if (state.linkText && stream.match(/^.*?\\]/)) return getType(state)\n      state.linkText = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      return getType(state);\n    }\n\n    if (ch === ']' && state.linkText) {\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      state.linkText = false;\n      state.inline = state.f = stream.match(/\\(.*?\\)| ?\\[.*?\\]/, false) ? linkHref : inlineNormal\n      return type;\n    }\n\n    if (ch === '<' && stream.match(/^(https?|ftps?):\\/\\/(?:[^\\\\>]|\\\\.)+>/, false)) {\n      state.f = state.inline = linkInline;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      if (type){\n        type += \" \";\n      } else {\n        type = \"\";\n      }\n      return type + tokenTypes.linkInline;\n    }\n\n    if (ch === '<' && stream.match(/^[^> \\\\]+@(?:[^\\\\>]|\\\\.)+>/, false)) {\n      state.f = state.inline = linkInline;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      if (type){\n        type += \" \";\n      } else {\n        type = \"\";\n      }\n      return type + tokenTypes.linkEmail;\n    }\n\n    if (modeCfg.xml && ch === '<' && stream.match(/^(!--|\\?|!\\[CDATA\\[|[a-z][a-z0-9-]*(?:\\s+[a-z_:.\\-]+(?:\\s*=\\s*[^>]+)?)*\\s*(?:>|$))/i, false)) {\n      var end = stream.string.indexOf(\">\", stream.pos);\n      if (end != -1) {\n        var atts = stream.string.substring(stream.start, end);\n        if (/markdown\\s*=\\s*('|\"){0,1}1('|\"){0,1}/.test(atts)) state.md_inside = true;\n      }\n      stream.backUp(1);\n      state.htmlState = CodeMirror.startState(htmlMode);\n      return switchBlock(stream, state, htmlBlock);\n    }\n\n    if (modeCfg.xml && ch === '<' && stream.match(/^\\/\\w*?>/)) {\n      state.md_inside = false;\n      return \"tag\";\n    } else if (ch === \"*\" || ch === \"_\") {\n      var len = 1, before = stream.pos == 1 ? \" \" : stream.string.charAt(stream.pos - 2)\n      while (len < 3 && stream.eat(ch)) len++\n      var after = stream.peek() || \" \"\n      // See http://spec.commonmark.org/0.27/#emphasis-and-strong-emphasis\n      var leftFlanking = !/\\s/.test(after) && (!punctuation.test(after) || /\\s/.test(before) || punctuation.test(before))\n      var rightFlanking = !/\\s/.test(before) && (!punctuation.test(before) || /\\s/.test(after) || punctuation.test(after))\n      var setEm = null, setStrong = null\n      if (len % 2) { // Em\n        if (!state.em && leftFlanking && (ch === \"*\" || !rightFlanking || punctuation.test(before)))\n          setEm = true\n        else if (state.em == ch && rightFlanking && (ch === \"*\" || !leftFlanking || punctuation.test(after)))\n          setEm = false\n      }\n      if (len > 1) { // Strong\n        if (!state.strong && leftFlanking && (ch === \"*\" || !rightFlanking || punctuation.test(before)))\n          setStrong = true\n        else if (state.strong == ch && rightFlanking && (ch === \"*\" || !leftFlanking || punctuation.test(after)))\n          setStrong = false\n      }\n      if (setStrong != null || setEm != null) {\n        if (modeCfg.highlightFormatting) state.formatting = setEm == null ? \"strong\" : setStrong == null ? \"em\" : \"strong em\"\n        if (setEm === true) state.em = ch\n        if (setStrong === true) state.strong = ch\n        var t = getType(state)\n        if (setEm === false) state.em = false\n        if (setStrong === false) state.strong = false\n        return t\n      }\n    } else if (ch === ' ') {\n      if (stream.eat('*') || stream.eat('_')) { // Probably surrounded by spaces\n        if (stream.peek() === ' ') { // Surrounded by spaces, ignore\n          return getType(state);\n        } else { // Not surrounded by spaces, back up pointer\n          stream.backUp(1);\n        }\n      }\n    }\n\n    if (modeCfg.strikethrough) {\n      if (ch === '~' && stream.eatWhile(ch)) {\n        if (state.strikethrough) {// Remove strikethrough\n          if (modeCfg.highlightFormatting) state.formatting = \"strikethrough\";\n          var t = getType(state);\n          state.strikethrough = false;\n          return t;\n        } else if (stream.match(/^[^\\s]/, false)) {// Add strikethrough\n          state.strikethrough = true;\n          if (modeCfg.highlightFormatting) state.formatting = \"strikethrough\";\n          return getType(state);\n        }\n      } else if (ch === ' ') {\n        if (stream.match(/^~~/, true)) { // Probably surrounded by space\n          if (stream.peek() === ' ') { // Surrounded by spaces, ignore\n            return getType(state);\n          } else { // Not surrounded by spaces, back up pointer\n            stream.backUp(2);\n          }\n        }\n      }\n    }\n\n    if (modeCfg.emoji && ch === \":\" && stream.match(/^(?:[a-z_\\d+][a-z_\\d+-]*|\\-[a-z_\\d+][a-z_\\d+-]*):/)) {\n      state.emoji = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"emoji\";\n      var retType = getType(state);\n      state.emoji = false;\n      return retType;\n    }\n\n    if (ch === ' ') {\n      if (stream.match(/^ +$/, false)) {\n        state.trailingSpace++;\n      } else if (state.trailingSpace) {\n        state.trailingSpaceNewLine = true;\n      }\n    }\n\n    return getType(state);\n  }\n\n  function linkInline(stream, state) {\n    var ch = stream.next();\n\n    if (ch === \">\") {\n      state.f = state.inline = inlineNormal;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      if (type){\n        type += \" \";\n      } else {\n        type = \"\";\n      }\n      return type + tokenTypes.linkInline;\n    }\n\n    stream.match(/^[^>]+/, true);\n\n    return tokenTypes.linkInline;\n  }\n\n  function linkHref(stream, state) {\n    // Check if space, and return NULL if so (to avoid marking the space)\n    if(stream.eatSpace()){\n      return null;\n    }\n    var ch = stream.next();\n    if (ch === '(' || ch === '[') {\n      state.f = state.inline = getLinkHrefInside(ch === \"(\" ? \")\" : \"]\");\n      if (modeCfg.highlightFormatting) state.formatting = \"link-string\";\n      state.linkHref = true;\n      return getType(state);\n    }\n    return 'error';\n  }\n\n  var linkRE = {\n    \")\": /^(?:[^\\\\\\(\\)]|\\\\.|\\((?:[^\\\\\\(\\)]|\\\\.)*\\))*?(?=\\))/,\n    \"]\": /^(?:[^\\\\\\[\\]]|\\\\.|\\[(?:[^\\\\\\[\\]]|\\\\.)*\\])*?(?=\\])/\n  }\n\n  function getLinkHrefInside(endChar) {\n    return function(stream, state) {\n      var ch = stream.next();\n\n      if (ch === endChar) {\n        state.f = state.inline = inlineNormal;\n        if (modeCfg.highlightFormatting) state.formatting = \"link-string\";\n        var returnState = getType(state);\n        state.linkHref = false;\n        return returnState;\n      }\n\n      stream.match(linkRE[endChar])\n      state.linkHref = true;\n      return getType(state);\n    };\n  }\n\n  function footnoteLink(stream, state) {\n    if (stream.match(/^([^\\]\\\\]|\\\\.)*\\]:/, false)) {\n      state.f = footnoteLinkInside;\n      stream.next(); // Consume [\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      state.linkText = true;\n      return getType(state);\n    }\n    return switchInline(stream, state, inlineNormal);\n  }\n\n  function footnoteLinkInside(stream, state) {\n    if (stream.match(/^\\]:/, true)) {\n      state.f = state.inline = footnoteUrl;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var returnType = getType(state);\n      state.linkText = false;\n      return returnType;\n    }\n\n    stream.match(/^([^\\]\\\\]|\\\\.)+/, true);\n\n    return tokenTypes.linkText;\n  }\n\n  function footnoteUrl(stream, state) {\n    // Check if space, and return NULL if so (to avoid marking the space)\n    if(stream.eatSpace()){\n      return null;\n    }\n    // Match URL\n    stream.match(/^[^\\s]+/, true);\n    // Check for link title\n    if (stream.peek() === undefined) { // End of line, set flag to check next line\n      state.linkTitle = true;\n    } else { // More content on line, check if link title\n      stream.match(/^(?:\\s+(?:\"(?:[^\"\\\\]|\\\\\\\\|\\\\.)+\"|'(?:[^'\\\\]|\\\\\\\\|\\\\.)+'|\\((?:[^)\\\\]|\\\\\\\\|\\\\.)+\\)))?/, true);\n    }\n    state.f = state.inline = inlineNormal;\n    return tokenTypes.linkHref + \" url\";\n  }\n\n  var mode = {\n    startState: function() {\n      return {\n        f: blockNormal,\n\n        prevLine: {stream: null},\n        thisLine: {stream: null},\n\n        block: blockNormal,\n        htmlState: null,\n        indentation: 0,\n\n        inline: inlineNormal,\n        text: handleText,\n\n        formatting: false,\n        linkText: false,\n        linkHref: false,\n        linkTitle: false,\n        code: 0,\n        em: false,\n        strong: false,\n        header: 0,\n        setext: 0,\n        hr: false,\n        taskList: false,\n        list: false,\n        listStack: [],\n        quote: 0,\n        trailingSpace: 0,\n        trailingSpaceNewLine: false,\n        strikethrough: false,\n        emoji: false,\n        fencedEndRE: null\n      };\n    },\n\n    copyState: function(s) {\n      return {\n        f: s.f,\n\n        prevLine: s.prevLine,\n        thisLine: s.thisLine,\n\n        block: s.block,\n        htmlState: s.htmlState && CodeMirror.copyState(htmlMode, s.htmlState),\n        indentation: s.indentation,\n\n        localMode: s.localMode,\n        localState: s.localMode ? CodeMirror.copyState(s.localMode, s.localState) : null,\n\n        inline: s.inline,\n        text: s.text,\n        formatting: false,\n        linkText: s.linkText,\n        linkTitle: s.linkTitle,\n        linkHref: s.linkHref,\n        code: s.code,\n        em: s.em,\n        strong: s.strong,\n        strikethrough: s.strikethrough,\n        emoji: s.emoji,\n        header: s.header,\n        setext: s.setext,\n        hr: s.hr,\n        taskList: s.taskList,\n        list: s.list,\n        listStack: s.listStack.slice(0),\n        quote: s.quote,\n        indentedCode: s.indentedCode,\n        trailingSpace: s.trailingSpace,\n        trailingSpaceNewLine: s.trailingSpaceNewLine,\n        md_inside: s.md_inside,\n        fencedEndRE: s.fencedEndRE\n      };\n    },\n\n    token: function(stream, state) {\n\n      // Reset state.formatting\n      state.formatting = false;\n\n      if (stream != state.thisLine.stream) {\n        state.header = 0;\n        state.hr = false;\n\n        if (stream.match(/^\\s*$/, true)) {\n          blankLine(state);\n          return null;\n        }\n\n        state.prevLine = state.thisLine\n        state.thisLine = {stream: stream}\n\n        // Reset state.taskList\n        state.taskList = false;\n\n        // Reset state.trailingSpace\n        state.trailingSpace = 0;\n        state.trailingSpaceNewLine = false;\n\n        if (!state.localState) {\n          state.f = state.block;\n          if (state.f != htmlBlock) {\n            var indentation = stream.match(/^\\s*/, true)[0].replace(/\\t/g, expandedTab).length;\n            state.indentation = indentation;\n            state.indentationDiff = null;\n            if (indentation > 0) return null;\n          }\n        }\n      }\n      return state.f(stream, state);\n    },\n\n    innerMode: function(state) {\n      if (state.block == htmlBlock) return {state: state.htmlState, mode: htmlMode};\n      if (state.localState) return {state: state.localState, mode: state.localMode};\n      return {state: state, mode: mode};\n    },\n\n    indent: function(state, textAfter, line) {\n      if (state.block == htmlBlock && htmlMode.indent) return htmlMode.indent(state.htmlState, textAfter, line)\n      if (state.localState && state.localMode.indent) return state.localMode.indent(state.localState, textAfter, line)\n      return CodeMirror.Pass\n    },\n\n    blankLine: blankLine,\n\n    getType: getType,\n\n    blockCommentStart: \"<!--\",\n    blockCommentEnd: \"-->\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n    fold: \"markdown\"\n  };\n  return mode;\n}, \"xml\");\n\nCodeMirror.defineMIME(\"text/markdown\", \"markdown\");\n\nCodeMirror.defineMIME(\"text/x-markdown\", \"markdown\");\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.modeInfo = [\n    {name: \"APL\", mime: \"text/apl\", mode: \"apl\", ext: [\"dyalog\", \"apl\"]},\n    {name: \"PGP\", mimes: [\"application/pgp\", \"application/pgp-encrypted\", \"application/pgp-keys\", \"application/pgp-signature\"], mode: \"asciiarmor\", ext: [\"asc\", \"pgp\", \"sig\"]},\n    {name: \"ASN.1\", mime: \"text/x-ttcn-asn\", mode: \"asn.1\", ext: [\"asn\", \"asn1\"]},\n    {name: \"Asterisk\", mime: \"text/x-asterisk\", mode: \"asterisk\", file: /^extensions\\.conf$/i},\n    {name: \"Brainfuck\", mime: \"text/x-brainfuck\", mode: \"brainfuck\", ext: [\"b\", \"bf\"]},\n    {name: \"C\", mime: \"text/x-csrc\", mode: \"clike\", ext: [\"c\", \"h\", \"ino\"]},\n    {name: \"C++\", mime: \"text/x-c++src\", mode: \"clike\", ext: [\"cpp\", \"c++\", \"cc\", \"cxx\", \"hpp\", \"h++\", \"hh\", \"hxx\"], alias: [\"cpp\"]},\n    {name: \"Cobol\", mime: \"text/x-cobol\", mode: \"cobol\", ext: [\"cob\", \"cpy\"]},\n    {name: \"C#\", mime: \"text/x-csharp\", mode: \"clike\", ext: [\"cs\"], alias: [\"csharp\", \"cs\"]},\n    {name: \"Clojure\", mime: \"text/x-clojure\", mode: \"clojure\", ext: [\"clj\", \"cljc\", \"cljx\"]},\n    {name: \"ClojureScript\", mime: \"text/x-clojurescript\", mode: \"clojure\", ext: [\"cljs\"]},\n    {name: \"Closure Stylesheets (GSS)\", mime: \"text/x-gss\", mode: \"css\", ext: [\"gss\"]},\n    {name: \"CMake\", mime: \"text/x-cmake\", mode: \"cmake\", ext: [\"cmake\", \"cmake.in\"], file: /^CMakeLists.txt$/},\n    {name: \"CoffeeScript\", mimes: [\"application/vnd.coffeescript\", \"text/coffeescript\", \"text/x-coffeescript\"], mode: \"coffeescript\", ext: [\"coffee\"], alias: [\"coffee\", \"coffee-script\"]},\n    {name: \"Common Lisp\", mime: \"text/x-common-lisp\", mode: \"commonlisp\", ext: [\"cl\", \"lisp\", \"el\"], alias: [\"lisp\"]},\n    {name: \"Cypher\", mime: \"application/x-cypher-query\", mode: \"cypher\", ext: [\"cyp\", \"cypher\"]},\n    {name: \"Cython\", mime: \"text/x-cython\", mode: \"python\", ext: [\"pyx\", \"pxd\", \"pxi\"]},\n    {name: \"Crystal\", mime: \"text/x-crystal\", mode: \"crystal\", ext: [\"cr\"]},\n    {name: \"CSS\", mime: \"text/css\", mode: \"css\", ext: [\"css\"]},\n    {name: \"CQL\", mime: \"text/x-cassandra\", mode: \"sql\", ext: [\"cql\"]},\n    {name: \"D\", mime: \"text/x-d\", mode: \"d\", ext: [\"d\"]},\n    {name: \"Dart\", mimes: [\"application/dart\", \"text/x-dart\"], mode: \"dart\", ext: [\"dart\"]},\n    {name: \"diff\", mime: \"text/x-diff\", mode: \"diff\", ext: [\"diff\", \"patch\"]},\n    {name: \"Django\", mime: \"text/x-django\", mode: \"django\"},\n    {name: \"Dockerfile\", mime: \"text/x-dockerfile\", mode: \"dockerfile\", file: /^Dockerfile$/},\n    {name: \"DTD\", mime: \"application/xml-dtd\", mode: \"dtd\", ext: [\"dtd\"]},\n    {name: \"Dylan\", mime: \"text/x-dylan\", mode: \"dylan\", ext: [\"dylan\", \"dyl\", \"intr\"]},\n    {name: \"EBNF\", mime: \"text/x-ebnf\", mode: \"ebnf\"},\n    {name: \"ECL\", mime: \"text/x-ecl\", mode: \"ecl\", ext: [\"ecl\"]},\n    {name: \"edn\", mime: \"application/edn\", mode: \"clojure\", ext: [\"edn\"]},\n    {name: \"Eiffel\", mime: \"text/x-eiffel\", mode: \"eiffel\", ext: [\"e\"]},\n    {name: \"Elm\", mime: \"text/x-elm\", mode: \"elm\", ext: [\"elm\"]},\n    {name: \"Embedded Javascript\", mime: \"application/x-ejs\", mode: \"htmlembedded\", ext: [\"ejs\"]},\n    {name: \"Embedded Ruby\", mime: \"application/x-erb\", mode: \"htmlembedded\", ext: [\"erb\"]},\n    {name: \"Erlang\", mime: \"text/x-erlang\", mode: \"erlang\", ext: [\"erl\"]},\n    {name: \"Esper\", mime: \"text/x-esper\", mode: \"sql\"},\n    {name: \"Factor\", mime: \"text/x-factor\", mode: \"factor\", ext: [\"factor\"]},\n    {name: \"FCL\", mime: \"text/x-fcl\", mode: \"fcl\"},\n    {name: \"Forth\", mime: \"text/x-forth\", mode: \"forth\", ext: [\"forth\", \"fth\", \"4th\"]},\n    {name: \"Fortran\", mime: \"text/x-fortran\", mode: \"fortran\", ext: [\"f\", \"for\", \"f77\", \"f90\", \"f95\"]},\n    {name: \"F#\", mime: \"text/x-fsharp\", mode: \"mllike\", ext: [\"fs\"], alias: [\"fsharp\"]},\n    {name: \"Gas\", mime: \"text/x-gas\", mode: \"gas\", ext: [\"s\"]},\n    {name: \"Gherkin\", mime: \"text/x-feature\", mode: \"gherkin\", ext: [\"feature\"]},\n    {name: \"GitHub Flavored Markdown\", mime: \"text/x-gfm\", mode: \"gfm\", file: /^(readme|contributing|history).md$/i},\n    {name: \"Go\", mime: \"text/x-go\", mode: \"go\", ext: [\"go\"]},\n    {name: \"Groovy\", mime: \"text/x-groovy\", mode: \"groovy\", ext: [\"groovy\", \"gradle\"], file: /^Jenkinsfile$/},\n    {name: \"HAML\", mime: \"text/x-haml\", mode: \"haml\", ext: [\"haml\"]},\n    {name: \"Haskell\", mime: \"text/x-haskell\", mode: \"haskell\", ext: [\"hs\"]},\n    {name: \"Haskell (Literate)\", mime: \"text/x-literate-haskell\", mode: \"haskell-literate\", ext: [\"lhs\"]},\n    {name: \"Haxe\", mime: \"text/x-haxe\", mode: \"haxe\", ext: [\"hx\"]},\n    {name: \"HXML\", mime: \"text/x-hxml\", mode: \"haxe\", ext: [\"hxml\"]},\n    {name: \"ASP.NET\", mime: \"application/x-aspx\", mode: \"htmlembedded\", ext: [\"aspx\"], alias: [\"asp\", \"aspx\"]},\n    {name: \"HTML\", mime: \"text/html\", mode: \"htmlmixed\", ext: [\"html\", \"htm\", \"handlebars\", \"hbs\"], alias: [\"xhtml\"]},\n    {name: \"HTTP\", mime: \"message/http\", mode: \"http\"},\n    {name: \"IDL\", mime: \"text/x-idl\", mode: \"idl\", ext: [\"pro\"]},\n    {name: \"Pug\", mime: \"text/x-pug\", mode: \"pug\", ext: [\"jade\", \"pug\"], alias: [\"jade\"]},\n    {name: \"Java\", mime: \"text/x-java\", mode: \"clike\", ext: [\"java\"]},\n    {name: \"Java Server Pages\", mime: \"application/x-jsp\", mode: \"htmlembedded\", ext: [\"jsp\"], alias: [\"jsp\"]},\n    {name: \"JavaScript\", mimes: [\"text/javascript\", \"text/ecmascript\", \"application/javascript\", \"application/x-javascript\", \"application/ecmascript\"],\n     mode: \"javascript\", ext: [\"js\"], alias: [\"ecmascript\", \"js\", \"node\"]},\n    {name: \"JSON\", mimes: [\"application/json\", \"application/x-json\"], mode: \"javascript\", ext: [\"json\", \"map\"], alias: [\"json5\"]},\n    {name: \"JSON-LD\", mime: \"application/ld+json\", mode: \"javascript\", ext: [\"jsonld\"], alias: [\"jsonld\"]},\n    {name: \"JSX\", mime: \"text/jsx\", mode: \"jsx\", ext: [\"jsx\"]},\n    {name: \"Jinja2\", mime: \"text/jinja2\", mode: \"jinja2\", ext: [\"j2\", \"jinja\", \"jinja2\"]},\n    {name: \"Julia\", mime: \"text/x-julia\", mode: \"julia\", ext: [\"jl\"]},\n    {name: \"Kotlin\", mime: \"text/x-kotlin\", mode: \"clike\", ext: [\"kt\"]},\n    {name: \"LESS\", mime: \"text/x-less\", mode: \"css\", ext: [\"less\"]},\n    {name: \"LiveScript\", mime: \"text/x-livescript\", mode: \"livescript\", ext: [\"ls\"], alias: [\"ls\"]},\n    {name: \"Lua\", mime: \"text/x-lua\", mode: \"lua\", ext: [\"lua\"]},\n    {name: \"Markdown\", mime: \"text/x-markdown\", mode: \"markdown\", ext: [\"markdown\", \"md\", \"mkd\"]},\n    {name: \"mIRC\", mime: \"text/mirc\", mode: \"mirc\"},\n    {name: \"MariaDB SQL\", mime: \"text/x-mariadb\", mode: \"sql\"},\n    {name: \"Mathematica\", mime: \"text/x-mathematica\", mode: \"mathematica\", ext: [\"m\", \"nb\", \"wl\", \"wls\"]},\n    {name: \"Modelica\", mime: \"text/x-modelica\", mode: \"modelica\", ext: [\"mo\"]},\n    {name: \"MUMPS\", mime: \"text/x-mumps\", mode: \"mumps\", ext: [\"mps\"]},\n    {name: \"MS SQL\", mime: \"text/x-mssql\", mode: \"sql\"},\n    {name: \"mbox\", mime: \"application/mbox\", mode: \"mbox\", ext: [\"mbox\"]},\n    {name: \"MySQL\", mime: \"text/x-mysql\", mode: \"sql\"},\n    {name: \"Nginx\", mime: \"text/x-nginx-conf\", mode: \"nginx\", file: /nginx.*\\.conf$/i},\n    {name: \"NSIS\", mime: \"text/x-nsis\", mode: \"nsis\", ext: [\"nsh\", \"nsi\"]},\n    {name: \"NTriples\", mimes: [\"application/n-triples\", \"application/n-quads\", \"text/n-triples\"],\n     mode: \"ntriples\", ext: [\"nt\", \"nq\"]},\n    {name: \"Objective-C\", mime: \"text/x-objectivec\", mode: \"clike\", ext: [\"m\"], alias: [\"objective-c\", \"objc\"]},\n    {name: \"Objective-C++\", mime: \"text/x-objectivec++\", mode: \"clike\", ext: [\"mm\"], alias: [\"objective-c++\", \"objc++\"]},\n    {name: \"OCaml\", mime: \"text/x-ocaml\", mode: \"mllike\", ext: [\"ml\", \"mli\", \"mll\", \"mly\"]},\n    {name: \"Octave\", mime: \"text/x-octave\", mode: \"octave\", ext: [\"m\"]},\n    {name: \"Oz\", mime: \"text/x-oz\", mode: \"oz\", ext: [\"oz\"]},\n    {name: \"Pascal\", mime: \"text/x-pascal\", mode: \"pascal\", ext: [\"p\", \"pas\"]},\n    {name: \"PEG.js\", mime: \"null\", mode: \"pegjs\", ext: [\"jsonld\"]},\n    {name: \"Perl\", mime: \"text/x-perl\", mode: \"perl\", ext: [\"pl\", \"pm\"]},\n    {name: \"PHP\", mimes: [\"text/x-php\", \"application/x-httpd-php\", \"application/x-httpd-php-open\"], mode: \"php\", ext: [\"php\", \"php3\", \"php4\", \"php5\", \"php7\", \"phtml\"]},\n    {name: \"Pig\", mime: \"text/x-pig\", mode: \"pig\", ext: [\"pig\"]},\n    {name: \"Plain Text\", mime: \"text/plain\", mode: \"null\", ext: [\"txt\", \"text\", \"conf\", \"def\", \"list\", \"log\"]},\n    {name: \"PLSQL\", mime: \"text/x-plsql\", mode: \"sql\", ext: [\"pls\"]},\n    {name: \"PostgreSQL\", mime: \"text/x-pgsql\", mode: \"sql\"},\n    {name: \"PowerShell\", mime: \"application/x-powershell\", mode: \"powershell\", ext: [\"ps1\", \"psd1\", \"psm1\"]},\n    {name: \"Properties files\", mime: \"text/x-properties\", mode: \"properties\", ext: [\"properties\", \"ini\", \"in\"], alias: [\"ini\", \"properties\"]},\n    {name: \"ProtoBuf\", mime: \"text/x-protobuf\", mode: \"protobuf\", ext: [\"proto\"]},\n    {name: \"Python\", mime: \"text/x-python\", mode: \"python\", ext: [\"BUILD\", \"bzl\", \"py\", \"pyw\"], file: /^(BUCK|BUILD)$/},\n    {name: \"Puppet\", mime: \"text/x-puppet\", mode: \"puppet\", ext: [\"pp\"]},\n    {name: \"Q\", mime: \"text/x-q\", mode: \"q\", ext: [\"q\"]},\n    {name: \"R\", mime: \"text/x-rsrc\", mode: \"r\", ext: [\"r\", \"R\"], alias: [\"rscript\"]},\n    {name: \"reStructuredText\", mime: \"text/x-rst\", mode: \"rst\", ext: [\"rst\"], alias: [\"rst\"]},\n    {name: \"RPM Changes\", mime: \"text/x-rpm-changes\", mode: \"rpm\"},\n    {name: \"RPM Spec\", mime: \"text/x-rpm-spec\", mode: \"rpm\", ext: [\"spec\"]},\n    {name: \"Ruby\", mime: \"text/x-ruby\", mode: \"ruby\", ext: [\"rb\"], alias: [\"jruby\", \"macruby\", \"rake\", \"rb\", \"rbx\"]},\n    {name: \"Rust\", mime: \"text/x-rustsrc\", mode: \"rust\", ext: [\"rs\"]},\n    {name: \"SAS\", mime: \"text/x-sas\", mode: \"sas\", ext: [\"sas\"]},\n    {name: \"Sass\", mime: \"text/x-sass\", mode: \"sass\", ext: [\"sass\"]},\n    {name: \"Scala\", mime: \"text/x-scala\", mode: \"clike\", ext: [\"scala\"]},\n    {name: \"Scheme\", mime: \"text/x-scheme\", mode: \"scheme\", ext: [\"scm\", \"ss\"]},\n    {name: \"SCSS\", mime: \"text/x-scss\", mode: \"css\", ext: [\"scss\"]},\n    {name: \"Shell\", mimes: [\"text/x-sh\", \"application/x-sh\"], mode: \"shell\", ext: [\"sh\", \"ksh\", \"bash\"], alias: [\"bash\", \"sh\", \"zsh\"], file: /^PKGBUILD$/},\n    {name: \"Sieve\", mime: \"application/sieve\", mode: \"sieve\", ext: [\"siv\", \"sieve\"]},\n    {name: \"Slim\", mimes: [\"text/x-slim\", \"application/x-slim\"], mode: \"slim\", ext: [\"slim\"]},\n    {name: \"Smalltalk\", mime: \"text/x-stsrc\", mode: \"smalltalk\", ext: [\"st\"]},\n    {name: \"Smarty\", mime: \"text/x-smarty\", mode: \"smarty\", ext: [\"tpl\"]},\n    {name: \"Solr\", mime: \"text/x-solr\", mode: \"solr\"},\n    {name: \"SML\", mime: \"text/x-sml\", mode: \"mllike\", ext: [\"sml\", \"sig\", \"fun\", \"smackspec\"]},\n    {name: \"Soy\", mime: \"text/x-soy\", mode: \"soy\", ext: [\"soy\"], alias: [\"closure template\"]},\n    {name: \"SPARQL\", mime: \"application/sparql-query\", mode: \"sparql\", ext: [\"rq\", \"sparql\"], alias: [\"sparul\"]},\n    {name: \"Spreadsheet\", mime: \"text/x-spreadsheet\", mode: \"spreadsheet\", alias: [\"excel\", \"formula\"]},\n    {name: \"SQL\", mime: \"text/x-sql\", mode: \"sql\", ext: [\"sql\"]},\n    {name: \"SQLite\", mime: \"text/x-sqlite\", mode: \"sql\"},\n    {name: \"Squirrel\", mime: \"text/x-squirrel\", mode: \"clike\", ext: [\"nut\"]},\n    {name: \"Stylus\", mime: \"text/x-styl\", mode: \"stylus\", ext: [\"styl\"]},\n    {name: \"Swift\", mime: \"text/x-swift\", mode: \"swift\", ext: [\"swift\"]},\n    {name: \"sTeX\", mime: \"text/x-stex\", mode: \"stex\"},\n    {name: \"LaTeX\", mime: \"text/x-latex\", mode: \"stex\", ext: [\"text\", \"ltx\", \"tex\"], alias: [\"tex\"]},\n    {name: \"SystemVerilog\", mime: \"text/x-systemverilog\", mode: \"verilog\", ext: [\"v\", \"sv\", \"svh\"]},\n    {name: \"Tcl\", mime: \"text/x-tcl\", mode: \"tcl\", ext: [\"tcl\"]},\n    {name: \"Textile\", mime: \"text/x-textile\", mode: \"textile\", ext: [\"textile\"]},\n    {name: \"TiddlyWiki\", mime: \"text/x-tiddlywiki\", mode: \"tiddlywiki\"},\n    {name: \"Tiki wiki\", mime: \"text/tiki\", mode: \"tiki\"},\n    {name: \"TOML\", mime: \"text/x-toml\", mode: \"toml\", ext: [\"toml\"]},\n    {name: \"Tornado\", mime: \"text/x-tornado\", mode: \"tornado\"},\n    {name: \"troff\", mime: \"text/troff\", mode: \"troff\", ext: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"]},\n    {name: \"TTCN\", mime: \"text/x-ttcn\", mode: \"ttcn\", ext: [\"ttcn\", \"ttcn3\", \"ttcnpp\"]},\n    {name: \"TTCN_CFG\", mime: \"text/x-ttcn-cfg\", mode: \"ttcn-cfg\", ext: [\"cfg\"]},\n    {name: \"Turtle\", mime: \"text/turtle\", mode: \"turtle\", ext: [\"ttl\"]},\n    {name: \"TypeScript\", mime: \"application/typescript\", mode: \"javascript\", ext: [\"ts\"], alias: [\"ts\"]},\n    {name: \"TypeScript-JSX\", mime: \"text/typescript-jsx\", mode: \"jsx\", ext: [\"tsx\"], alias: [\"tsx\"]},\n    {name: \"Twig\", mime: \"text/x-twig\", mode: \"twig\"},\n    {name: \"Web IDL\", mime: \"text/x-webidl\", mode: \"webidl\", ext: [\"webidl\"]},\n    {name: \"VB.NET\", mime: \"text/x-vb\", mode: \"vb\", ext: [\"vb\"]},\n    {name: \"VBScript\", mime: \"text/vbscript\", mode: \"vbscript\", ext: [\"vbs\"]},\n    {name: \"Velocity\", mime: \"text/velocity\", mode: \"velocity\", ext: [\"vtl\"]},\n    {name: \"Verilog\", mime: \"text/x-verilog\", mode: \"verilog\", ext: [\"v\"]},\n    {name: \"VHDL\", mime: \"text/x-vhdl\", mode: \"vhdl\", ext: [\"vhd\", \"vhdl\"]},\n    {name: \"Vue.js Component\", mimes: [\"script/x-vue\", \"text/x-vue\"], mode: \"vue\", ext: [\"vue\"]},\n    {name: \"XML\", mimes: [\"application/xml\", \"text/xml\"], mode: \"xml\", ext: [\"xml\", \"xsl\", \"xsd\", \"svg\"], alias: [\"rss\", \"wsdl\", \"xsd\"]},\n    {name: \"XQuery\", mime: \"application/xquery\", mode: \"xquery\", ext: [\"xy\", \"xquery\"]},\n    {name: \"Yacas\", mime: \"text/x-yacas\", mode: \"yacas\", ext: [\"ys\"]},\n    {name: \"YAML\", mimes: [\"text/x-yaml\", \"text/yaml\"], mode: \"yaml\", ext: [\"yaml\", \"yml\"], alias: [\"yml\"]},\n    {name: \"Z80\", mime: \"text/x-z80\", mode: \"z80\", ext: [\"z80\"]},\n    {name: \"mscgen\", mime: \"text/x-mscgen\", mode: \"mscgen\", ext: [\"mscgen\", \"mscin\", \"msc\"]},\n    {name: \"xu\", mime: \"text/x-xu\", mode: \"mscgen\", ext: [\"xu\"]},\n    {name: \"msgenny\", mime: \"text/x-msgenny\", mode: \"mscgen\", ext: [\"msgenny\"]}\n  ];\n  // Ensure all modes have a mime property for backwards compatibility\n  for (var i = 0; i < CodeMirror.modeInfo.length; i++) {\n    var info = CodeMirror.modeInfo[i];\n    if (info.mimes) info.mime = info.mimes[0];\n  }\n\n  CodeMirror.findModeByMIME = function(mime) {\n    mime = mime.toLowerCase();\n    for (var i = 0; i < CodeMirror.modeInfo.length; i++) {\n      var info = CodeMirror.modeInfo[i];\n      if (info.mime == mime) return info;\n      if (info.mimes) for (var j = 0; j < info.mimes.length; j++)\n        if (info.mimes[j] == mime) return info;\n    }\n    if (/\\+xml$/.test(mime)) return CodeMirror.findModeByMIME(\"application/xml\")\n    if (/\\+json$/.test(mime)) return CodeMirror.findModeByMIME(\"application/json\")\n  };\n\n  CodeMirror.findModeByExtension = function(ext) {\n    ext = ext.toLowerCase();\n    for (var i = 0; i < CodeMirror.modeInfo.length; i++) {\n      var info = CodeMirror.modeInfo[i];\n      if (info.ext) for (var j = 0; j < info.ext.length; j++)\n        if (info.ext[j] == ext) return info;\n    }\n  };\n\n  CodeMirror.findModeByFileName = function(filename) {\n    for (var i = 0; i < CodeMirror.modeInfo.length; i++) {\n      var info = CodeMirror.modeInfo[i];\n      if (info.file && info.file.test(filename)) return info;\n    }\n    var dot = filename.lastIndexOf(\".\");\n    var ext = dot > -1 && filename.substring(dot + 1, filename.length);\n    if (ext) return CodeMirror.findModeByExtension(ext);\n  };\n\n  CodeMirror.findModeByName = function(name) {\n    name = name.toLowerCase();\n    for (var i = 0; i < CodeMirror.modeInfo.length; i++) {\n      var info = CodeMirror.modeInfo[i];\n      if (info.name.toLowerCase() == name) return info;\n      if (info.alias) for (var j = 0; j < info.alias.length; j++)\n        if (info.alias[j].toLowerCase() == name) return info;\n    }\n  };\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nvar htmlConfig = {\n  autoSelfClosers: {'area': true, 'base': true, 'br': true, 'col': true, 'command': true,\n                    'embed': true, 'frame': true, 'hr': true, 'img': true, 'input': true,\n                    'keygen': true, 'link': true, 'meta': true, 'param': true, 'source': true,\n                    'track': true, 'wbr': true, 'menuitem': true},\n  implicitlyClosed: {'dd': true, 'li': true, 'optgroup': true, 'option': true, 'p': true,\n                     'rp': true, 'rt': true, 'tbody': true, 'td': true, 'tfoot': true,\n                     'th': true, 'tr': true},\n  contextGrabbers: {\n    'dd': {'dd': true, 'dt': true},\n    'dt': {'dd': true, 'dt': true},\n    'li': {'li': true},\n    'option': {'option': true, 'optgroup': true},\n    'optgroup': {'optgroup': true},\n    'p': {'address': true, 'article': true, 'aside': true, 'blockquote': true, 'dir': true,\n          'div': true, 'dl': true, 'fieldset': true, 'footer': true, 'form': true,\n          'h1': true, 'h2': true, 'h3': true, 'h4': true, 'h5': true, 'h6': true,\n          'header': true, 'hgroup': true, 'hr': true, 'menu': true, 'nav': true, 'ol': true,\n          'p': true, 'pre': true, 'section': true, 'table': true, 'ul': true},\n    'rp': {'rp': true, 'rt': true},\n    'rt': {'rp': true, 'rt': true},\n    'tbody': {'tbody': true, 'tfoot': true},\n    'td': {'td': true, 'th': true},\n    'tfoot': {'tbody': true},\n    'th': {'td': true, 'th': true},\n    'thead': {'tbody': true, 'tfoot': true},\n    'tr': {'tr': true}\n  },\n  doNotIndent: {\"pre\": true},\n  allowUnquoted: true,\n  allowMissing: true,\n  caseFold: true\n}\n\nvar xmlConfig = {\n  autoSelfClosers: {},\n  implicitlyClosed: {},\n  contextGrabbers: {},\n  doNotIndent: {},\n  allowUnquoted: false,\n  allowMissing: false,\n  allowMissingTagName: false,\n  caseFold: false\n}\n\nCodeMirror.defineMode(\"xml\", function(editorConf, config_) {\n  var indentUnit = editorConf.indentUnit\n  var config = {}\n  var defaults = config_.htmlMode ? htmlConfig : xmlConfig\n  for (var prop in defaults) config[prop] = defaults[prop]\n  for (var prop in config_) config[prop] = config_[prop]\n\n  // Return variables for tokenizers\n  var type, setStyle;\n\n  function inText(stream, state) {\n    function chain(parser) {\n      state.tokenize = parser;\n      return parser(stream, state);\n    }\n\n    var ch = stream.next();\n    if (ch == \"<\") {\n      if (stream.eat(\"!\")) {\n        if (stream.eat(\"[\")) {\n          if (stream.match(\"CDATA[\")) return chain(inBlock(\"atom\", \"]]>\"));\n          else return null;\n        } else if (stream.match(\"--\")) {\n          return chain(inBlock(\"comment\", \"-->\"));\n        } else if (stream.match(\"DOCTYPE\", true, true)) {\n          stream.eatWhile(/[\\w\\._\\-]/);\n          return chain(doctype(1));\n        } else {\n          return null;\n        }\n      } else if (stream.eat(\"?\")) {\n        stream.eatWhile(/[\\w\\._\\-]/);\n        state.tokenize = inBlock(\"meta\", \"?>\");\n        return \"meta\";\n      } else {\n        type = stream.eat(\"/\") ? \"closeTag\" : \"openTag\";\n        state.tokenize = inTag;\n        return \"tag bracket\";\n      }\n    } else if (ch == \"&\") {\n      var ok;\n      if (stream.eat(\"#\")) {\n        if (stream.eat(\"x\")) {\n          ok = stream.eatWhile(/[a-fA-F\\d]/) && stream.eat(\";\");\n        } else {\n          ok = stream.eatWhile(/[\\d]/) && stream.eat(\";\");\n        }\n      } else {\n        ok = stream.eatWhile(/[\\w\\.\\-:]/) && stream.eat(\";\");\n      }\n      return ok ? \"atom\" : \"error\";\n    } else {\n      stream.eatWhile(/[^&<]/);\n      return null;\n    }\n  }\n  inText.isInText = true;\n\n  function inTag(stream, state) {\n    var ch = stream.next();\n    if (ch == \">\" || (ch == \"/\" && stream.eat(\">\"))) {\n      state.tokenize = inText;\n      type = ch == \">\" ? \"endTag\" : \"selfcloseTag\";\n      return \"tag bracket\";\n    } else if (ch == \"=\") {\n      type = \"equals\";\n      return null;\n    } else if (ch == \"<\") {\n      state.tokenize = inText;\n      state.state = baseState;\n      state.tagName = state.tagStart = null;\n      var next = state.tokenize(stream, state);\n      return next ? next + \" tag error\" : \"tag error\";\n    } else if (/[\\'\\\"]/.test(ch)) {\n      state.tokenize = inAttribute(ch);\n      state.stringStartCol = stream.column();\n      return state.tokenize(stream, state);\n    } else {\n      stream.match(/^[^\\s\\u00a0=<>\\\"\\']*[^\\s\\u00a0=<>\\\"\\'\\/]/);\n      return \"word\";\n    }\n  }\n\n  function inAttribute(quote) {\n    var closure = function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.next() == quote) {\n          state.tokenize = inTag;\n          break;\n        }\n      }\n      return \"string\";\n    };\n    closure.isInAttribute = true;\n    return closure;\n  }\n\n  function inBlock(style, terminator) {\n    return function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.match(terminator)) {\n          state.tokenize = inText;\n          break;\n        }\n        stream.next();\n      }\n      return style;\n    }\n  }\n\n  function doctype(depth) {\n    return function(stream, state) {\n      var ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == \"<\") {\n          state.tokenize = doctype(depth + 1);\n          return state.tokenize(stream, state);\n        } else if (ch == \">\") {\n          if (depth == 1) {\n            state.tokenize = inText;\n            break;\n          } else {\n            state.tokenize = doctype(depth - 1);\n            return state.tokenize(stream, state);\n          }\n        }\n      }\n      return \"meta\";\n    };\n  }\n\n  function Context(state, tagName, startOfLine) {\n    this.prev = state.context;\n    this.tagName = tagName;\n    this.indent = state.indented;\n    this.startOfLine = startOfLine;\n    if (config.doNotIndent.hasOwnProperty(tagName) || (state.context && state.context.noIndent))\n      this.noIndent = true;\n  }\n  function popContext(state) {\n    if (state.context) state.context = state.context.prev;\n  }\n  function maybePopContext(state, nextTagName) {\n    var parentTagName;\n    while (true) {\n      if (!state.context) {\n        return;\n      }\n      parentTagName = state.context.tagName;\n      if (!config.contextGrabbers.hasOwnProperty(parentTagName) ||\n          !config.contextGrabbers[parentTagName].hasOwnProperty(nextTagName)) {\n        return;\n      }\n      popContext(state);\n    }\n  }\n\n  function baseState(type, stream, state) {\n    if (type == \"openTag\") {\n      state.tagStart = stream.column();\n      return tagNameState;\n    } else if (type == \"closeTag\") {\n      return closeTagNameState;\n    } else {\n      return baseState;\n    }\n  }\n  function tagNameState(type, stream, state) {\n    if (type == \"word\") {\n      state.tagName = stream.current();\n      setStyle = \"tag\";\n      return attrState;\n    } else if (config.allowMissingTagName && type == \"endTag\") {\n      setStyle = \"tag bracket\";\n      return attrState(type, stream, state);\n    } else {\n      setStyle = \"error\";\n      return tagNameState;\n    }\n  }\n  function closeTagNameState(type, stream, state) {\n    if (type == \"word\") {\n      var tagName = stream.current();\n      if (state.context && state.context.tagName != tagName &&\n          config.implicitlyClosed.hasOwnProperty(state.context.tagName))\n        popContext(state);\n      if ((state.context && state.context.tagName == tagName) || config.matchClosing === false) {\n        setStyle = \"tag\";\n        return closeState;\n      } else {\n        setStyle = \"tag error\";\n        return closeStateErr;\n      }\n    } else if (config.allowMissingTagName && type == \"endTag\") {\n      setStyle = \"tag bracket\";\n      return closeState(type, stream, state);\n    } else {\n      setStyle = \"error\";\n      return closeStateErr;\n    }\n  }\n\n  function closeState(type, _stream, state) {\n    if (type != \"endTag\") {\n      setStyle = \"error\";\n      return closeState;\n    }\n    popContext(state);\n    return baseState;\n  }\n  function closeStateErr(type, stream, state) {\n    setStyle = \"error\";\n    return closeState(type, stream, state);\n  }\n\n  function attrState(type, _stream, state) {\n    if (type == \"word\") {\n      setStyle = \"attribute\";\n      return attrEqState;\n    } else if (type == \"endTag\" || type == \"selfcloseTag\") {\n      var tagName = state.tagName, tagStart = state.tagStart;\n      state.tagName = state.tagStart = null;\n      if (type == \"selfcloseTag\" ||\n          config.autoSelfClosers.hasOwnProperty(tagName)) {\n        maybePopContext(state, tagName);\n      } else {\n        maybePopContext(state, tagName);\n        state.context = new Context(state, tagName, tagStart == state.indented);\n      }\n      return baseState;\n    }\n    setStyle = \"error\";\n    return attrState;\n  }\n  function attrEqState(type, stream, state) {\n    if (type == \"equals\") return attrValueState;\n    if (!config.allowMissing) setStyle = \"error\";\n    return attrState(type, stream, state);\n  }\n  function attrValueState(type, stream, state) {\n    if (type == \"string\") return attrContinuedState;\n    if (type == \"word\" && config.allowUnquoted) {setStyle = \"string\"; return attrState;}\n    setStyle = \"error\";\n    return attrState(type, stream, state);\n  }\n  function attrContinuedState(type, stream, state) {\n    if (type == \"string\") return attrContinuedState;\n    return attrState(type, stream, state);\n  }\n\n  return {\n    startState: function(baseIndent) {\n      var state = {tokenize: inText,\n                   state: baseState,\n                   indented: baseIndent || 0,\n                   tagName: null, tagStart: null,\n                   context: null}\n      if (baseIndent != null) state.baseIndent = baseIndent\n      return state\n    },\n\n    token: function(stream, state) {\n      if (!state.tagName && stream.sol())\n        state.indented = stream.indentation();\n\n      if (stream.eatSpace()) return null;\n      type = null;\n      var style = state.tokenize(stream, state);\n      if ((style || type) && style != \"comment\") {\n        setStyle = null;\n        state.state = state.state(type || style, stream, state);\n        if (setStyle)\n          style = setStyle == \"error\" ? style + \" error\" : setStyle;\n      }\n      return style;\n    },\n\n    indent: function(state, textAfter, fullLine) {\n      var context = state.context;\n      // Indent multi-line strings (e.g. css).\n      if (state.tokenize.isInAttribute) {\n        if (state.tagStart == state.indented)\n          return state.stringStartCol + 1;\n        else\n          return state.indented + indentUnit;\n      }\n      if (context && context.noIndent) return CodeMirror.Pass;\n      if (state.tokenize != inTag && state.tokenize != inText)\n        return fullLine ? fullLine.match(/^(\\s*)/)[0].length : 0;\n      // Indent the starts of attribute names.\n      if (state.tagName) {\n        if (config.multilineTagIndentPastTag !== false)\n          return state.tagStart + state.tagName.length + 2;\n        else\n          return state.tagStart + indentUnit * (config.multilineTagIndentFactor || 1);\n      }\n      if (config.alignCDATA && /<!\\[CDATA\\[/.test(textAfter)) return 0;\n      var tagAfter = textAfter && /^<(\\/)?([\\w_:\\.-]*)/.exec(textAfter);\n      if (tagAfter && tagAfter[1]) { // Closing tag spotted\n        while (context) {\n          if (context.tagName == tagAfter[2]) {\n            context = context.prev;\n            break;\n          } else if (config.implicitlyClosed.hasOwnProperty(context.tagName)) {\n            context = context.prev;\n          } else {\n            break;\n          }\n        }\n      } else if (tagAfter) { // Opening tag spotted\n        while (context) {\n          var grabbers = config.contextGrabbers[context.tagName];\n          if (grabbers && grabbers.hasOwnProperty(tagAfter[2]))\n            context = context.prev;\n          else\n            break;\n        }\n      }\n      while (context && context.prev && !context.startOfLine)\n        context = context.prev;\n      if (context) return context.indent + indentUnit;\n      else return state.baseIndent || 0;\n    },\n\n    electricInput: /<\\/[\\s\\w:]+>$/,\n    blockCommentStart: \"<!--\",\n    blockCommentEnd: \"-->\",\n\n    configuration: config.htmlMode ? \"html\" : \"xml\",\n    helperType: config.htmlMode ? \"html\" : \"xml\",\n\n    skipAttribute: function(state) {\n      if (state.state == attrValueState)\n        state.state = attrState\n    },\n\n    xmlCurrentTag: function(state) {\n      return state.tagName ? {name: state.tagName, close: state.type == \"closeTag\"} : null\n    },\n\n    xmlCurrentContext: function(state) {\n      var context = []\n      for (var cx = state.context; cx; cx = cx.prev)\n        if (cx.tagName) context.push(cx.tagName)\n      return context.reverse()\n    }\n  };\n});\n\nCodeMirror.defineMIME(\"text/xml\", \"xml\");\nCodeMirror.defineMIME(\"application/xml\", \"xml\");\nif (!CodeMirror.mimeModes.hasOwnProperty(\"text/html\"))\n  CodeMirror.defineMIME(\"text/html\", {name: \"xml\", htmlMode: true});\n\n});\n","/* globals chrome: false */\n/* globals __dirname: false */\n/* globals require: false */\n/* globals Buffer: false */\n/* globals module: false */\n\n/**\n * Typo is a JavaScript implementation of a spellchecker using hunspell-style \n * dictionaries.\n */\n\nvar Typo;\n\n(function () {\n\"use strict\";\n\n/**\n * Typo constructor.\n *\n * @param {String} [dictionary] The locale code of the dictionary being used. e.g.,\n *                              \"en_US\". This is only used to auto-load dictionaries.\n * @param {String} [affData]    The data from the dictionary's .aff file. If omitted\n *                              and Typo.js is being used in a Chrome extension, the .aff\n *                              file will be loaded automatically from\n *                              lib/typo/dictionaries/[dictionary]/[dictionary].aff\n *                              In other environments, it will be loaded from\n *                              [settings.dictionaryPath]/dictionaries/[dictionary]/[dictionary].aff\n * @param {String} [wordsData]  The data from the dictionary's .dic file. If omitted\n *                              and Typo.js is being used in a Chrome extension, the .dic\n *                              file will be loaded automatically from\n *                              lib/typo/dictionaries/[dictionary]/[dictionary].dic\n *                              In other environments, it will be loaded from\n *                              [settings.dictionaryPath]/dictionaries/[dictionary]/[dictionary].dic\n * @param {Object} [settings]   Constructor settings. Available properties are:\n *                              {String} [dictionaryPath]: path to load dictionary from in non-chrome\n *                              environment.\n *                              {Object} [flags]: flag information.\n *                              {Boolean} [asyncLoad]: If true, affData and wordsData will be loaded\n *                              asynchronously.\n *                              {Function} [loadedCallback]: Called when both affData and wordsData\n *                              have been loaded. Only used if asyncLoad is set to true. The parameter\n *                              is the instantiated Typo object.\n *\n * @returns {Typo} A Typo object.\n */\n\nTypo = function (dictionary, affData, wordsData, settings) {\n\tsettings = settings || {};\n\n\tthis.dictionary = null;\n\t\n\tthis.rules = {};\n\tthis.dictionaryTable = {};\n\t\n\tthis.compoundRules = [];\n\tthis.compoundRuleCodes = {};\n\t\n\tthis.replacementTable = [];\n\t\n\tthis.flags = settings.flags || {}; \n\t\n\tthis.memoized = {};\n\n\tthis.loaded = false;\n\t\n\tvar self = this;\n\t\n\tvar path;\n\t\n\t// Loop-control variables.\n\tvar i, j, _len, _jlen;\n\t\n\tif (dictionary) {\n\t\tself.dictionary = dictionary;\n\t\t\n\t\t// If the data is preloaded, just setup the Typo object.\n\t\tif (affData && wordsData) {\n\t\t\tsetup();\n\t\t}\n\t\t// Loading data for Chrome extentions.\n\t\telse if (typeof window !== 'undefined' && 'chrome' in window && 'extension' in window.chrome && 'getURL' in window.chrome.extension) {\n\t\t\tif (settings.dictionaryPath) {\n\t\t\t\tpath = settings.dictionaryPath;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpath = \"typo/dictionaries\";\n\t\t\t}\n\t\t\t\n\t\t\tif (!affData) readDataFile(chrome.extension.getURL(path + \"/\" + dictionary + \"/\" + dictionary + \".aff\"), setAffData);\n\t\t\tif (!wordsData) readDataFile(chrome.extension.getURL(path + \"/\" + dictionary + \"/\" + dictionary + \".dic\"), setWordsData);\n\t\t}\n\t\telse {\n\t\t\tif (settings.dictionaryPath) {\n\t\t\t\tpath = settings.dictionaryPath;\n\t\t\t}\n\t\t\telse if (typeof __dirname !== 'undefined') {\n\t\t\t\tpath = __dirname + '/dictionaries';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpath = './dictionaries';\n\t\t\t}\n\t\t\t\n\t\t\tif (!affData) readDataFile(path + \"/\" + dictionary + \"/\" + dictionary + \".aff\", setAffData);\n\t\t\tif (!wordsData) readDataFile(path + \"/\" + dictionary + \"/\" + dictionary + \".dic\", setWordsData);\n\t\t}\n\t}\n\t\n\tfunction readDataFile(url, setFunc) {\n\t\tvar response = self._readFile(url, null, settings.asyncLoad);\n\t\t\n\t\tif (settings.asyncLoad) {\n\t\t\tresponse.then(function(data) {\n\t\t\t\tsetFunc(data);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tsetFunc(response);\n\t\t}\n\t}\n\n\tfunction setAffData(data) {\n\t\taffData = data;\n\n\t\tif (wordsData) {\n\t\t\tsetup();\n\t\t}\n\t}\n\n\tfunction setWordsData(data) {\n\t\twordsData = data;\n\n\t\tif (affData) {\n\t\t\tsetup();\n\t\t}\n\t}\n\n\tfunction setup() {\n\t\tself.rules = self._parseAFF(affData);\n\t\t\n\t\t// Save the rule codes that are used in compound rules.\n\t\tself.compoundRuleCodes = {};\n\t\t\n\t\tfor (i = 0, _len = self.compoundRules.length; i < _len; i++) {\n\t\t\tvar rule = self.compoundRules[i];\n\t\t\t\n\t\t\tfor (j = 0, _jlen = rule.length; j < _jlen; j++) {\n\t\t\t\tself.compoundRuleCodes[rule[j]] = [];\n\t\t\t}\n\t\t}\n\t\t\n\t\t// If we add this ONLYINCOMPOUND flag to self.compoundRuleCodes, then _parseDIC\n\t\t// will do the work of saving the list of words that are compound-only.\n\t\tif (\"ONLYINCOMPOUND\" in self.flags) {\n\t\t\tself.compoundRuleCodes[self.flags.ONLYINCOMPOUND] = [];\n\t\t}\n\t\t\n\t\tself.dictionaryTable = self._parseDIC(wordsData);\n\t\t\n\t\t// Get rid of any codes from the compound rule codes that are never used \n\t\t// (or that were special regex characters).  Not especially necessary... \n\t\tfor (i in self.compoundRuleCodes) {\n\t\t\tif (self.compoundRuleCodes[i].length === 0) {\n\t\t\t\tdelete self.compoundRuleCodes[i];\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Build the full regular expressions for each compound rule.\n\t\t// I have a feeling (but no confirmation yet) that this method of \n\t\t// testing for compound words is probably slow.\n\t\tfor (i = 0, _len = self.compoundRules.length; i < _len; i++) {\n\t\t\tvar ruleText = self.compoundRules[i];\n\t\t\t\n\t\t\tvar expressionText = \"\";\n\t\t\t\n\t\t\tfor (j = 0, _jlen = ruleText.length; j < _jlen; j++) {\n\t\t\t\tvar character = ruleText[j];\n\t\t\t\t\n\t\t\t\tif (character in self.compoundRuleCodes) {\n\t\t\t\t\texpressionText += \"(\" + self.compoundRuleCodes[character].join(\"|\") + \")\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\texpressionText += character;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tself.compoundRules[i] = new RegExp(expressionText, \"i\");\n\t\t}\n\t\t\n\t\tself.loaded = true;\n\t\t\n\t\tif (settings.asyncLoad && settings.loadedCallback) {\n\t\t\tsettings.loadedCallback(self);\n\t\t}\n\t}\n\t\n\treturn this;\n};\n\nTypo.prototype = {\n\t/**\n\t * Loads a Typo instance from a hash of all of the Typo properties.\n\t *\n\t * @param object obj A hash of Typo properties, probably gotten from a JSON.parse(JSON.stringify(typo_instance)).\n\t */\n\t\n\tload : function (obj) {\n\t\tfor (var i in obj) {\n\t\t\tif (obj.hasOwnProperty(i)) {\n\t\t\t\tthis[i] = obj[i];\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn this;\n\t},\n\t\n\t/**\n\t * Read the contents of a file.\n\t * \n\t * @param {String} path The path (relative) to the file.\n\t * @param {String} [charset=\"ISO8859-1\"] The expected charset of the file\n\t * @param {Boolean} async If true, the file will be read asynchronously. For node.js this does nothing, all\n\t *        files are read synchronously.\n\t * @returns {String} The file data if async is false, otherwise a promise object. If running node.js, the data is\n\t *          always returned.\n\t */\n\t\n\t_readFile : function (path, charset, async) {\n\t\tcharset = charset || \"utf8\";\n\t\t\n\t\tif (typeof XMLHttpRequest !== 'undefined') {\n\t\t\tvar promise;\n\t\t\tvar req = new XMLHttpRequest();\n\t\t\treq.open(\"GET\", path, async);\n\t\t\t\n\t\t\tif (async) {\n\t\t\t\tpromise = new Promise(function(resolve, reject) {\n\t\t\t\t\treq.onload = function() {\n\t\t\t\t\t\tif (req.status === 200) {\n\t\t\t\t\t\t\tresolve(req.responseText);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treject(req.statusText);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\treq.onerror = function() {\n\t\t\t\t\t\treject(req.statusText);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\tif (req.overrideMimeType)\n\t\t\t\treq.overrideMimeType(\"text/plain; charset=\" + charset);\n\t\t\n\t\t\treq.send(null);\n\t\t\t\n\t\t\treturn async ? promise : req.responseText;\n\t\t}\n\t\telse if (typeof require !== 'undefined') {\n\t\t\t// Node.js\n\t\t\tvar fs = require(\"fs\");\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (fs.existsSync(path)) {\n\t\t\t\t\treturn fs.readFileSync(path, charset);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconsole.log(\"Path \" + path + \" does not exist.\");\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(e);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}\n\t},\n\t\n\t/**\n\t * Parse the rules out from a .aff file.\n\t *\n\t * @param {String} data The contents of the affix file.\n\t * @returns object The rules from the file.\n\t */\n\t\n\t_parseAFF : function (data) {\n\t\tvar rules = {};\n\t\t\n\t\tvar line, subline, numEntries, lineParts;\n\t\tvar i, j, _len, _jlen;\n\t\t\n\t\t// Remove comment lines\n\t\tdata = this._removeAffixComments(data);\n\t\t\n\t\tvar lines = data.split(/\\r?\\n/);\n\t\t\n\t\tfor (i = 0, _len = lines.length; i < _len; i++) {\n\t\t\tline = lines[i];\n\t\t\t\n\t\t\tvar definitionParts = line.split(/\\s+/);\n\t\t\t\n\t\t\tvar ruleType = definitionParts[0];\n\t\t\t\n\t\t\tif (ruleType == \"PFX\" || ruleType == \"SFX\") {\n\t\t\t\tvar ruleCode = definitionParts[1];\n\t\t\t\tvar combineable = definitionParts[2];\n\t\t\t\tnumEntries = parseInt(definitionParts[3], 10);\n\t\t\t\t\n\t\t\t\tvar entries = [];\n\t\t\t\t\n\t\t\t\tfor (j = i + 1, _jlen = i + 1 + numEntries; j < _jlen; j++) {\n\t\t\t\t\tsubline = lines[j];\n\t\t\t\t\t\n\t\t\t\t\tlineParts = subline.split(/\\s+/);\n\t\t\t\t\tvar charactersToRemove = lineParts[2];\n\t\t\t\t\t\n\t\t\t\t\tvar additionParts = lineParts[3].split(\"/\");\n\t\t\t\t\t\n\t\t\t\t\tvar charactersToAdd = additionParts[0];\n\t\t\t\t\tif (charactersToAdd === \"0\") charactersToAdd = \"\";\n\t\t\t\t\t\n\t\t\t\t\tvar continuationClasses = this.parseRuleCodes(additionParts[1]);\n\t\t\t\t\t\n\t\t\t\t\tvar regexToMatch = lineParts[4];\n\t\t\t\t\t\n\t\t\t\t\tvar entry = {};\n\t\t\t\t\tentry.add = charactersToAdd;\n\t\t\t\t\t\n\t\t\t\t\tif (continuationClasses.length > 0) entry.continuationClasses = continuationClasses;\n\t\t\t\t\t\n\t\t\t\t\tif (regexToMatch !== \".\") {\n\t\t\t\t\t\tif (ruleType === \"SFX\") {\n\t\t\t\t\t\t\tentry.match = new RegExp(regexToMatch + \"$\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tentry.match = new RegExp(\"^\" + regexToMatch);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (charactersToRemove != \"0\") {\n\t\t\t\t\t\tif (ruleType === \"SFX\") {\n\t\t\t\t\t\t\tentry.remove = new RegExp(charactersToRemove  + \"$\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tentry.remove = charactersToRemove;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tentries.push(entry);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trules[ruleCode] = { \"type\" : ruleType, \"combineable\" : (combineable == \"Y\"), \"entries\" : entries };\n\t\t\t\t\n\t\t\t\ti += numEntries;\n\t\t\t}\n\t\t\telse if (ruleType === \"COMPOUNDRULE\") {\n\t\t\t\tnumEntries = parseInt(definitionParts[1], 10);\n\t\t\t\t\n\t\t\t\tfor (j = i + 1, _jlen = i + 1 + numEntries; j < _jlen; j++) {\n\t\t\t\t\tline = lines[j];\n\t\t\t\t\t\n\t\t\t\t\tlineParts = line.split(/\\s+/);\n\t\t\t\t\tthis.compoundRules.push(lineParts[1]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ti += numEntries;\n\t\t\t}\n\t\t\telse if (ruleType === \"REP\") {\n\t\t\t\tlineParts = line.split(/\\s+/);\n\t\t\t\t\n\t\t\t\tif (lineParts.length === 3) {\n\t\t\t\t\tthis.replacementTable.push([ lineParts[1], lineParts[2] ]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// ONLYINCOMPOUND\n\t\t\t\t// COMPOUNDMIN\n\t\t\t\t// FLAG\n\t\t\t\t// KEEPCASE\n\t\t\t\t// NEEDAFFIX\n\t\t\t\t\n\t\t\t\tthis.flags[ruleType] = definitionParts[1];\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn rules;\n\t},\n\t\n\t/**\n\t * Removes comment lines and then cleans up blank lines and trailing whitespace.\n\t *\n\t * @param {String} data The data from an affix file.\n\t * @return {String} The cleaned-up data.\n\t */\n\t\n\t_removeAffixComments : function (data) {\n\t\t// Remove comments\n\t\t// This used to remove any string starting with '#' up to the end of the line,\n\t\t// but some COMPOUNDRULE definitions include '#' as part of the rule.\n\t\t// I haven't seen any affix files that use comments on the same line as real data,\n\t\t// so I don't think this will break anything.\n\t\tdata = data.replace(/^\\s*#.*$/mg, \"\");\n\t\t\n\t\t// Trim each line\n\t\tdata = data.replace(/^\\s\\s*/m, '').replace(/\\s\\s*$/m, '');\n\t\t\n\t\t// Remove blank lines.\n\t\tdata = data.replace(/\\n{2,}/g, \"\\n\");\n\t\t\n\t\t// Trim the entire string\n\t\tdata = data.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\t\t\n\t\treturn data;\n\t},\n\t\n\t/**\n\t * Parses the words out from the .dic file.\n\t *\n\t * @param {String} data The data from the dictionary file.\n\t * @returns object The lookup table containing all of the words and\n\t *                 word forms from the dictionary.\n\t */\n\t\n\t_parseDIC : function (data) {\n\t\tdata = this._removeDicComments(data);\n\t\t\n\t\tvar lines = data.split(/\\r?\\n/);\n\t\tvar dictionaryTable = {};\n\t\t\n\t\tfunction addWord(word, rules) {\n\t\t\t// Some dictionaries will list the same word multiple times with different rule sets.\n\t\t\tif (!dictionaryTable.hasOwnProperty(word)) {\n\t\t\t\tdictionaryTable[word] = null;\n\t\t\t}\n\t\t\t\n\t\t\tif (rules.length > 0) {\n\t\t\t\tif (dictionaryTable[word] === null) {\n\t\t\t\t\tdictionaryTable[word] = [];\n\t\t\t\t}\n\n\t\t\t\tdictionaryTable[word].push(rules);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// The first line is the number of words in the dictionary.\n\t\tfor (var i = 1, _len = lines.length; i < _len; i++) {\n\t\t\tvar line = lines[i];\n\t\t\t\n\t\t\tif (!line) {\n\t\t\t\t// Ignore empty lines.\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar parts = line.split(\"/\", 2);\n\t\t\t\n\t\t\tvar word = parts[0];\n\n\t\t\t// Now for each affix rule, generate that form of the word.\n\t\t\tif (parts.length > 1) {\n\t\t\t\tvar ruleCodesArray = this.parseRuleCodes(parts[1]);\n\t\t\t\t\n\t\t\t\t// Save the ruleCodes for compound word situations.\n\t\t\t\tif (!(\"NEEDAFFIX\" in this.flags) || ruleCodesArray.indexOf(this.flags.NEEDAFFIX) == -1) {\n\t\t\t\t\taddWord(word, ruleCodesArray);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (var j = 0, _jlen = ruleCodesArray.length; j < _jlen; j++) {\n\t\t\t\t\tvar code = ruleCodesArray[j];\n\t\t\t\t\t\n\t\t\t\t\tvar rule = this.rules[code];\n\t\t\t\t\t\n\t\t\t\t\tif (rule) {\n\t\t\t\t\t\tvar newWords = this._applyRule(word, rule);\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (var ii = 0, _iilen = newWords.length; ii < _iilen; ii++) {\n\t\t\t\t\t\t\tvar newWord = newWords[ii];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\taddWord(newWord, []);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (rule.combineable) {\n\t\t\t\t\t\t\t\tfor (var k = j + 1; k < _jlen; k++) {\n\t\t\t\t\t\t\t\t\tvar combineCode = ruleCodesArray[k];\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tvar combineRule = this.rules[combineCode];\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (combineRule) {\n\t\t\t\t\t\t\t\t\t\tif (combineRule.combineable && (rule.type != combineRule.type)) {\n\t\t\t\t\t\t\t\t\t\t\tvar otherNewWords = this._applyRule(newWord, combineRule);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tfor (var iii = 0, _iiilen = otherNewWords.length; iii < _iiilen; iii++) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar otherNewWord = otherNewWords[iii];\n\t\t\t\t\t\t\t\t\t\t\t\taddWord(otherNewWord, []);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (code in this.compoundRuleCodes) {\n\t\t\t\t\t\tthis.compoundRuleCodes[code].push(word);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\taddWord(word.trim(), []);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn dictionaryTable;\n\t},\n\t\n\t\n\t/**\n\t * Removes comment lines and then cleans up blank lines and trailing whitespace.\n\t *\n\t * @param {String} data The data from a .dic file.\n\t * @return {String} The cleaned-up data.\n\t */\n\t\n\t_removeDicComments : function (data) {\n\t\t// I can't find any official documentation on it, but at least the de_DE\n\t\t// dictionary uses tab-indented lines as comments.\n\t\t\n\t\t// Remove comments\n\t\tdata = data.replace(/^\\t.*$/mg, \"\");\n\t\t\n\t\treturn data;\n\t},\n\t\n\tparseRuleCodes : function (textCodes) {\n\t\tif (!textCodes) {\n\t\t\treturn [];\n\t\t}\n\t\telse if (!(\"FLAG\" in this.flags)) {\n\t\t\treturn textCodes.split(\"\");\n\t\t}\n\t\telse if (this.flags.FLAG === \"long\") {\n\t\t\tvar flags = [];\n\t\t\t\n\t\t\tfor (var i = 0, _len = textCodes.length; i < _len; i += 2) {\n\t\t\t\tflags.push(textCodes.substr(i, 2));\n\t\t\t}\n\t\t\t\n\t\t\treturn flags;\n\t\t}\n\t\telse if (this.flags.FLAG === \"num\") {\n\t\t\treturn textCodes.split(\",\");\n\t\t}\n\t},\n\t\n\t/**\n\t * Applies an affix rule to a word.\n\t *\n\t * @param {String} word The base word.\n\t * @param {Object} rule The affix rule.\n\t * @returns {String[]} The new words generated by the rule.\n\t */\n\t\n\t_applyRule : function (word, rule) {\n\t\tvar entries = rule.entries;\n\t\tvar newWords = [];\n\t\t\n\t\tfor (var i = 0, _len = entries.length; i < _len; i++) {\n\t\t\tvar entry = entries[i];\n\t\t\t\n\t\t\tif (!entry.match || word.match(entry.match)) {\n\t\t\t\tvar newWord = word;\n\t\t\t\t\n\t\t\t\tif (entry.remove) {\n\t\t\t\t\tnewWord = newWord.replace(entry.remove, \"\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (rule.type === \"SFX\") {\n\t\t\t\t\tnewWord = newWord + entry.add;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewWord = entry.add + newWord;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tnewWords.push(newWord);\n\t\t\t\t\n\t\t\t\tif (\"continuationClasses\" in entry) {\n\t\t\t\t\tfor (var j = 0, _jlen = entry.continuationClasses.length; j < _jlen; j++) {\n\t\t\t\t\t\tvar continuationRule = this.rules[entry.continuationClasses[j]];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (continuationRule) {\n\t\t\t\t\t\t\tnewWords = newWords.concat(this._applyRule(newWord, continuationRule));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/*\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// This shouldn't happen, but it does, at least in the de_DE dictionary.\n\t\t\t\t\t\t\t// I think the author mistakenly supplied lower-case rule codes instead \n\t\t\t\t\t\t\t// of upper-case.\n\t\t\t\t\t\t}\n\t\t\t\t\t\t*/\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn newWords;\n\t},\n\t\n\t/**\n\t * Checks whether a word or a capitalization variant exists in the current dictionary.\n\t * The word is trimmed and several variations of capitalizations are checked.\n\t * If you want to check a word without any changes made to it, call checkExact()\n\t *\n\t * @see http://blog.stevenlevithan.com/archives/faster-trim-javascript re:trimming function\n\t *\n\t * @param {String} aWord The word to check.\n\t * @returns {Boolean}\n\t */\n\t\n\tcheck : function (aWord) {\n\t\tif (!this.loaded) {\n\t\t\tthrow \"Dictionary not loaded.\";\n\t\t}\n\t\t\n\t\t// Remove leading and trailing whitespace\n\t\tvar trimmedWord = aWord.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\t\t\n\t\tif (this.checkExact(trimmedWord)) {\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\t// The exact word is not in the dictionary.\n\t\tif (trimmedWord.toUpperCase() === trimmedWord) {\n\t\t\t// The word was supplied in all uppercase.\n\t\t\t// Check for a capitalized form of the word.\n\t\t\tvar capitalizedWord = trimmedWord[0] + trimmedWord.substring(1).toLowerCase();\n\t\t\t\n\t\t\tif (this.hasFlag(capitalizedWord, \"KEEPCASE\")) {\n\t\t\t\t// Capitalization variants are not allowed for this word.\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.checkExact(capitalizedWord)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar lowercaseWord = trimmedWord.toLowerCase();\n\t\t\n\t\tif (lowercaseWord !== trimmedWord) {\n\t\t\tif (this.hasFlag(lowercaseWord, \"KEEPCASE\")) {\n\t\t\t\t// Capitalization variants are not allowed for this word.\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\t// Check for a lowercase form\n\t\t\tif (this.checkExact(lowercaseWord)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t},\n\t\n\t/**\n\t * Checks whether a word exists in the current dictionary.\n\t *\n\t * @param {String} word The word to check.\n\t * @returns {Boolean}\n\t */\n\t\n\tcheckExact : function (word) {\n\t\tif (!this.loaded) {\n\t\t\tthrow \"Dictionary not loaded.\";\n\t\t}\n\n\t\tvar ruleCodes = this.dictionaryTable[word];\n\t\t\n\t\tvar i, _len;\n\t\t\n\t\tif (typeof ruleCodes === 'undefined') {\n\t\t\t// Check if this might be a compound word.\n\t\t\tif (\"COMPOUNDMIN\" in this.flags && word.length >= this.flags.COMPOUNDMIN) {\n\t\t\t\tfor (i = 0, _len = this.compoundRules.length; i < _len; i++) {\n\t\t\t\t\tif (word.match(this.compoundRules[i])) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (ruleCodes === null) {\n\t\t\t// a null (but not undefined) value for an entry in the dictionary table\n\t\t\t// means that the word is in the dictionary but has no flags.\n\t\t\treturn true;\n\t\t}\n\t\telse if (typeof ruleCodes === 'object') { // this.dictionary['hasOwnProperty'] will be a function.\n\t\t\tfor (i = 0, _len = ruleCodes.length; i < _len; i++) {\n\t\t\t\tif (!this.hasFlag(word, \"ONLYINCOMPOUND\", ruleCodes[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\t\n\t/**\n\t * Looks up whether a given word is flagged with a given flag.\n\t *\n\t * @param {String} word The word in question.\n\t * @param {String} flag The flag in question.\n\t * @return {Boolean}\n\t */\n\t \n\thasFlag : function (word, flag, wordFlags) {\n\t\tif (!this.loaded) {\n\t\t\tthrow \"Dictionary not loaded.\";\n\t\t}\n\n\t\tif (flag in this.flags) {\n\t\t\tif (typeof wordFlags === 'undefined') {\n\t\t\t\twordFlags = Array.prototype.concat.apply([], this.dictionaryTable[word]);\n\t\t\t}\n\t\t\t\n\t\t\tif (wordFlags && wordFlags.indexOf(this.flags[flag]) !== -1) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t},\n\t\n\t/**\n\t * Returns a list of suggestions for a misspelled word.\n\t *\n\t * @see http://www.norvig.com/spell-correct.html for the basis of this suggestor.\n\t * This suggestor is primitive, but it works.\n\t *\n\t * @param {String} word The misspelling.\n\t * @param {Number} [limit=5] The maximum number of suggestions to return.\n\t * @returns {String[]} The array of suggestions.\n\t */\n\t\n\talphabet : \"\",\n\t\n\tsuggest : function (word, limit) {\n\t\tif (!this.loaded) {\n\t\t\tthrow \"Dictionary not loaded.\";\n\t\t}\n\n\t\tlimit = limit || 5;\n\n\t\tif (this.memoized.hasOwnProperty(word)) {\n\t\t\tvar memoizedLimit = this.memoized[word]['limit'];\n\n\t\t\t// Only return the cached list if it's big enough or if there weren't enough suggestions\n\t\t\t// to fill a smaller limit.\n\t\t\tif (limit <= memoizedLimit || this.memoized[word]['suggestions'].length < memoizedLimit) {\n\t\t\t\treturn this.memoized[word]['suggestions'].slice(0, limit);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this.check(word)) return [];\n\t\t\n\t\t// Check the replacement table.\n\t\tfor (var i = 0, _len = this.replacementTable.length; i < _len; i++) {\n\t\t\tvar replacementEntry = this.replacementTable[i];\n\t\t\t\n\t\t\tif (word.indexOf(replacementEntry[0]) !== -1) {\n\t\t\t\tvar correctedWord = word.replace(replacementEntry[0], replacementEntry[1]);\n\t\t\t\t\n\t\t\t\tif (this.check(correctedWord)) {\n\t\t\t\t\treturn [ correctedWord ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar self = this;\n\t\tself.alphabet = \"abcdefghijklmnopqrstuvwxyz\";\n\t\t\n\t\t/*\n\t\tif (!self.alphabet) {\n\t\t\t// Use the alphabet as implicitly defined by the words in the dictionary.\n\t\t\tvar alphaHash = {};\n\t\t\t\n\t\t\tfor (var i in self.dictionaryTable) {\n\t\t\t\tfor (var j = 0, _len = i.length; j < _len; j++) {\n\t\t\t\t\talphaHash[i[j]] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor (var i in alphaHash) {\n\t\t\t\tself.alphabet += i;\n\t\t\t}\n\t\t\t\n\t\t\tvar alphaArray = self.alphabet.split(\"\");\n\t\t\talphaArray.sort();\n\t\t\tself.alphabet = alphaArray.join(\"\");\n\t\t}\n\t\t*/\n\t\t\n\t\t/**\n\t\t * Returns a hash keyed by all of the strings that can be made by making a single edit to the word (or words in) `words`\n\t\t * The value of each entry is the number of unique ways that the resulting word can be made.\n\t\t *\n\t\t * @arg mixed words Either a hash keyed by words or a string word to operate on.\n\t\t * @arg bool known_only Whether this function should ignore strings that are not in the dictionary.\n\t\t */\n\t\tfunction edits1(words, known_only) {\n\t\t\tvar rv = {};\n\t\t\t\n\t\t\tvar i, j, _iilen, _len, _jlen, _edit;\n\t\t\t\n\t\t\tif (typeof words == 'string') {\n\t\t\t\tvar word = words;\n\t\t\t\twords = {};\n\t\t\t\twords[word] = true;\n\t\t\t}\n\n\t\t\tfor (var word in words) {\n\t\t\t\tfor (i = 0, _len = word.length + 1; i < _len; i++) {\n\t\t\t\t\tvar s = [ word.substring(0, i), word.substring(i) ];\n\t\t\t\t\n\t\t\t\t\tif (s[1]) {\n\t\t\t\t\t\t_edit = s[0] + s[1].substring(1);\n\n\t\t\t\t\t\tif (!known_only || self.check(_edit)) {\n\t\t\t\t\t\t\tif (!(_edit in rv)) {\n\t\t\t\t\t\t\t\trv[_edit] = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\trv[_edit] += 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Eliminate transpositions of identical letters\n\t\t\t\t\tif (s[1].length > 1 && s[1][1] !== s[1][0]) {\n\t\t\t\t\t\t_edit = s[0] + s[1][1] + s[1][0] + s[1].substring(2);\n\n\t\t\t\t\t\tif (!known_only || self.check(_edit)) {\n\t\t\t\t\t\t\tif (!(_edit in rv)) {\n\t\t\t\t\t\t\t\trv[_edit] = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\trv[_edit] += 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (s[1]) {\n\t\t\t\t\t\tfor (j = 0, _jlen = self.alphabet.length; j < _jlen; j++) {\n\t\t\t\t\t\t\t// Eliminate replacement of a letter by itself\n\t\t\t\t\t\t\tif (self.alphabet[j] != s[1].substring(0,1)){\n\t\t\t\t\t\t\t\t_edit = s[0] + self.alphabet[j] + s[1].substring(1);\n\n\t\t\t\t\t\t\t\tif (!known_only || self.check(_edit)) {\n\t\t\t\t\t\t\t\t\tif (!(_edit in rv)) {\n\t\t\t\t\t\t\t\t\t\trv[_edit] = 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\trv[_edit] += 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (s[1]) {\n\t\t\t\t\t\tfor (j = 0, _jlen = self.alphabet.length; j < _jlen; j++) {\n\t\t\t\t\t\t\t_edit = s[0] + self.alphabet[j] + s[1];\n\n\t\t\t\t\t\t\tif (!known_only || self.check(_edit)) {\n\t\t\t\t\t\t\t\tif (!(_edit in rv)) {\n\t\t\t\t\t\t\t\t\trv[_edit] = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\trv[_edit] += 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn rv;\n\t\t}\n\n\t\tfunction correct(word) {\n\t\t\t// Get the edit-distance-1 and edit-distance-2 forms of this word.\n\t\t\tvar ed1 = edits1(word);\n\t\t\tvar ed2 = edits1(ed1, true);\n\t\t\t\n\t\t\t// Sort the edits based on how many different ways they were created.\n\t\t\tvar weighted_corrections = ed2;\n\t\t\t\n\t\t\tfor (var ed1word in ed1) {\n\t\t\t\tif (!self.check(ed1word)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (ed1word in weighted_corrections) {\n\t\t\t\t\tweighted_corrections[ed1word] += ed1[ed1word];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tweighted_corrections[ed1word] = ed1[ed1word];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar i, _len;\n\n\t\t\tvar sorted_corrections = [];\n\t\t\t\n\t\t\tfor (i in weighted_corrections) {\n\t\t\t\tif (weighted_corrections.hasOwnProperty(i)) {\n\t\t\t\t\tsorted_corrections.push([ i, weighted_corrections[i] ]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction sorter(a, b) {\n\t\t\t\tvar a_val = a[1];\n\t\t\t\tvar b_val = b[1];\n\t\t\t\tif (a_val < b_val) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else if (a_val > b_val) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\t// @todo If a and b are equally weighted, add our own weight based on something like the key locations on this language's default keyboard.\n\t\t\t\treturn b[0].localeCompare(a[0]);\n\t\t\t}\n\t\t\t\n\t\t\tsorted_corrections.sort(sorter).reverse();\n\n\t\t\tvar rv = [];\n\n\t\t\tvar capitalization_scheme = \"lowercase\";\n\t\t\t\n\t\t\tif (word.toUpperCase() === word) {\n\t\t\t\tcapitalization_scheme = \"uppercase\";\n\t\t\t}\n\t\t\telse if (word.substr(0, 1).toUpperCase() + word.substr(1).toLowerCase() === word) {\n\t\t\t\tcapitalization_scheme = \"capitalized\";\n\t\t\t}\n\t\t\t\n\t\t\tvar working_limit = limit;\n\n\t\t\tfor (i = 0; i < Math.min(working_limit, sorted_corrections.length); i++) {\n\t\t\t\tif (\"uppercase\" === capitalization_scheme) {\n\t\t\t\t\tsorted_corrections[i][0] = sorted_corrections[i][0].toUpperCase();\n\t\t\t\t}\n\t\t\t\telse if (\"capitalized\" === capitalization_scheme) {\n\t\t\t\t\tsorted_corrections[i][0] = sorted_corrections[i][0].substr(0, 1).toUpperCase() + sorted_corrections[i][0].substr(1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!self.hasFlag(sorted_corrections[i][0], \"NOSUGGEST\") && rv.indexOf(sorted_corrections[i][0]) == -1) {\n\t\t\t\t\trv.push(sorted_corrections[i][0]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// If one of the corrections is not eligible as a suggestion , make sure we still return the right number of suggestions.\n\t\t\t\t\tworking_limit++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn rv;\n\t\t}\n\t\t\n\t\tthis.memoized[word] = {\n\t\t\t'suggestions': correct(word),\n\t\t\t'limit': limit\n\t\t};\n\n\t\treturn this.memoized[word]['suggestions'];\n\t}\n};\n})();\n\n// Support for use as a node.js module.\nif (typeof module !== 'undefined') {\n\tmodule.exports = Typo;\n}\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\nvar CodeMirror = require('codemirror');\n\nCodeMirror.commands.tabAndIndentMarkdownList = function (cm) {\n    var ranges = cm.listSelections();\n    var pos = ranges[0].head;\n    var eolState = cm.getStateAfter(pos.line);\n    var inList = eolState.list !== false;\n\n    if (inList) {\n        cm.execCommand('indentMore');\n        return;\n    }\n\n    if (cm.options.indentWithTabs) {\n        cm.execCommand('insertTab');\n    }\n    else {\n        var spaces = Array(cm.options.tabSize + 1).join(' ');\n        cm.replaceSelection(spaces);\n    }\n};\n\nCodeMirror.commands.shiftTabAndUnindentMarkdownList = function (cm) {\n    var ranges = cm.listSelections();\n    var pos = ranges[0].head;\n    var eolState = cm.getStateAfter(pos.line);\n    var inList = eolState.list !== false;\n\n    if (inList) {\n        cm.execCommand('indentLess');\n        return;\n    }\n\n    if (cm.options.indentWithTabs) {\n        cm.execCommand('insertTab');\n    }\n    else {\n        var spaces = Array(cm.options.tabSize + 1).join(' ');\n        cm.replaceSelection(spaces);\n    }\n};\n","'use strict';\nvar CodeMirror = require('codemirror');\nrequire('codemirror/addon/edit/continuelist.js');\nrequire('./codemirror/tablist');\nrequire('codemirror/addon/display/fullscreen.js');\nrequire('codemirror/mode/markdown/markdown.js');\nrequire('codemirror/addon/mode/overlay.js');\nrequire('codemirror/addon/display/placeholder.js');\nrequire('codemirror/addon/selection/mark-selection.js');\nrequire('codemirror/addon/search/searchcursor.js');\nrequire('codemirror/mode/gfm/gfm.js');\nrequire('codemirror/mode/xml/xml.js');\nrequire('codemirror/addon/hint/show-hint.js');\nrequire('codemirror/keymap/vim.js')\nvar CodeMirrorSpellChecker = require('codemirror-spell-checker');\nvar marked = require('./marked/marked.js');\n// Some variables\nvar isMac = /Mac/.test(navigator.platform);\nvar anchorToExternalRegex = new RegExp(/(<a.*?https?:\\/\\/.*?[^a]>)+?/g);\n\n\nconst { block, inline } = require('./marked/rules.js');\nconst rules = {\n    block, inline\n};\n\n// Mapping of actions that can be bound to keyboard shortcuts or toolbar buttons\nvar bindings = {\n    'toggleBold': toggleBold,\n    'toggleItalic': toggleItalic,\n    'drawLink': drawLink,\n    'toggleHeadingSmaller': toggleHeadingSmaller,\n    'toggleHeadingBigger': toggleHeadingBigger,\n    'drawImage': drawImage,\n    'toggleBlockquote': toggleBlockquote,\n    'toggleOrderedList': toggleOrderedList,\n    'toggleUnorderedList': toggleUnorderedList,\n    'toggleCodeBlock': toggleCodeBlock,\n    'togglePreview': togglePreview,\n    'toggleStrikethrough': toggleStrikethrough,\n    'toggleHeading1': toggleHeading1,\n    'toggleHeading2': toggleHeading2,\n    'toggleHeading3': toggleHeading3,\n    'cleanBlock': cleanBlock,\n    'drawTable': drawTable,\n    'drawHorizontalRule': drawHorizontalRule,\n    'undo': undo,\n    'redo': redo,\n    'toggleSideBySide': toggleSideBySide,\n    'toggleFullScreen': toggleFullScreen,\n    'toggleSecretBlock': toggleSecretBlock\n};\n\nvar shortcuts = {\n    'toggleBold': 'Cmd-B',\n    'toggleItalic': 'Cmd-I',\n    'drawLink': 'Cmd-K',\n    'toggleHeadingSmaller': 'Cmd-H',\n    'toggleHeadingBigger': 'Shift-Cmd-H',\n    'cleanBlock': 'Cmd-E',\n    'drawImage': 'Cmd-Alt-I',\n    'toggleBlockquote': 'Cmd-\\'',\n    'toggleOrderedList': 'Cmd-Alt-L',\n    'toggleUnorderedList': 'Cmd-L',\n    'toggleCodeBlock': 'Cmd-Alt-C',\n    'togglePreview': 'Cmd-P',\n    'toggleSideBySide': 'F9',\n    'toggleFullScreen': 'F11',\n};\n\nvar getBindingName = function (f) {\n    for (var key in bindings) {\n        if (bindings[key] === f) {\n            return key;\n        }\n    }\n    return null;\n};\n\nvar isMobile = function () {\n    var check = false;\n    (function (a) {\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0, 4))) check = true;\n    })(navigator.userAgent || navigator.vendor || window.opera);\n    return check;\n};\n\n/**\n * Modify HTML to add 'target=\"_blank\"' to links so they open in new tabs by default.\n * @param {string} htmlText - HTML to be modified.\n * @return {string} The modified HTML text.\n */\nfunction addAnchorTargetBlank(htmlText) {\n    var match;\n    while ((match = anchorToExternalRegex.exec(htmlText)) !== null) {\n        // With only one capture group in the RegExp, we can safely take the first index from the match.\n        var linkString = match[0];\n\n        if (linkString.indexOf('target=') === -1) {\n            var fixedLinkString = linkString.replace(/>$/, ' target=\"_blank\">');\n            htmlText = htmlText.replace(linkString, fixedLinkString);\n        }\n    }\n    return htmlText;\n}\n\n/**\n * Modify HTML to remove the list-style when rendering checkboxes.\n * @param {string} htmlText - HTML to be modified.\n * @return {string} The modified HTML text.\n */\nfunction removeListStyleWhenCheckbox(htmlText) {\n\n    var parser = new DOMParser();\n    var htmlDoc = parser.parseFromString(htmlText, 'text/html');\n    var listItems = htmlDoc.getElementsByTagName('li');\n\n    for (var i = 0; i < listItems.length; i++) {\n        var listItem = listItems[i];\n\n        for (var j = 0; j < listItem.children.length; j++) {\n            var listItemChild = listItem.children[j];\n\n            if (listItemChild instanceof HTMLInputElement && listItemChild.type === 'checkbox') {\n                // From Github: margin: 0 .2em .25em -1.6em;\n                listItem.style.marginLeft = '-1.5em';\n                listItem.style.listStyleType = 'none';\n            }\n        }\n    }\n\n    return htmlDoc.documentElement.innerHTML;\n}\n\n/**\n * Fix shortcut. Mac use Command, others use Ctrl.\n */\nfunction fixShortcut(name) {\n    if (isMac) {\n        name = name.replace('Ctrl', 'Cmd');\n    } else {\n        name = name.replace('Cmd', 'Ctrl');\n    }\n    return name;\n}\n\n/**\n * Create dropdown block\n */\nfunction createToolbarDropdown(options, enableTooltips, shortcuts, parent) {\n    var el = createToolbarButton(options, false, enableTooltips, shortcuts, 'button', parent);\n    el.className += ' easymde-dropdown';\n    var content = document.createElement('div');\n    content.className = 'easymde-dropdown-content';\n    for (var childrenIndex = 0; childrenIndex < options.children.length; childrenIndex++) {\n\n        var child = options.children[childrenIndex];\n        var childElement;\n\n        if (typeof child === 'string' && child in toolbarBuiltInButtons) {\n            childElement = createToolbarButton(toolbarBuiltInButtons[child], true, enableTooltips, shortcuts, 'button', parent);\n        } else {\n            childElement = createToolbarButton(child, true, enableTooltips, shortcuts, 'button', parent);\n        }\n\n        content.appendChild(childElement);\n    }\n    el.appendChild(content);\n    return el;\n}\n\n/**\n * Create button element for toolbar.\n */\nfunction createToolbarButton(options, enableActions, enableTooltips, shortcuts, markup, parent) {\n    options = options || {};\n    var el = document.createElement(markup);\n    el.className = options.name;\n    el.setAttribute('type', markup);\n    enableTooltips = (enableTooltips == undefined) ? true : enableTooltips;\n\n    // Properly hande custom shortcuts\n    if (options.name && options.name in shortcuts) {\n        bindings[options.name] = options.action;\n    }\n\n    if (options.title && enableTooltips) {\n        el.title = createTooltip(options.title, options.action, shortcuts);\n\n        if (isMac) {\n            el.title = el.title.replace('Ctrl', '');\n            el.title = el.title.replace('Alt', '');\n        }\n    }\n\n    if (options.noDisable) {\n        el.classList.add('no-disable');\n    }\n\n    if (options.noMobile) {\n        el.classList.add('no-mobile');\n    }\n\n    // Prevent errors if there is no class name in custom options\n    var classNameParts = [];\n    if(typeof options.className !== 'undefined') {\n        classNameParts = options.className.split(' ');\n    }\n\n    // Provide backwards compatibility with simple-markdown-editor by adding custom classes to the button.\n    var iconClasses = [];\n    for (var classNameIndex = 0; classNameIndex < classNameParts.length; classNameIndex++) {\n        var classNamePart = classNameParts[classNameIndex];\n        // Split icon classes from the button.\n        // Regex will detect \"fa\", \"fas\", \"fa-something\" and \"fa-some-icon-1\", but not \"fanfare\".\n        if (classNamePart.match(/^fa([srlb]|(-[\\w-]*)|$)/)) {\n            iconClasses.push(classNamePart);\n        } else {\n            el.classList.add(classNamePart);\n        }\n    }\n\n    el.tabIndex = -1;\n\n    // Create icon element and append as a child to the button\n    var icon = document.createElement('i');\n    for (var iconClassIndex = 0; iconClassIndex < iconClasses.length; iconClassIndex++) {\n        var iconClass = iconClasses[iconClassIndex];\n        icon.classList.add(iconClass);\n    }\n    el.appendChild(icon);\n\n    // If there is a custom icon markup set, use that\n    if (typeof options.icon !== 'undefined') {\n        el.innerHTML = options.icon;\n    }\n\n    if (options.action && enableActions) {\n        if (typeof options.action === 'function') {\n            el.onclick = function (e) {\n                e.preventDefault();\n                options.action(parent);\n            };\n        } else if (typeof options.action === 'string') {\n            el.onclick = function (e) {\n                e.preventDefault();\n                window.open(options.action, '_blank');\n            };\n        }\n    }\n\n    return el;\n}\n\nfunction createSep() {\n    var el = document.createElement('i');\n    el.className = 'separator';\n    el.innerHTML = '|';\n    return el;\n}\n\nfunction createTooltip(title, action, shortcuts) {\n    var actionName;\n    var tooltip = title;\n\n    if (action) {\n        actionName = getBindingName(action);\n        if (shortcuts[actionName]) {\n            tooltip += ' (' + fixShortcut(shortcuts[actionName]) + ')';\n        }\n    }\n\n    return tooltip;\n}\n\n/**\n * The state of CodeMirror at the given position.\n */\nfunction getState(cm, pos) {\n    pos = pos || cm.getCursor('start');\n    var stat = cm.getTokenAt(pos);\n    if (!stat.type) return {};\n\n    var types = stat.type.split(' ');\n\n    var ret = {},\n        data, text;\n    for (var i = 0; i < types.length; i++) {\n        data = types[i];\n        if (data === 'strong') {\n            ret.bold = true;\n        } else if (data === 'variable-2') {\n            text = cm.getLine(pos.line);\n            if (/^\\s*\\d+\\.\\s/.test(text)) {\n                ret['ordered-list'] = true;\n            } else {\n                ret['unordered-list'] = true;\n            }\n        } else if (data === 'atom') {\n            ret.quote = true;\n        } else if (data === 'em') {\n            ret.italic = true;\n        } else if (data === 'quote') {\n            ret.quote = true;\n        } else if (data === 'strikethrough') {\n            ret.strikethrough = true;\n        } else if (data === 'comment') {\n            ret.code = true;\n        } else if (data === 'link') {\n            ret.link = true;\n        } else if (data === 'tag') {\n            ret.image = true;\n        } else if (data.match(/^header(-[1-6])?$/)) {\n            ret[data.replace('header', 'heading')] = true;\n        }\n    }\n    return ret;\n}\n\n\n// Saved overflow setting\nvar saved_overflow = '';\n\n/**\n * Toggle full screen of the editor.\n */\nfunction toggleFullScreen(editor) {\n    // Set fullscreen\n    var cm = editor.codemirror;\n    cm.setOption('fullScreen', !cm.getOption('fullScreen'));\n\n\n    // Prevent scrolling on body during fullscreen active\n    if (cm.getOption('fullScreen')) {\n        saved_overflow = document.body.style.overflow;\n        document.body.style.overflow = 'hidden';\n    } else {\n        document.body.style.overflow = saved_overflow;\n    }\n\n\n    // Hide side by side if needed\n    var sidebyside = cm.getWrapperElement().nextSibling;\n    if (/editor-preview-active-side/.test(sidebyside.className))\n        toggleSideBySide(editor);\n\n    if (editor.options.onToggleFullScreen) {\n        editor.options.onToggleFullScreen(cm.getOption('fullScreen') || false);\n    }\n\n    // Remove or set maxHeight\n    if (typeof editor.options.maxHeight !== 'undefined') {\n        if (cm.getOption('fullScreen')) {\n            cm.getScrollerElement().style.removeProperty('height');\n            sidebyside.style.removeProperty('height');\n        } else {\n            cm.getScrollerElement().style.height = editor.options.maxHeight;\n            editor.setPreviewMaxHeight();\n        }\n    }\n\n\n    // Update toolbar class\n    if (!/fullscreen/.test(editor.toolbar_div.className)) {\n        editor.toolbar_div.className += ' fullscreen';\n    } else {\n        editor.toolbar_div.className = editor.toolbar_div.className.replace(/\\s*fullscreen\\b/, '');\n    }\n\n\n    // Update toolbar button\n    if (editor.toolbarElements && editor.toolbarElements.fullscreen) {\n        var toolbarButton = editor.toolbarElements.fullscreen;\n\n        if (!/active/.test(toolbarButton.className)) {\n            toolbarButton.className += ' active';\n        } else {\n            toolbarButton.className = toolbarButton.className.replace(/\\s*active\\s*/g, '');\n        }\n    }\n}\n\n\n/**\n * Action for toggling bold.\n */\nfunction toggleBold(editor) {\n    _toggleBlock(editor, 'bold', editor.options.blockStyles.bold);\n}\n\n\n/**\n * Action for toggling italic.\n */\nfunction toggleItalic(editor) {\n    _toggleBlock(editor, 'italic', editor.options.blockStyles.italic);\n}\n\n\n/**\n * Action for toggling strikethrough.\n */\nfunction toggleStrikethrough(editor) {\n    _toggleBlock(editor, 'strikethrough', '~~');\n}\n\n/**\n * Action for toggling code block.\n */\nfunction toggleCodeBlock(editor) {\n    var fenceCharsToInsert = editor.options.blockStyles.code;\n\n    function fencing_line(line) {\n        /* return true, if this is a ``` or ~~~ line */\n        if (typeof line !== 'object') {\n            throw 'fencing_line() takes a \\'line\\' object (not a line number, or line text).  Got: ' + typeof line + ': ' + line;\n        }\n        return line.styles && line.styles[2] && line.styles[2].indexOf('formatting-code-block') !== -1;\n    }\n\n    function token_state(token) {\n        // base goes an extra level deep when mode backdrops are used, e.g. spellchecker on\n        return token.state.base.base || token.state.base;\n    }\n\n    function code_type(cm, line_num, line, firstTok, lastTok) {\n        /*\n         * Return \"single\", \"indented\", \"fenced\" or false\n         *\n         * cm and line_num are required.  Others are optional for efficiency\n         *   To check in the middle of a line, pass in firstTok yourself.\n         */\n        line = line || cm.getLineHandle(line_num);\n        firstTok = firstTok || cm.getTokenAt({\n            line: line_num,\n            ch: 1,\n        });\n        lastTok = lastTok || (!!line.text && cm.getTokenAt({\n            line: line_num,\n            ch: line.text.length - 1,\n        }));\n        var types = firstTok.type ? firstTok.type.split(' ') : [];\n        if (lastTok && token_state(lastTok).indentedCode) {\n            // have to check last char, since first chars of first line aren\"t marked as indented\n            return 'indented';\n        } else if (types.indexOf('comment') === -1) {\n            // has to be after \"indented\" check, since first chars of first indented line aren\"t marked as such\n            return false;\n        } else if (token_state(firstTok).fencedChars || token_state(lastTok).fencedChars || fencing_line(line)) {\n            return 'fenced';\n        } else {\n            return 'single';\n        }\n    }\n\n    function insertFencingAtSelection(cm, cur_start, cur_end, fenceCharsToInsert) {\n        var start_line_sel = cur_start.line + 1,\n            end_line_sel = cur_end.line + 1,\n            sel_multi = cur_start.line !== cur_end.line,\n            repl_start = fenceCharsToInsert + '\\n',\n            repl_end = '\\n' + fenceCharsToInsert;\n        if (sel_multi) {\n            end_line_sel++;\n        }\n        // handle last char including \\n or not\n        if (sel_multi && cur_end.ch === 0) {\n            repl_end = fenceCharsToInsert + '\\n';\n            end_line_sel--;\n        }\n        _replaceSelection(cm, false, [repl_start, repl_end]);\n        cm.setSelection({\n            line: start_line_sel,\n            ch: 0,\n        }, {\n            line: end_line_sel,\n            ch: 0,\n        });\n    }\n\n    var cm = editor.codemirror,\n        cur_start = cm.getCursor('start'),\n        cur_end = cm.getCursor('end'),\n        tok = cm.getTokenAt({\n            line: cur_start.line,\n            ch: cur_start.ch || 1,\n        }), // avoid ch 0 which is a cursor pos but not token\n        line = cm.getLineHandle(cur_start.line),\n        is_code = code_type(cm, cur_start.line, line, tok);\n    var block_start, block_end, lineCount;\n\n    if (is_code === 'single') {\n        // similar to some EasyMDE _toggleBlock logic\n        var start = line.text.slice(0, cur_start.ch).replace('`', ''),\n            end = line.text.slice(cur_start.ch).replace('`', '');\n        cm.replaceRange(start + end, {\n            line: cur_start.line,\n            ch: 0,\n        }, {\n            line: cur_start.line,\n            ch: 99999999999999,\n        });\n        cur_start.ch--;\n        if (cur_start !== cur_end) {\n            cur_end.ch--;\n        }\n        cm.setSelection(cur_start, cur_end);\n        cm.focus();\n    } else if (is_code === 'fenced') {\n        if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n            // use selection\n\n            // find the fenced line so we know what type it is (tilde, backticks, number of them)\n            for (block_start = cur_start.line; block_start >= 0; block_start--) {\n                line = cm.getLineHandle(block_start);\n                if (fencing_line(line)) {\n                    break;\n                }\n            }\n            var fencedTok = cm.getTokenAt({\n                line: block_start,\n                ch: 1,\n            });\n            var fence_chars = token_state(fencedTok).fencedChars;\n            var start_text, start_line;\n            var end_text, end_line;\n            // check for selection going up against fenced lines, in which case we don't want to add more fencing\n            if (fencing_line(cm.getLineHandle(cur_start.line))) {\n                start_text = '';\n                start_line = cur_start.line;\n            } else if (fencing_line(cm.getLineHandle(cur_start.line - 1))) {\n                start_text = '';\n                start_line = cur_start.line - 1;\n            } else {\n                start_text = fence_chars + '\\n';\n                start_line = cur_start.line;\n            }\n            if (fencing_line(cm.getLineHandle(cur_end.line))) {\n                end_text = '';\n                end_line = cur_end.line;\n                if (cur_end.ch === 0) {\n                    end_line += 1;\n                }\n            } else if (cur_end.ch !== 0 && fencing_line(cm.getLineHandle(cur_end.line + 1))) {\n                end_text = '';\n                end_line = cur_end.line + 1;\n            } else {\n                end_text = fence_chars + '\\n';\n                end_line = cur_end.line + 1;\n            }\n            if (cur_end.ch === 0) {\n                // full last line selected, putting cursor at beginning of next\n                end_line -= 1;\n            }\n            cm.operation(function () {\n                // end line first, so that line numbers don't change\n                cm.replaceRange(end_text, {\n                    line: end_line,\n                    ch: 0,\n                }, {\n                    line: end_line + (end_text ? 0 : 1),\n                    ch: 0,\n                });\n                cm.replaceRange(start_text, {\n                    line: start_line,\n                    ch: 0,\n                }, {\n                    line: start_line + (start_text ? 0 : 1),\n                    ch: 0,\n                });\n            });\n            cm.setSelection({\n                line: start_line + (start_text ? 1 : 0),\n                ch: 0,\n            }, {\n                line: end_line + (start_text ? 1 : -1),\n                ch: 0,\n            });\n            cm.focus();\n        } else {\n            // no selection, search for ends of this fenced block\n            var search_from = cur_start.line;\n            if (fencing_line(cm.getLineHandle(cur_start.line))) { // gets a little tricky if cursor is right on a fenced line\n                if (code_type(cm, cur_start.line + 1) === 'fenced') {\n                    block_start = cur_start.line;\n                    search_from = cur_start.line + 1; // for searching for \"end\"\n                } else {\n                    block_end = cur_start.line;\n                    search_from = cur_start.line - 1; // for searching for \"start\"\n                }\n            }\n            if (block_start === undefined) {\n                for (block_start = search_from; block_start >= 0; block_start--) {\n                    line = cm.getLineHandle(block_start);\n                    if (fencing_line(line)) {\n                        break;\n                    }\n                }\n            }\n            if (block_end === undefined) {\n                lineCount = cm.lineCount();\n                for (block_end = search_from; block_end < lineCount; block_end++) {\n                    line = cm.getLineHandle(block_end);\n                    if (fencing_line(line)) {\n                        break;\n                    }\n                }\n            }\n            cm.operation(function () {\n                cm.replaceRange('', {\n                    line: block_start,\n                    ch: 0,\n                }, {\n                    line: block_start + 1,\n                    ch: 0,\n                });\n                cm.replaceRange('', {\n                    line: block_end - 1,\n                    ch: 0,\n                }, {\n                    line: block_end,\n                    ch: 0,\n                });\n            });\n            cm.focus();\n        }\n    } else if (is_code === 'indented') {\n        if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n            // use selection\n            block_start = cur_start.line;\n            block_end = cur_end.line;\n            if (cur_end.ch === 0) {\n                block_end--;\n            }\n        } else {\n            // no selection, search for ends of this indented block\n            for (block_start = cur_start.line; block_start >= 0; block_start--) {\n                line = cm.getLineHandle(block_start);\n                if (line.text.match(/^\\s*$/)) {\n                    // empty or all whitespace - keep going\n                    continue;\n                } else {\n                    if (code_type(cm, block_start, line) !== 'indented') {\n                        block_start += 1;\n                        break;\n                    }\n                }\n            }\n            lineCount = cm.lineCount();\n            for (block_end = cur_start.line; block_end < lineCount; block_end++) {\n                line = cm.getLineHandle(block_end);\n                if (line.text.match(/^\\s*$/)) {\n                    // empty or all whitespace - keep going\n                    continue;\n                } else {\n                    if (code_type(cm, block_end, line) !== 'indented') {\n                        block_end -= 1;\n                        break;\n                    }\n                }\n            }\n        }\n        // if we are going to un-indent based on a selected set of lines, and the next line is indented too, we need to\n        // insert a blank line so that the next line(s) continue to be indented code\n        var next_line = cm.getLineHandle(block_end + 1),\n            next_line_last_tok = next_line && cm.getTokenAt({\n                line: block_end + 1,\n                ch: next_line.text.length - 1,\n            }),\n            next_line_indented = next_line_last_tok && token_state(next_line_last_tok).indentedCode;\n        if (next_line_indented) {\n            cm.replaceRange('\\n', {\n                line: block_end + 1,\n                ch: 0,\n            });\n        }\n\n        for (var i = block_start; i <= block_end; i++) {\n            cm.indentLine(i, 'subtract'); // TODO: this doesn't get tracked in the history, so can't be undone :(\n        }\n        cm.focus();\n    } else {\n        // insert code formatting\n        var no_sel_and_starting_of_line = (cur_start.line === cur_end.line && cur_start.ch === cur_end.ch && cur_start.ch === 0);\n        var sel_multi = cur_start.line !== cur_end.line;\n        if (no_sel_and_starting_of_line || sel_multi) {\n            insertFencingAtSelection(cm, cur_start, cur_end, fenceCharsToInsert);\n        } else {\n            _replaceSelection(cm, false, ['`', '`']);\n        }\n    }\n}\n\nfunction toggleSecretBlock(editor) {\n    const secretChars = editor.options.blockStyles.secret;    \n    let cm = editor.codemirror;\n    const text = cm.getSelection();\n    let cur_start = cm.getCursor('start'),\n        cur_end = cm.getCursor('end');\n\n    if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n        const start_line = cur_start.line,\n              end_line = cur_end.line,\n              end_text = cm.getLineHandle(end_line).text;\n        const orig_text = cm.getRange({line: cur_start.line, ch: 0}, {line: cur_end.line, ch: end_text.length}),\n                cap = rules.block.secret.exec(orig_text);\n        let new_text = orig_text,\n            head, anchor;\n        // remove  $$$ from start and finish if whole selection encompasses exactly one secret block\n        if (cap && cap[0].length === orig_text.length) {\n            new_text = cap[3];\n            head = {line: end_line - 2 , ch: cm.getLineHandle(end_line-1).text.length};\n            anchor = {line: start_line, ch: 0};\n        } else {\n            // Else add  $$$ at start and finish of block\n            new_text = '\\n' + secretChars + '\\n' + orig_text + '\\n' + secretChars + '\\n';\n            anchor = {line: start_line + 1, ch: 0};\n            head = {line: end_line + 3, ch: 3};\n        }\n        cm.replaceRange(new_text, {line: cur_start.line, ch: 0}, {line: cur_end.line, ch: end_text.length});\n        cm.setSelection(anchor, head);\n    } else // no selection? just add secret block chars\n        cm.replaceSelection('\\n' + secretChars + '\\n' + text + '\\n' + secretChars + '\\n');\n\n    cm.focus();\n}\n\n/**\n * Action for toggling blockquote.\n */\nfunction toggleBlockquote(editor) {\n    var cm = editor.codemirror;\n    _toggleLine(cm, 'quote');\n}\n\n/**\n * Action for toggling heading size: normal -> h1 -> h2 -> h3 -> h4 -> h5 -> h6 -> normal\n */\nfunction toggleHeadingSmaller(editor) {\n    var cm = editor.codemirror;\n    _toggleHeading(cm, 'smaller');\n}\n\n/**\n * Action for toggling heading size: normal -> h6 -> h5 -> h4 -> h3 -> h2 -> h1 -> normal\n */\nfunction toggleHeadingBigger(editor) {\n    var cm = editor.codemirror;\n    _toggleHeading(cm, 'bigger');\n}\n\n/**\n * Action for toggling heading size 1\n */\nfunction toggleHeading1(editor) {\n    var cm = editor.codemirror;\n    _toggleHeading(cm, undefined, 1);\n}\n\n/**\n * Action for toggling heading size 2\n */\nfunction toggleHeading2(editor) {\n    var cm = editor.codemirror;\n    _toggleHeading(cm, undefined, 2);\n}\n\n/**\n * Action for toggling heading size 3\n */\nfunction toggleHeading3(editor) {\n    var cm = editor.codemirror;\n    _toggleHeading(cm, undefined, 3);\n}\n\n\n/**\n * Action for toggling ul.\n */\nfunction toggleUnorderedList(editor) {\n    var cm = editor.codemirror;\n    _toggleLine(cm, 'unordered-list');\n}\n\n\n/**\n * Action for toggling ol.\n */\nfunction toggleOrderedList(editor) {\n    var cm = editor.codemirror;\n    _toggleLine(cm, 'ordered-list');\n}\n\n/**\n * Action for clean block (remove headline, list, blockquote code, markers)\n */\nfunction cleanBlock(editor) {\n    var cm = editor.codemirror;\n    _cleanBlock(cm);\n}\n\n/**\n * Action for drawing a link.\n */\nfunction drawLink(editor) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    var url = 'https://';\n    if (options.promptURLs) {\n        url = prompt(options.promptTexts.link, 'https://');\n        if (!url) {\n            return false;\n        }\n    }\n    _replaceSelection(cm, stat.link, options.insertTexts.link, url);\n}\n\n/**\n * Action for drawing an img.\n */\nfunction drawImage(editor) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    var url = 'https://';\n    if (options.promptURLs) {\n        url = prompt(options.promptTexts.image, 'https://');\n        if (!url) {\n            return false;\n        }\n    }\n    _replaceSelection(cm, stat.image, options.insertTexts.image, url);\n}\n\n/**\n * Action for opening the browse-file window to upload an image to a server.\n * @param editor {EasyMDE} The EasyMDE object\n */\nfunction drawUploadedImage(editor) {\n    // TODO: Draw the image template with a fake url? ie: '![](importing foo.png...)'\n    editor.openBrowseFileWindow();\n}\n\n/**\n * Action executed after an image have been successfully imported on the server.\n * @param editor {EasyMDE} The EasyMDE object\n * @param url {string} The url of the uploaded image\n */\nfunction afterImageUploaded(editor, url) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    var imageName = url.substr(url.lastIndexOf('/') + 1);\n    _replaceSelection(cm, stat.image, options.insertTexts.uploadedImage, url);\n    // show uploaded image filename for 1000ms\n    editor.updateStatusBar('upload-image', editor.options.imageTexts.sbOnUploaded.replace('#image_name#', imageName));\n    setTimeout(function () {\n        editor.updateStatusBar('upload-image', editor.options.imageTexts.sbInit);\n    }, 1000);\n}\n\n/**\n * Action for drawing a table.\n */\nfunction drawTable(editor) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    _replaceSelection(cm, stat.table, options.insertTexts.table);\n}\n\n/**\n * Action for drawing a horizontal rule.\n */\nfunction drawHorizontalRule(editor) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    _replaceSelection(cm, stat.image, options.insertTexts.horizontalRule);\n}\n\n\n/**\n * Undo action.\n */\nfunction undo(editor) {\n    var cm = editor.codemirror;\n    cm.undo();\n    cm.focus();\n}\n\n\n/**\n * Redo action.\n */\nfunction redo(editor) {\n    var cm = editor.codemirror;\n    cm.redo();\n    cm.focus();\n}\n\n\n/**\n * Toggle side by side preview\n */\nfunction toggleSideBySide(editor) {\n    var cm = editor.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n    var toolbarButton = editor.toolbarElements && editor.toolbarElements['side-by-side'];\n    var useSideBySideListener = false;\n\n    var noFullscreenItems = [\n        wrapper.parentNode, // easyMDEContainer\n        editor.gui.toolbar,\n        wrapper,\n        preview,\n        editor.gui.statusbar,\n    ];\n\n    function addNoFullscreenClass(el) {\n        el.className += ' sided--no-fullscreen';\n    }\n\n    function removeNoFullscreenClass(el) {\n        el.className = el.className.replace(\n            /\\s*sided--no-fullscreen\\s*/g, ''\n        );\n    }\n\n    if (/editor-preview-active-side/.test(preview.className)) {\n        if (cm.getOption('sideBySideNoFullscreen')) {\n            cm.setOption('sideBySideNoFullscreen', false);\n            noFullscreenItems.forEach(function (el) {\n                removeNoFullscreenClass(el);\n            });\n        }\n        preview.className = preview.className.replace(\n            /\\s*editor-preview-active-side\\s*/g, ''\n        );\n        if (toolbarButton) toolbarButton.className = toolbarButton.className.replace(/\\s*active\\s*/g, '');\n        wrapper.className = wrapper.className.replace(/\\s*CodeMirror-sided\\s*/g, ' ');\n    } else {\n        // When the preview button is clicked for the first time,\n        // give some time for the transition from editor.css to fire and the view to slide from right to left,\n        // instead of just appearing.\n        setTimeout(function () {\n            if (!cm.getOption('fullScreen')) {\n                if (editor.options.sideBySideFullscreen === false) {\n                    cm.setOption('sideBySideNoFullscreen', true);\n                    noFullscreenItems.forEach(function(el) {\n                        addNoFullscreenClass(el);\n                    });\n                } else {\n                    toggleFullScreen(editor);\n                }\n            }\n            preview.className += ' editor-preview-active-side';\n        }, 1);\n        if (toolbarButton) toolbarButton.className += ' active';\n        wrapper.className += ' CodeMirror-sided';\n        useSideBySideListener = true;\n    }\n\n    // Hide normal preview if active\n    var previewNormal = wrapper.lastChild;\n    if (/editor-preview-active/.test(previewNormal.className)) {\n        previewNormal.className = previewNormal.className.replace(\n            /\\s*editor-preview-active\\s*/g, ''\n        );\n        var toolbar = editor.toolbarElements.preview;\n        var toolbar_div = editor.toolbar_div;\n        toolbar.className = toolbar.className.replace(/\\s*active\\s*/g, '');\n        toolbar_div.className = toolbar_div.className.replace(/\\s*disabled-for-preview*/g, '');\n    }\n\n    var sideBySideRenderingFunction = function () {\n        var newValue = editor.options.previewRender(editor.value(), preview);\n        if (newValue != null) {\n            preview.innerHTML = newValue;\n        }\n    };\n\n    if (!cm.sideBySideRenderingFunction) {\n        cm.sideBySideRenderingFunction = sideBySideRenderingFunction;\n    }\n\n    if (useSideBySideListener) {\n        var newValue = editor.options.previewRender(editor.value(), preview);\n        if (newValue != null) {\n            preview.innerHTML = newValue;\n        }\n        cm.on('update', cm.sideBySideRenderingFunction);\n    } else {\n        cm.off('update', cm.sideBySideRenderingFunction);\n    }\n\n    // Refresh to fix selection being off (#309)\n    cm.refresh();\n}\n\n\n/**\n * Preview action.\n */\nfunction togglePreview(editor) {\n    var cm = editor.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var toolbar_div = editor.toolbar_div;\n    var toolbar = editor.options.toolbar ? editor.toolbarElements.preview : false;\n    var preview = wrapper.lastChild;\n\n    // Turn off side by side if needed\n    var sidebyside = cm.getWrapperElement().nextSibling;\n    if (/editor-preview-active-side/.test(sidebyside.className))\n        toggleSideBySide(editor);\n\n    if (!preview || !/editor-preview-full/.test(preview.className)) {\n\n        preview = document.createElement('div');\n        preview.className = 'editor-preview-full';\n\n        if (editor.options.previewClass) {\n\n            if (Array.isArray(editor.options.previewClass)) {\n                for (var i = 0; i < editor.options.previewClass.length; i++) {\n                    preview.className += (' ' + editor.options.previewClass[i]);\n                }\n\n            } else if (typeof editor.options.previewClass === 'string') {\n                preview.className += (' ' + editor.options.previewClass);\n            }\n        }\n\n        wrapper.appendChild(preview);\n    }\n\n    if (/editor-preview-active/.test(preview.className)) {\n        preview.className = preview.className.replace(\n            /\\s*editor-preview-active\\s*/g, ''\n        );\n        if (toolbar) {\n            toolbar.className = toolbar.className.replace(/\\s*active\\s*/g, '');\n            toolbar_div.className = toolbar_div.className.replace(/\\s*disabled-for-preview*/g, '');\n        }\n\n        // FVTT Change\n        // Remove the extra CSS class to toggle code div visibility\n        wrapper.classList.remove('preview-active');\n    } else {\n        // When the preview button is clicked for the first time,\n        // give some time for the transition from editor.css to fire and the view to slide from right to left,\n        // instead of just appearing.\n        setTimeout(function () {\n            preview.className += ' editor-preview-active';\n        }, 1);\n        if (toolbar) {\n            toolbar.className += ' active';\n            toolbar_div.className += ' disabled-for-preview';\n        }\n        // FVTT Change\n        // Add the extra CSS class to toggle code div visibility\n        wrapper.className += ' preview-active';\n    }\n    preview.innerHTML = editor.options.previewRender(editor.value(), preview);\n\n}\n\nfunction _replaceSelection(cm, active, startEnd, url) {\n    if (/editor-preview-active/.test(cm.getWrapperElement().lastChild.className))\n        return;\n\n    var text;\n    var start = startEnd[0];\n    var end = startEnd[1];\n    var startPoint = {},\n        endPoint = {};\n    Object.assign(startPoint, cm.getCursor('start'));\n    Object.assign(endPoint, cm.getCursor('end'));\n    if (url) {\n        start = start.replace('#url#', url);  // url is in start for upload-image\n        end = end.replace('#url#', url);\n    }\n    if (active) {\n        text = cm.getLine(startPoint.line);\n        start = text.slice(0, startPoint.ch);\n        end = text.slice(startPoint.ch);\n        cm.replaceRange(start + end, {\n            line: startPoint.line,\n            ch: 0,\n        });\n    } else {\n        text = cm.getSelection();\n        cm.replaceSelection(start + text + end);\n\n        startPoint.ch += start.length;\n        if (startPoint !== endPoint) {\n            endPoint.ch += start.length;\n        }\n    }\n    cm.setSelection(startPoint, endPoint);\n    cm.focus();\n}\n\n\nfunction _toggleHeading(cm, direction, size) {\n    if (/editor-preview-active/.test(cm.getWrapperElement().lastChild.className))\n        return;\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    for (var i = startPoint.line; i <= endPoint.line; i++) {\n        (function (i) {\n            var text = cm.getLine(i);\n            var currHeadingLevel = text.search(/[^#]/);\n\n            if (direction !== undefined) {\n                if (currHeadingLevel <= 0) {\n                    if (direction == 'bigger') {\n                        text = '###### ' + text;\n                    } else {\n                        text = '# ' + text;\n                    }\n                } else if (currHeadingLevel == 6 && direction == 'smaller') {\n                    text = text.substr(7);\n                } else if (currHeadingLevel == 1 && direction == 'bigger') {\n                    text = text.substr(2);\n                } else {\n                    if (direction == 'bigger') {\n                        text = text.substr(1);\n                    } else {\n                        text = '#' + text;\n                    }\n                }\n            } else {\n                if (size == 1) {\n                    if (currHeadingLevel <= 0) {\n                        text = '# ' + text;\n                    } else if (currHeadingLevel == size) {\n                        text = text.substr(currHeadingLevel + 1);\n                    } else {\n                        text = '# ' + text.substr(currHeadingLevel + 1);\n                    }\n                } else if (size == 2) {\n                    if (currHeadingLevel <= 0) {\n                        text = '## ' + text;\n                    } else if (currHeadingLevel == size) {\n                        text = text.substr(currHeadingLevel + 1);\n                    } else {\n                        text = '## ' + text.substr(currHeadingLevel + 1);\n                    }\n                } else {\n                    if (currHeadingLevel <= 0) {\n                        text = '### ' + text;\n                    } else if (currHeadingLevel == size) {\n                        text = text.substr(currHeadingLevel + 1);\n                    } else {\n                        text = '### ' + text.substr(currHeadingLevel + 1);\n                    }\n                }\n            }\n\n            cm.replaceRange(text, {\n                line: i,\n                ch: 0,\n            }, {\n                line: i,\n                ch: 99999999999999,\n            });\n        })(i);\n    }\n    cm.focus();\n}\n\n\nfunction _toggleLine(cm, name) {\n    if (/editor-preview-active/.test(cm.getWrapperElement().lastChild.className))\n        return;\n\n    var listRegexp = /^(\\s*)(\\*|-|\\+|\\d*\\.)(\\s+)/;\n    var whitespacesRegexp = /^\\s*/;\n\n    var stat = getState(cm);\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    var repl = {\n        'quote': /^(\\s*)>\\s+/,\n        'unordered-list': listRegexp,\n        'ordered-list': listRegexp,\n    };\n\n    var _getChar = function (name, i) {\n        var map = {\n            'quote': '>',\n            'unordered-list': '*',\n            'ordered-list': '%%i.',\n        };\n\n        return map[name].replace('%%i', i);\n    };\n\n    var _checkChar = function (name, char) {\n        var map = {\n            'quote': '>',\n            'unordered-list': '*',\n            'ordered-list': '\\\\d+.',\n        };\n        var rt = new RegExp(map[name]);\n\n        return char && rt.test(char);\n    };\n\n    var _toggle = function (name, text, untoggleOnly) {\n        var arr = listRegexp.exec(text);\n        var char = _getChar(name, line);\n        if (arr !== null) {\n            if (_checkChar(name, arr[2])) {\n                char = '';\n            }\n            text = arr[1] + char + arr[3] + text.replace(whitespacesRegexp, '').replace(repl[name], '$1');\n        } else if (untoggleOnly == false) {\n            text = char + ' ' + text;\n        }\n        return text;\n    };\n\n    var line = 1;\n    for (var i = startPoint.line; i <= endPoint.line; i++) {\n        (function (i) {\n            var text = cm.getLine(i);\n            if (stat[name]) {\n                text = text.replace(repl[name], '$1');\n            } else {\n                // If we're toggling unordered-list formatting, check if the current line\n                // is part of an ordered-list, and if so, untoggle that first.\n                // Workaround for https://github.com/Ionaru/easy-markdown-editor/issues/92\n                if (name == 'unordered-list') {\n                    text = _toggle('ordered-list', text, true);\n                }\n                text = _toggle(name, text, false);\n                line += 1;\n            }\n            cm.replaceRange(text, {\n                line: i,\n                ch: 0,\n            }, {\n                line: i,\n                ch: 99999999999999,\n            });\n        })(i);\n    }\n    cm.focus();\n}\n\nfunction _toggleBlock(editor, type, start_chars, end_chars) {\n    if (/editor-preview-active/.test(editor.codemirror.getWrapperElement().lastChild.className))\n        return;\n\n    end_chars = (typeof end_chars === 'undefined') ? start_chars : end_chars;\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n\n    var text;\n    var start = start_chars;\n    var end = end_chars;\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n\n    if (stat[type]) {\n        text = cm.getLine(startPoint.line);\n        start = text.slice(0, startPoint.ch);\n        end = text.slice(startPoint.ch);\n        if (type == 'bold') {\n            start = start.replace(/(\\*\\*|__)(?![\\s\\S]*(\\*\\*|__))/, '');\n            end = end.replace(/(\\*\\*|__)/, '');\n        } else if (type == 'italic') {\n            start = start.replace(/(\\*|_)(?![\\s\\S]*(\\*|_))/, '');\n            end = end.replace(/(\\*|_)/, '');\n        } else if (type == 'strikethrough') {\n            start = start.replace(/(\\*\\*|~~)(?![\\s\\S]*(\\*\\*|~~))/, '');\n            end = end.replace(/(\\*\\*|~~)/, '');\n        }\n        cm.replaceRange(start + end, {\n            line: startPoint.line,\n            ch: 0,\n        }, {\n            line: startPoint.line,\n            ch: 99999999999999,\n        });\n\n        if (type == 'bold' || type == 'strikethrough') {\n            startPoint.ch -= 2;\n            if (startPoint !== endPoint) {\n                endPoint.ch -= 2;\n            }\n        } else if (type == 'italic') {\n            startPoint.ch -= 1;\n            if (startPoint !== endPoint) {\n                endPoint.ch -= 1;\n            }\n        }\n    } else {\n        text = cm.getSelection();\n        if (type == 'bold') {\n            text = text.split('**').join('');\n            text = text.split('__').join('');\n        } else if (type == 'italic') {\n            text = text.split('*').join('');\n            text = text.split('_').join('');\n        } else if (type == 'strikethrough') {\n            text = text.split('~~').join('');\n        }\n        cm.replaceSelection(start + text + end);\n\n        startPoint.ch += start_chars.length;\n        endPoint.ch = startPoint.ch + text.length;\n    }\n\n    cm.setSelection(startPoint, endPoint);\n    cm.focus();\n}\n\nfunction _cleanBlock(cm) {\n    if (/editor-preview-active/.test(cm.getWrapperElement().lastChild.className))\n        return;\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    var text;\n\n    for (var line = startPoint.line; line <= endPoint.line; line++) {\n        text = cm.getLine(line);\n        text = text.replace(/^[ ]*([# ]+|\\*|-|[> ]+|[0-9]+(.|\\)))[ ]*/, '');\n\n        cm.replaceRange(text, {\n            line: line,\n            ch: 0,\n        }, {\n            line: line,\n            ch: 99999999999999,\n        });\n    }\n}\n\n/**\n * Convert a number of bytes to a human-readable file size.\n * @param bytes {integer} A number of bytes, as integer. Ex: 421137\n * @param units {number[]} An array of human-readable units, ie. ['b', 'Kb', 'Mb']\n * @returns string A human-readable file size. Ex: '412Kb'\n */\nfunction humanFileSize(bytes, units) {\n    if (Math.abs(bytes) < 1024) {\n        return '' + bytes + units[0];\n    }\n    var u = 0;\n    do {\n        bytes /= 1024;\n        ++u;\n    } while (Math.abs(bytes) >= 1024 && u < units.length);\n    return '' + bytes.toFixed(1) + units[u];\n}\n\n// Merge the properties of one object into another.\nfunction _mergeProperties(target, source) {\n    for (var property in source) {\n        if (Object.prototype.hasOwnProperty.call(source, property)) {\n            if (source[property] instanceof Array) {\n                target[property] = source[property].concat(target[property] instanceof Array ? target[property] : []);\n            } else if (\n                source[property] !== null &&\n                typeof source[property] === 'object' &&\n                source[property].constructor === Object\n            ) {\n                target[property] = _mergeProperties(target[property] || {}, source[property]);\n            } else {\n                target[property] = source[property];\n            }\n        }\n    }\n\n    return target;\n}\n\n// Merge an arbitrary number of objects into one.\nfunction extend(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        target = _mergeProperties(target, arguments[i]);\n    }\n\n    return target;\n}\n\n/* The right word count in respect for CJK. */\nfunction wordCount(data) {\n    var pattern = /[a-zA-Z0-9_\\u00A0-\\u02AF\\u0392-\\u03c9\\u0410-\\u04F9]+|[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af]+/g;\n    var m = data.match(pattern);\n    var count = 0;\n    if (m === null) return count;\n    for (var i = 0; i < m.length; i++) {\n        if (m[i].charCodeAt(0) >= 0x4E00) {\n            count += m[i].length;\n        } else {\n            count += 1;\n        }\n    }\n    return count;\n}\n\nvar toolbarBuiltInButtons = {\n    'bold': {\n        name: 'bold',\n        action: toggleBold,\n        className: 'fa fa-bold',\n        title: 'Bold',\n        default: true,\n    },\n    'italic': {\n        name: 'italic',\n        action: toggleItalic,\n        className: 'fa fa-italic',\n        title: 'Italic',\n        default: true,\n    },\n    'strikethrough': {\n        name: 'strikethrough',\n        action: toggleStrikethrough,\n        className: 'fa fa-strikethrough',\n        title: 'Strikethrough',\n    },\n    'heading': {\n        name: 'heading',\n        action: toggleHeadingSmaller,\n        className: 'fa fa-header fa-heading',\n        title: 'Heading',\n        default: true,\n    },\n    'heading-smaller': {\n        name: 'heading-smaller',\n        action: toggleHeadingSmaller,\n        className: 'fa fa-header fa-heading header-smaller',\n        title: 'Smaller Heading',\n    },\n    'heading-bigger': {\n        name: 'heading-bigger',\n        action: toggleHeadingBigger,\n        className: 'fa fa-header fa-heading header-bigger',\n        title: 'Bigger Heading',\n    },\n    'heading-1': {\n        name: 'heading-1',\n        action: toggleHeading1,\n        className: 'fa fa-header fa-heading header-1',\n        title: 'Big Heading',\n    },\n    'heading-2': {\n        name: 'heading-2',\n        action: toggleHeading2,\n        className: 'fa fa-header fa-heading header-2',\n        title: 'Medium Heading',\n    },\n    'heading-3': {\n        name: 'heading-3',\n        action: toggleHeading3,\n        className: 'fa fa-header fa-heading header-3',\n        title: 'Small Heading',\n    },\n    'separator-1': {\n        name: 'separator-1',\n    },\n    'code': {\n        name: 'code',\n        action: toggleCodeBlock,\n        className: 'fa fa-code',\n        title: 'Code',\n    },\n    'quote': {\n        name: 'quote',\n        action: toggleBlockquote,\n        className: 'fa fa-quote-left',\n        title: 'Quote',\n        default: true,\n    },\n    'unordered-list': {\n        name: 'unordered-list',\n        action: toggleUnorderedList,\n        className: 'fa fa-list-ul',\n        title: 'Generic List',\n        default: true,\n    },\n    'ordered-list': {\n        name: 'ordered-list',\n        action: toggleOrderedList,\n        className: 'fa fa-list-ol',\n        title: 'Numbered List',\n        default: true,\n    },\n    'clean-block': {\n        name: 'clean-block',\n        action: cleanBlock,\n        className: 'fa fa-eraser',\n        title: 'Clean block',\n    },\n    'separator-2': {\n        name: 'separator-2',\n    },\n    'link': {\n        name: 'link',\n        action: drawLink,\n        className: 'fa fa-link',\n        title: 'Create Link',\n        default: true,\n    },\n    'image': {\n        name: 'image',\n        action: drawImage,\n        className: 'fa fa-image',\n        title: 'Insert Image',\n        default: true,\n    },\n    'upload-image': {\n        name: 'upload-image',\n        action: drawUploadedImage,\n        className: 'fa fa-image',\n        title: 'Import an image',\n    },\n    'table': {\n        name: 'table',\n        action: drawTable,\n        className: 'fa fa-table',\n        title: 'Insert Table',\n    },\n    'horizontal-rule': {\n        name: 'horizontal-rule',\n        action: drawHorizontalRule,\n        className: 'fa fa-minus',\n        title: 'Insert Horizontal Line',\n    },\n    'separator-3': {\n        name: 'separator-3',\n    },\n    'preview': {\n        name: 'preview',\n        action: togglePreview,\n        className: 'fa fa-eye',\n        noDisable: true,\n        title: 'Toggle Preview',\n        default: true,\n    },\n    'side-by-side': {\n        name: 'side-by-side',\n        action: toggleSideBySide,\n        className: 'fa fa-columns',\n        noDisable: true,\n        noMobile: true,\n        title: 'Toggle Side by Side',\n        default: true,\n    },\n    'fullscreen': {\n        name: 'fullscreen',\n        action: toggleFullScreen,\n        className: 'fa fa-arrows-alt',\n        noDisable: true,\n        noMobile: true,\n        title: 'Toggle Fullscreen',\n        default: true,\n    },\n    'separator-4': {\n        name: 'separator-4',\n    },\n    'guide': {\n        name: 'guide',\n        action: 'https://www.markdownguide.org/basic-syntax/',\n        className: 'fa fa-question-circle',\n        noDisable: true,\n        title: 'Markdown Guide',\n        default: true,\n    },\n    'separator-5': {\n        name: 'separator-5',\n    },\n    'undo': {\n        name: 'undo',\n        action: undo,\n        className: 'fa fa-undo',\n        noDisable: true,\n        title: 'Undo',\n    },\n    'redo': {\n        name: 'redo',\n        action: redo,\n        className: 'fa fa-repeat fa-redo',\n        noDisable: true,\n        title: 'Redo',\n    },\n};\n\nvar insertTexts = {\n    link: ['[', '](#url#)'],\n    image: ['![](', '#url#)'],\n    uploadedImage: ['![](#url#)', ''],\n    // uploadedImage: ['![](#url#)\\n', ''], // TODO: New line insertion doesn't work here.\n    table: ['', '\\n\\n| Column 1 | Column 2 | Column 3 |\\n| -------- | -------- | -------- |\\n| Text     | Text     | Text     |\\n\\n'],\n    horizontalRule: ['', '\\n\\n-----\\n\\n'],\n};\n\nvar promptTexts = {\n    link: 'URL for the link:',\n    image: 'URL of the image:',\n};\n\nvar timeFormat = {\n    locale: 'en-US',\n    format: {\n        hour: '2-digit',\n        minute: '2-digit',\n    },\n};\n\nvar blockStyles = {\n    'bold': '**',\n    'code': '```',\n    'italic': '*',\n    'secret': '$$$'\n};\n\n/**\n * Texts displayed to the user (mainly on the status bar) for the import image\n * feature. Can be used for customization or internationalization.\n */\nvar imageTexts = {\n    sbInit: 'Attach files by drag and dropping or pasting from clipboard.',\n    sbOnDragEnter: 'Drop image to upload it.',\n    sbOnDrop: 'Uploading image #images_names#...',\n    sbProgress: 'Uploading #file_name#: #progress#%',\n    sbOnUploaded: 'Uploaded #image_name#',\n    sizeUnits: 'b,Kb,Mb',\n};\n\n/**\n * Errors displayed to the user, using the `errorCallback` option. Can be used for\n * customization or internationalization.\n */\nvar errorMessages = {\n    noFileGiven: 'You must select a file.',\n    typeNotAllowed: 'This image type is not allowed.',\n    fileTooLarge: 'Image #image_name# is too big (#image_size#).\\n' +\n        'Maximum file size is #image_max_size#.',\n    importError: 'Something went wrong when uploading the image #image_name#.',\n};\n\n/**\n * Interface of EasyMDE.\n */\nfunction EasyMDE(options) {\n    // Handle options parameter\n    options = options || {};\n\n    // Used later to refer to it\"s parent\n    options.parent = this;\n\n    // Check if Font Awesome needs to be auto downloaded\n    var autoDownloadFA = true;\n\n    if (options.autoDownloadFontAwesome === false) {\n        autoDownloadFA = false;\n    }\n\n    if (options.autoDownloadFontAwesome !== true) {\n        var styleSheets = document.styleSheets;\n        for (var i = 0; i < styleSheets.length; i++) {\n            if (!styleSheets[i].href)\n                continue;\n\n            if (styleSheets[i].href.indexOf('//maxcdn.bootstrapcdn.com/font-awesome/') > -1) {\n                autoDownloadFA = false;\n            }\n        }\n    }\n\n    if (autoDownloadFA) {\n        var link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.href = 'https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css';\n        document.getElementsByTagName('head')[0].appendChild(link);\n    }\n\n\n    // Find the textarea to use\n    if (options.element) {\n        this.element = options.element;\n    } else if (options.element === null) {\n        // This means that the element option was specified, but no element was found\n        console.log('EasyMDE: Error. No element was found.');\n        return;\n    }\n\n\n    // Handle toolbar\n    if (options.toolbar === undefined) {\n        // Initialize\n        options.toolbar = [];\n\n\n        // Loop over the built in buttons, to get the preferred order\n        for (var key in toolbarBuiltInButtons) {\n            if (Object.prototype.hasOwnProperty.call(toolbarBuiltInButtons, key)) {\n                if (key.indexOf('separator-') != -1) {\n                    options.toolbar.push('|');\n                }\n\n                if (toolbarBuiltInButtons[key].default === true || (options.showIcons && options.showIcons.constructor === Array && options.showIcons.indexOf(key) != -1)) {\n                    options.toolbar.push(key);\n                }\n            }\n        }\n    }\n\n    // Editor preview styling class.\n    if (!Object.prototype.hasOwnProperty.call(options, 'previewClass')) {\n        options.previewClass = 'editor-preview';\n    }\n\n    // Handle status bar\n    if (!Object.prototype.hasOwnProperty.call(options, 'status')) {\n        options.status = ['autosave', 'lines', 'words', 'cursor'];\n\n        if (options.uploadImage) {\n            options.status.unshift('upload-image');\n        }\n    }\n\n\n    // Add default preview rendering function\n    if (!options.previewRender) {\n        options.previewRender = function (plainText) {\n            // Note: \"this\" refers to the options object\n            return this.parent.markdown(plainText);\n        };\n    }\n\n\n    // Set default options for parsing config\n    options.parsingConfig = extend({\n        highlightFormatting: true, // needed for toggleCodeBlock to detect types of code\n    }, options.parsingConfig || {});\n\n\n    // Merging the insertTexts, with the given options\n    options.insertTexts = extend({}, insertTexts, options.insertTexts || {});\n\n\n    // Merging the promptTexts, with the given options\n    options.promptTexts = extend({}, promptTexts, options.promptTexts || {});\n\n\n    // Merging the blockStyles, with the given options\n    options.blockStyles = extend({}, blockStyles, options.blockStyles || {});\n\n\n    if (options.autosave != undefined) {\n        // Merging the Autosave timeFormat, with the given options\n        options.autosave.timeFormat = extend({}, timeFormat, options.autosave.timeFormat || {});\n    }\n\n\n    // Merging the shortcuts, with the given options\n    options.shortcuts = extend({}, shortcuts, options.shortcuts || {});\n\n    options.minHeight = options.minHeight || '300px';\n    options.maxHeight = options.maxHeight || undefined;\n\n    options.errorCallback = options.errorCallback || function (errorMessage) {\n        alert(errorMessage);\n    };\n\n    // Import-image default configuration\n    options.uploadImage = options.uploadImage || false;\n    options.imageMaxSize = options.imageMaxSize || 2097152; // 1024 * 1024 * 2\n    options.imageAccept = options.imageAccept || 'image/png, image/jpeg';\n    options.imageTexts = extend({}, imageTexts, options.imageTexts || {});\n    options.errorMessages = extend({}, errorMessages, options.errorMessages || {});\n\n\n    // Change unique_id to uniqueId for backwards compatibility\n    if (options.autosave != undefined && options.autosave.unique_id != undefined && options.autosave.unique_id != '')\n        options.autosave.uniqueId = options.autosave.unique_id;\n\n\n    // Update this options\n    this.options = options;\n\n\n    // Auto render\n    this.render();\n\n\n    // The codemirror component is only available after rendering\n    // so, the setter for the initialValue can only run after\n    // the element has been rendered\n    if (options.initialValue && (!this.options.autosave || this.options.autosave.foundSavedValue !== true)) {\n        this.value(options.initialValue);\n    }\n\n    if (options.uploadImage) {\n        var self = this;\n\n        this.codemirror.on('dragenter', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbOnDragEnter);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n        this.codemirror.on('dragend', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n        this.codemirror.on('dragleave', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n\n        this.codemirror.on('dragover', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbOnDragEnter);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n\n        this.codemirror.on('drop', function (cm, event) {\n            event.stopPropagation();\n            event.preventDefault();\n            if (options.imageUploadFunction) {\n                self.uploadImagesUsingCustomFunction(options.imageUploadFunction, event.dataTransfer.files);\n            } else {\n                self.uploadImages(event.dataTransfer.files);\n            }\n        });\n\n        this.codemirror.on('paste', function (cm, event) {\n            if (options.imageUploadFunction) {\n                self.uploadImagesUsingCustomFunction(options.imageUploadFunction, event.clipboardData.files);\n            } else {\n                self.uploadImages(event.clipboardData.files);\n            }\n        });\n    }\n}\n\n/**\n * Upload asynchronously a list of images to a server.\n *\n * Can be triggered by:\n * - drag&drop;\n * - copy-paste;\n * - the browse-file window (opened when the user clicks on the *upload-image* icon).\n * @param {FileList} files The files to upload the the server.\n * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage\n * @param [onError] {function} see EasyMDE.prototype.uploadImage\n */\nEasyMDE.prototype.uploadImages = function (files, onSuccess, onError) {\n    if (files.length === 0) {\n      return;\n    }\n    var names = [];\n    for (var i = 0; i < files.length; i++) {\n        names.push(files[i].name);\n        this.uploadImage(files[i], onSuccess, onError);\n    }\n    this.updateStatusBar('upload-image', this.options.imageTexts.sbOnDrop.replace('#images_names#', names.join(', ')));\n};\n\n/**\n * Upload asynchronously a list of images to a server.\n *\n * Can be triggered by:\n * - drag&drop;\n * - copy-paste;\n * - the browse-file window (opened when the user clicks on the *upload-image* icon).\n * @param imageUploadFunction {Function} The custom function to upload the image passed in options.\n * @param {FileList} files The files to upload the the server.\n */\nEasyMDE.prototype.uploadImagesUsingCustomFunction = function (imageUploadFunction, files) {\n    if (files.length === 0) {\n      return;\n    }\n    var names = [];\n    for (var i = 0; i < files.length; i++) {\n        names.push(files[i].name);\n        this.uploadImageUsingCustomFunction(imageUploadFunction, files[i]);\n    }\n    this.updateStatusBar('upload-image', this.options.imageTexts.sbOnDrop.replace('#images_names#', names.join(', ')));\n};\n\n/**\n * Update an item in the status bar.\n * @param itemName {string} The name of the item to update (ie. 'upload-image', 'autosave', etc.).\n * @param content {string} the new content of the item to write in the status bar.\n */\nEasyMDE.prototype.updateStatusBar = function (itemName, content) {\n    var matchingClasses = this.gui.statusbar.getElementsByClassName(itemName);\n    if (matchingClasses.length === 1) {\n        this.gui.statusbar.getElementsByClassName(itemName)[0].textContent = content;\n    } else if (matchingClasses.length === 0) {\n        console.log('EasyMDE: status bar item ' + itemName + ' was not found.');\n    } else {\n        console.log('EasyMDE: Several status bar items named ' + itemName + ' was found.');\n    }\n};\n\n/**\n * Default markdown render.\n */\nEasyMDE.prototype.markdown = function (text) {\n    if (marked) {\n        // Initialize\n        var markedOptions;\n        if (this.options && this.options.renderingConfig && this.options.renderingConfig.markedOptions) {\n            markedOptions = this.options.renderingConfig.markedOptions;\n        } else {\n            markedOptions = {};\n        }\n\n        // Update options\n        if (this.options && this.options.renderingConfig && this.options.renderingConfig.singleLineBreaks === false) {\n            markedOptions.breaks = false;\n        } else {\n            markedOptions.breaks = true;\n        }\n\n        if (this.options && this.options.renderingConfig && this.options.renderingConfig.codeSyntaxHighlighting === true) {\n\n            /* Get HLJS from config or window */\n            var hljs = this.options.renderingConfig.hljs || window.hljs;\n\n            /* Check if HLJS loaded */\n            if (hljs) {\n                markedOptions.highlight = function (code, language) {\n                    if (language && hljs.getLanguage(language)) {\n                      return hljs.highlight(language, code).value;\n                    } else {\n                    return hljs.highlightAuto(code).value;\n                    }\n                };\n            }\n        }\n\n        // Set options\n        marked.setOptions(markedOptions);\n\n        // Convert the markdown to HTML\n        var htmlText = marked(text);\n\n        // Sanitize HTML\n        if (this.options.renderingConfig && typeof this.options.renderingConfig.sanitizerFunction === 'function') {\n            htmlText = this.options.renderingConfig.sanitizerFunction.call(this, htmlText);\n        }\n\n        // Edit the HTML anchors to add 'target=\"_blank\"' by default.\n        htmlText = addAnchorTargetBlank(htmlText);\n\n        // Remove list-style when rendering checkboxes\n        htmlText = removeListStyleWhenCheckbox(htmlText);\n\n        return htmlText;\n    }\n};\n\n/**\n * Render editor to the given element.\n */\nEasyMDE.prototype.render = function (el) {\n    if (!el) {\n        el = this.element || document.getElementsByTagName('textarea')[0];\n    }\n\n    if (this._rendered && this._rendered === el) {\n        // Already rendered.\n        return;\n    }\n\n    this.element = el;\n    var options = this.options;\n\n    var self = this;\n    var keyMaps = {};\n\n    for (var key in options.shortcuts) {\n        // null stands for \"do not bind this command\"\n        if (options.shortcuts[key] !== null && bindings[key] !== null) {\n            (function (key) {\n                keyMaps[fixShortcut(options.shortcuts[key])] = function () {\n                    var action = bindings[key];\n                    if (typeof action === 'function') {\n                        action(self);\n                    } else if (typeof action === 'string') {\n                        window.open(action, '_blank');\n                    }\n                };\n            })(key);\n        }\n    }\n\n    keyMaps['Enter'] = 'newlineAndIndentContinueMarkdownList';\n    keyMaps['Tab'] = 'tabAndIndentMarkdownList';\n    keyMaps['Shift-Tab'] = 'shiftTabAndUnindentMarkdownList';\n    keyMaps['Ctrl-Space'] = 'autocomplete';\n\n    // comment this for vim keybindings\n\n    if (!game.settings.get('markdown-editor', 'vim-mode'))\n        keyMaps['Esc'] = function (cm) {\n            if (cm.getOption('fullScreen')) toggleFullScreen(self);\n        };\n\n    document.addEventListener('keydown', function (e) {\n        e = e || window.event;\n\n        if (e.keyCode == 27) {\n            if (self.codemirror.getOption('fullScreen')) toggleFullScreen(self);\n        }\n    }, false);\n\n    var mode, backdrop;\n    if (options.spellChecker !== false) {\n        mode = 'spell-checker';\n        backdrop = options.parsingConfig;\n        backdrop.name = 'gfm';\n        backdrop.gitHubSpice = false;\n\n        CodeMirrorSpellChecker({\n            codeMirrorInstance: CodeMirror,\n        });\n    } else {\n        mode = options.parsingConfig;\n        mode.name = 'gfm';\n        mode.gitHubSpice = false;\n    }\n\n    // eslint-disable-next-line no-unused-vars\n    function configureMouse(cm, repeat, event) {\n        return {\n            addNew: false,\n        };\n    }\n\n    let codemirrorOptions = {\n        // uncomment this for vim keybindings\n        // keyMap: \"vim\",\n        mode: mode,\n        backdrop: backdrop,\n        theme: (options.theme != undefined) ? options.theme : 'easymde',\n        tabSize: (options.tabSize != undefined) ? options.tabSize : 2,\n        indentUnit: (options.tabSize != undefined) ? options.tabSize : 2,\n        indentWithTabs: (options.indentWithTabs === false) ? false : true,\n        lineNumbers: false,\n        autofocus: (options.autofocus === true) ? true : false,\n        extraKeys: keyMaps,\n        lineWrapping: (options.lineWrapping === false) ? false : true,\n        allowDropFileTypes: ['text/plain'],\n        placeholder: options.placeholder || el.getAttribute('placeholder') || '',\n        styleSelectedText: (options.styleSelectedText != undefined) ? options.styleSelectedText : !isMobile(),\n        configureMouse: configureMouse,\n        inputStyle: (options.inputStyle != undefined) ? options.inputStyle : isMobile() ? 'contenteditable' : 'textarea',\n        spellcheck: (options.nativeSpellcheck != undefined) ? options.nativeSpellcheck : true,\n    }\n    if (game.settings.get('markdown-editor', 'vim-mode'))\n        codemirrorOptions.keyMap = \"vim\";\n\n    this.codemirror = CodeMirror.fromTextArea(el, codemirrorOptions);\n\n    this.codemirror.getScrollerElement().style.minHeight = options.minHeight;\n\n    if (typeof options.maxHeight !== 'undefined') {\n        this.codemirror.getScrollerElement().style.height = options.maxHeight;\n    }\n\n    if (options.forceSync === true) {\n        var cm = this.codemirror;\n        cm.on('change', function () {\n            cm.save();\n        });\n    }\n\n    this.gui = {};\n\n    // Wrap Codemirror with container before create toolbar, etc,\n    // to use with sideBySideFullscreen option.\n    var easyMDEContainer = document.createElement('div');\n    easyMDEContainer.classList.add('EasyMDEContainer');\n    var cmWrapper = this.codemirror.getWrapperElement();\n    cmWrapper.parentNode.insertBefore(easyMDEContainer, cmWrapper);\n    easyMDEContainer.appendChild(cmWrapper);\n\n    if (options.toolbar !== false) {\n        this.gui.toolbar = this.createToolbar();\n    }\n    if (options.status !== false) {\n        this.gui.statusbar = this.createStatusbar();\n    }\n    if (options.autosave != undefined && options.autosave.enabled === true) {\n        this.autosave(); // use to load localstorage content\n        this.codemirror.on('change', function () {\n            clearTimeout(self._autosave_timeout);\n            self._autosave_timeout = setTimeout(function () {\n                self.autosave();\n            }, self.options.autosave.submit_delay || self.options.autosave.delay || 1000);\n        });\n    }\n\n    this.gui.sideBySide = this.createSideBySide();\n\n    this._rendered = this.element;\n\n\n    // Fixes CodeMirror bug (#344)\n    var temp_cm = this.codemirror;\n    setTimeout(function () {\n        temp_cm.refresh();\n    }.bind(temp_cm), 0);\n};\n\n// Safari, in Private Browsing Mode, looks like it supports localStorage but all calls to setItem throw QuotaExceededError. We're going to detect this and set a variable accordingly.\nfunction isLocalStorageAvailable() {\n    if (typeof localStorage === 'object') {\n        try {\n            localStorage.setItem('smde_localStorage', 1);\n            localStorage.removeItem('smde_localStorage');\n        } catch (e) {\n            return false;\n        }\n    } else {\n        return false;\n    }\n\n    return true;\n}\n\nEasyMDE.prototype.autosave = function () {\n    if (isLocalStorageAvailable()) {\n        var easyMDE = this;\n\n        if (this.options.autosave.uniqueId == undefined || this.options.autosave.uniqueId == '') {\n            console.log('EasyMDE: You must set a uniqueId to use the autosave feature');\n            return;\n        }\n\n        if (this.options.autosave.binded !== true) {\n            if (easyMDE.element.form != null && easyMDE.element.form != undefined) {\n                easyMDE.element.form.addEventListener('submit', function () {\n                    clearTimeout(easyMDE.autosaveTimeoutId);\n                    easyMDE.autosaveTimeoutId = undefined;\n\n                    localStorage.removeItem('smde_' + easyMDE.options.autosave.uniqueId);\n                });\n            }\n\n            this.options.autosave.binded = true;\n        }\n\n        if (this.options.autosave.loaded !== true) {\n            if (typeof localStorage.getItem('smde_' + this.options.autosave.uniqueId) == 'string' && localStorage.getItem('smde_' + this.options.autosave.uniqueId) != '') {\n                this.codemirror.setValue(localStorage.getItem('smde_' + this.options.autosave.uniqueId));\n                this.options.autosave.foundSavedValue = true;\n            }\n\n            this.options.autosave.loaded = true;\n        }\n\n        var value = easyMDE.value();\n        if (value !== '') {\n            localStorage.setItem('smde_' + this.options.autosave.uniqueId, value);\n        } else {\n            localStorage.removeItem('smde_' + this.options.autosave.uniqueId);\n        }\n\n        var el = document.getElementById('autosaved');\n        if (el != null && el != undefined && el != '') {\n            var d = new Date();\n            var dd = new Intl.DateTimeFormat([this.options.autosave.timeFormat.locale, 'en-US'], this.options.autosave.timeFormat.format).format(d);\n            var save = this.options.autosave.text == undefined ? 'Autosaved: ' : this.options.autosave.text;\n\n            el.innerHTML = save + dd;\n        }\n    } else {\n        console.log('EasyMDE: localStorage not available, cannot autosave');\n    }\n};\n\nEasyMDE.prototype.clearAutosavedValue = function () {\n    if (isLocalStorageAvailable()) {\n        if (this.options.autosave == undefined || this.options.autosave.uniqueId == undefined || this.options.autosave.uniqueId == '') {\n            console.log('EasyMDE: You must set a uniqueId to clear the autosave value');\n            return;\n        }\n\n        localStorage.removeItem('smde_' + this.options.autosave.uniqueId);\n    } else {\n        console.log('EasyMDE: localStorage not available, cannot autosave');\n    }\n};\n\n/**\n * Open the browse-file window to upload an image to a server.\n * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage\n * @param [onError] {function} see EasyMDE.prototype.uploadImage\n */\nEasyMDE.prototype.openBrowseFileWindow = function (onSuccess, onError) {\n    var self = this;\n    var imageInput = this.gui.toolbar.getElementsByClassName('imageInput')[0];\n    imageInput.click(); //dispatchEvent(new MouseEvent('click'));  // replaced with click() for IE11 compatibility.\n    function onChange(event) {\n        if (self.options.imageUploadFunction) {\n          self.uploadImagesUsingCustomFunction(self.options.imageUploadFunction, event.target.files);\n        } else {\n          self.uploadImages(event.target.files, onSuccess, onError);\n        }\n        imageInput.removeEventListener('change', onChange);\n    }\n\n    imageInput.addEventListener('change', onChange);\n};\n\n/**\n * Upload an image to the server.\n *\n * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File)\n * @param [onSuccess] {function} A callback function to execute after the image has been successfully uploaded, with one parameter:\n * - url (string): The URL of the uploaded image.\n * @param [onError] {function} A callback function to execute when the image upload fails, with one parameter:\n * - error (string): the detailed error to display to the user (based on messages from options.errorMessages).\n */\nEasyMDE.prototype.uploadImage = function (file, onSuccess, onError) {\n    var self = this;\n    onSuccess = onSuccess || function onSuccess(imageUrl) {\n        afterImageUploaded(self, imageUrl);\n    };\n\n    function onErrorSup(errorMessage) {\n        // show error on status bar and reset after 10000ms\n        self.updateStatusBar('upload-image', errorMessage);\n\n        setTimeout(function () {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n        }, 10000);\n\n        // run custom error handler\n        if (onError && typeof onError === 'function') {\n            onError(errorMessage);\n        }\n        // run error handler from options, this alerts the message.\n        self.options.errorCallback(errorMessage);\n    }\n\n    function fillErrorMessage(errorMessage) {\n        var units = self.options.imageTexts.sizeUnits.split(',');\n        return errorMessage\n            .replace('#image_name#', file.name)\n            .replace('#image_size#', humanFileSize(file.size, units))\n            .replace('#image_max_size#', humanFileSize(self.options.imageMaxSize, units));\n    }\n\n    if (file.size > this.options.imageMaxSize) {\n        onErrorSup(fillErrorMessage(this.options.errorMessages.fileTooLarge));\n        return;\n    }\n\n    var formData = new FormData();\n    formData.append('image', file);\n\n    // insert CSRF token if provided in config.\n    if (self.options.imageCSRFToken) {\n        formData.append('csrfmiddlewaretoken', self.options.imageCSRFToken);\n    }\n    var request = new XMLHttpRequest();\n    request.upload.onprogress = function (event) {\n        if (event.lengthComputable) {\n            var progress = '' + Math.round((event.loaded * 100) / event.total);\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbProgress.replace('#file_name#', file.name).replace('#progress#', progress));\n        }\n    };\n    request.open('POST', this.options.imageUploadEndpoint);\n\n    request.onload = function () {\n        try {\n            var response = JSON.parse(this.responseText);\n        } catch (error) {\n            console.error('EasyMDE: The server did not return a valid json.');\n            onErrorSup(fillErrorMessage(self.options.errorMessages.importError));\n            return;\n        }\n        if (this.status === 200 && response && !response.error && response.data && response.data.filePath) {\n            onSuccess(window.location.origin + '/' + response.data.filePath);\n        } else {\n            if (response.error && response.error in self.options.errorMessages) {  // preformatted error message\n                onErrorSup(fillErrorMessage(self.options.errorMessages[response.error]));\n            } else if (response.error) {  // server side generated error message\n                onErrorSup(fillErrorMessage(response.error));\n            } else {  //unknown error\n                console.error('EasyMDE: Received an unexpected response after uploading the image.'\n                    + this.status + ' (' + this.statusText + ')');\n                onErrorSup(fillErrorMessage(self.options.errorMessages.importError));\n            }\n        }\n    };\n\n    request.onerror = function (event) {\n        console.error('EasyMDE: An unexpected error occurred when trying to upload the image.'\n            + event.target.status + ' (' + event.target.statusText + ')');\n        onErrorSup(self.options.errorMessages.importError);\n    };\n\n    request.send(formData);\n\n};\n\n/**\n * Upload an image to the server using a custom upload function.\n *\n * @param imageUploadFunction {Function} The custom function to upload the image passed in options\n * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File).\n */\nEasyMDE.prototype.uploadImageUsingCustomFunction = function(imageUploadFunction, file) {\n    var self = this;\n    function onSuccess(imageUrl) {\n        afterImageUploaded(self, imageUrl);\n    }\n\n    function onError(errorMessage) {\n        var filledErrorMessage = fillErrorMessage(errorMessage);\n        // show error on status bar and reset after 10000ms\n        self.updateStatusBar('upload-image', filledErrorMessage);\n\n        setTimeout(function () {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n        }, 10000);\n\n        // run error handler from options, this alerts the message.\n        self.options.errorCallback(filledErrorMessage);\n    }\n\n    function fillErrorMessage(errorMessage) {\n        var units = self.options.imageTexts.sizeUnits.split(',');\n        return errorMessage\n            .replace('#image_name#', file.name)\n            .replace('#image_size#', humanFileSize(file.size, units))\n            .replace('#image_max_size#', humanFileSize(self.options.imageMaxSize, units));\n    }\n\n    imageUploadFunction(file, onSuccess, onError);\n};\n\nEasyMDE.prototype.setPreviewMaxHeight = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n\n    // Calc preview max height\n    var paddingTop = parseInt(window.getComputedStyle(wrapper).paddingTop);\n    var borderTopWidth = parseInt(window.getComputedStyle(wrapper).borderTopWidth);\n    var optionsMaxHeight = parseInt(this.options.maxHeight);\n    var wrapperMaxHeight = optionsMaxHeight + paddingTop * 2 + borderTopWidth * 2;\n    var previewMaxHeight = wrapperMaxHeight.toString() + 'px';\n\n    preview.style.height =  previewMaxHeight;\n};\n\nEasyMDE.prototype.createSideBySide = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n\n    if (!preview || !/editor-preview-side/.test(preview.className)) {\n        preview = document.createElement('div');\n        preview.className = 'editor-preview-side';\n\n        if (this.options.previewClass) {\n\n            if (Array.isArray(this.options.previewClass)) {\n                for (var i = 0; i < this.options.previewClass.length; i++) {\n                    preview.className += (' ' + this.options.previewClass[i]);\n                }\n\n            } else if (typeof this.options.previewClass === 'string') {\n                preview.className += (' ' + this.options.previewClass);\n            }\n        }\n\n        wrapper.parentNode.insertBefore(preview, wrapper.nextSibling);\n    }\n\n    if (typeof this.options.maxHeight !== 'undefined') {\n        this.setPreviewMaxHeight();\n    }\n\n    if (this.options.syncSideBySidePreviewScroll === false) return preview;\n    // Syncs scroll  editor -> preview\n    var cScroll = false;\n    var pScroll = false;\n    cm.on('scroll', function (v) {\n        if (cScroll) {\n            cScroll = false;\n            return;\n        }\n        pScroll = true;\n        var height = v.getScrollInfo().height - v.getScrollInfo().clientHeight;\n        var ratio = parseFloat(v.getScrollInfo().top) / height;\n        var move = (preview.scrollHeight - preview.clientHeight) * ratio;\n        preview.scrollTop = move;\n    });\n\n    // Syncs scroll  preview -> editor\n    preview.onscroll = function () {\n        if (pScroll) {\n            pScroll = false;\n            return;\n        }\n        cScroll = true;\n        var height = preview.scrollHeight - preview.clientHeight;\n        var ratio = parseFloat(preview.scrollTop) / height;\n        var move = (cm.getScrollInfo().height - cm.getScrollInfo().clientHeight) * ratio;\n        cm.scrollTo(0, move);\n    };\n    return preview;\n};\n\nEasyMDE.prototype.createToolbar = function (items) {\n    items = items || this.options.toolbar;\n\n    if (!items || items.length === 0) {\n        return;\n    }\n    var i;\n    for (i = 0; i < items.length; i++) {\n        if (toolbarBuiltInButtons[items[i]] != undefined) {\n            items[i] = toolbarBuiltInButtons[items[i]];\n        }\n    }\n\n    var bar = document.createElement('div');\n    bar.className = 'editor-toolbar';\n\n    var self = this;\n\n    var toolbarData = {};\n    self.toolbar = items;\n\n    for (i = 0; i < items.length; i++) {\n        if (items[i].name == 'guide' && self.options.toolbarGuideIcon === false)\n            continue;\n\n        if (self.options.hideIcons && self.options.hideIcons.indexOf(items[i].name) != -1)\n            continue;\n\n        // Fullscreen does not work well on mobile devices (even tablets)\n        // In the future, hopefully this can be resolved\n        if ((items[i].name == 'fullscreen' || items[i].name == 'side-by-side') && isMobile())\n            continue;\n\n\n        // Don't include trailing separators\n        if (items[i] === '|') {\n            var nonSeparatorIconsFollow = false;\n\n            for (var x = (i + 1); x < items.length; x++) {\n                if (items[x] !== '|' && (!self.options.hideIcons || self.options.hideIcons.indexOf(items[x].name) == -1)) {\n                    nonSeparatorIconsFollow = true;\n                }\n            }\n\n            if (!nonSeparatorIconsFollow)\n                continue;\n        }\n\n\n        // Create the icon and append to the toolbar\n        (function (item) {\n            var el;\n            if (item === '|') {\n                el = createSep();\n            } else if (item.children) {\n                el = createToolbarDropdown(item, self.options.toolbarTips, self.options.shortcuts, self);\n            } else {\n                el = createToolbarButton(item, true, self.options.toolbarTips, self.options.shortcuts, 'button', self);\n            }\n\n\n            toolbarData[item.name || item] = el;\n            bar.appendChild(el);\n\n            // Create the input element (ie. <input type='file'>), used among\n            // with the 'import-image' icon to open the browse-file window.\n            if (item.name === 'upload-image') {\n                var imageInput = document.createElement('input');\n                imageInput.className = 'imageInput';\n                imageInput.type = 'file';\n                imageInput.multiple = true;\n                imageInput.name = 'image';\n                imageInput.accept = self.options.imageAccept;\n                imageInput.style.display = 'none';\n                imageInput.style.opacity = 0;\n                bar.appendChild(imageInput);\n            }\n        })(items[i]);\n    }\n\n    self.toolbar_div = bar;\n    self.toolbarElements = toolbarData;\n\n    var cm = this.codemirror;\n    cm.on('cursorActivity', function () {\n        var stat = getState(cm);\n\n        for (var key in toolbarData) {\n            (function (key) {\n                var el = toolbarData[key];\n                if (stat[key]) {\n                    el.className += ' active';\n                } else if (key != 'fullscreen' && key != 'side-by-side') {\n                    el.className = el.className.replace(/\\s*active\\s*/g, '');\n                }\n            })(key);\n        }\n    });\n\n    var cmWrapper = cm.getWrapperElement();\n    cmWrapper.parentNode.insertBefore(bar, cmWrapper);\n    return bar;\n};\n\nEasyMDE.prototype.createStatusbar = function (status) {\n    // Initialize\n    status = status || this.options.status;\n    var options = this.options;\n    var cm = this.codemirror;\n\n    // Make sure the status variable is valid\n    if (!status || status.length === 0) {\n        return;\n    }\n\n    // Set up the built-in items\n    var items = [];\n    var i, onUpdate, onActivity, defaultValue;\n\n    for (i = 0; i < status.length; i++) {\n        // Reset some values\n        onUpdate = undefined;\n        onActivity = undefined;\n        defaultValue = undefined;\n\n\n        // Handle if custom or not\n        if (typeof status[i] === 'object') {\n            items.push({\n                className: status[i].className,\n                defaultValue: status[i].defaultValue,\n                onUpdate: status[i].onUpdate,\n                onActivity: status[i].onActivity,\n            });\n        } else {\n            var name = status[i];\n\n            if (name === 'words') {\n                defaultValue = function (el) {\n                    el.innerHTML = wordCount(cm.getValue());\n                };\n                onUpdate = function (el) {\n                    el.innerHTML = wordCount(cm.getValue());\n                };\n            } else if (name === 'lines') {\n                defaultValue = function (el) {\n                    el.innerHTML = cm.lineCount();\n                };\n                onUpdate = function (el) {\n                    el.innerHTML = cm.lineCount();\n                };\n            } else if (name === 'cursor') {\n                defaultValue = function (el) {\n                    el.innerHTML = '0:0';\n                };\n                onActivity = function (el) {\n                    var pos = cm.getCursor();\n                    el.innerHTML = pos.line + ':' + pos.ch;\n                };\n            } else if (name === 'autosave') {\n                defaultValue = function (el) {\n                    if (options.autosave != undefined && options.autosave.enabled === true) {\n                        el.setAttribute('id', 'autosaved');\n                    }\n                };\n            } else if (name === 'upload-image') {\n                defaultValue = function (el) {\n                    el.innerHTML = options.imageTexts.sbInit;\n                };\n            }\n\n            items.push({\n                className: name,\n                defaultValue: defaultValue,\n                onUpdate: onUpdate,\n                onActivity: onActivity,\n            });\n        }\n    }\n\n\n    // Create element for the status bar\n    var bar = document.createElement('div');\n    bar.className = 'editor-statusbar';\n\n\n    // Create a new span for each item\n    for (i = 0; i < items.length; i++) {\n        // Store in temporary variable\n        var item = items[i];\n\n\n        // Create span element\n        var el = document.createElement('span');\n        el.className = item.className;\n\n\n        // Ensure the defaultValue is a function\n        if (typeof item.defaultValue === 'function') {\n            item.defaultValue(el);\n        }\n\n\n        // Ensure the onUpdate is a function\n        if (typeof item.onUpdate === 'function') {\n            // Create a closure around the span of the current action, then execute the onUpdate handler\n            this.codemirror.on('update', (function (el, item) {\n                return function () {\n                    item.onUpdate(el);\n                };\n            }(el, item)));\n        }\n        if (typeof item.onActivity === 'function') {\n            // Create a closure around the span of the current action, then execute the onActivity handler\n            this.codemirror.on('cursorActivity', (function (el, item) {\n                return function () {\n                    item.onActivity(el);\n                };\n            }(el, item)));\n        }\n\n\n        // Append the item to the status bar\n        bar.appendChild(el);\n    }\n\n\n    // Insert the status bar into the DOM\n    var cmWrapper = this.codemirror.getWrapperElement();\n    cmWrapper.parentNode.insertBefore(bar, cmWrapper.nextSibling);\n    return bar;\n};\n\n/**\n * Get or set the text content.\n */\nEasyMDE.prototype.value = function (val) {\n    var cm = this.codemirror;\n    if (val === undefined) {\n        return cm.getValue();\n    } else {\n        cm.getDoc().setValue(val);\n        if (this.isPreviewActive()) {\n            var wrapper = cm.getWrapperElement();\n            var preview = wrapper.lastChild;\n            preview.innerHTML = this.options.previewRender(val, preview);\n        }\n        return this;\n    }\n};\n\n\n/**\n * Bind static methods for exports.\n */\nEasyMDE.toggleBold = toggleBold;\nEasyMDE.toggleItalic = toggleItalic;\nEasyMDE.toggleStrikethrough = toggleStrikethrough;\nEasyMDE.toggleBlockquote = toggleBlockquote;\nEasyMDE.toggleHeadingSmaller = toggleHeadingSmaller;\nEasyMDE.toggleHeadingBigger = toggleHeadingBigger;\nEasyMDE.toggleHeading1 = toggleHeading1;\nEasyMDE.toggleHeading2 = toggleHeading2;\nEasyMDE.toggleHeading3 = toggleHeading3;\nEasyMDE.toggleCodeBlock = toggleCodeBlock;\nEasyMDE.toggleUnorderedList = toggleUnorderedList;\nEasyMDE.toggleOrderedList = toggleOrderedList;\nEasyMDE.cleanBlock = cleanBlock;\nEasyMDE.drawLink = drawLink;\nEasyMDE.drawImage = drawImage;\nEasyMDE.drawTable = drawTable;\nEasyMDE.drawHorizontalRule = drawHorizontalRule;\nEasyMDE.undo = undo;\nEasyMDE.redo = redo;\nEasyMDE.togglePreview = togglePreview;\nEasyMDE.toggleSideBySide = toggleSideBySide;\nEasyMDE.toggleFullScreen = toggleFullScreen;\n\nEasyMDE.toggleSecretBlock = toggleSecretBlock;\n\n\nEasyMDE.prototype.toggleSecretBlock = function() {\n    toggleSecretBlock(this);\n}\n\n/**\n * Bind instance methods for exports.\n */\nEasyMDE.prototype.toggleBold = function () {\n    toggleBold(this);\n};\nEasyMDE.prototype.toggleItalic = function () {\n    toggleItalic(this);\n};\nEasyMDE.prototype.toggleStrikethrough = function () {\n    toggleStrikethrough(this);\n};\nEasyMDE.prototype.toggleBlockquote = function () {\n    toggleBlockquote(this);\n};\nEasyMDE.prototype.toggleHeadingSmaller = function () {\n    toggleHeadingSmaller(this);\n};\nEasyMDE.prototype.toggleHeadingBigger = function () {\n    toggleHeadingBigger(this);\n};\nEasyMDE.prototype.toggleHeading1 = function () {\n    toggleHeading1(this);\n};\nEasyMDE.prototype.toggleHeading2 = function () {\n    toggleHeading2(this);\n};\nEasyMDE.prototype.toggleHeading3 = function () {\n    toggleHeading3(this);\n};\nEasyMDE.prototype.toggleCodeBlock = function () {\n    toggleCodeBlock(this);\n};\nEasyMDE.prototype.toggleUnorderedList = function () {\n    toggleUnorderedList(this);\n};\nEasyMDE.prototype.toggleOrderedList = function () {\n    toggleOrderedList(this);\n};\nEasyMDE.prototype.cleanBlock = function () {\n    cleanBlock(this);\n};\nEasyMDE.prototype.drawLink = function () {\n    drawLink(this);\n};\nEasyMDE.prototype.drawImage = function () {\n    drawImage(this);\n};\nEasyMDE.prototype.drawTable = function () {\n    drawTable(this);\n};\nEasyMDE.prototype.drawHorizontalRule = function () {\n    drawHorizontalRule(this);\n};\nEasyMDE.prototype.undo = function () {\n    undo(this);\n};\nEasyMDE.prototype.redo = function () {\n    redo(this);\n};\nEasyMDE.prototype.togglePreview = function () {\n    togglePreview(this);\n};\nEasyMDE.prototype.toggleSideBySide = function () {\n    toggleSideBySide(this);\n};\nEasyMDE.prototype.toggleFullScreen = function () {\n    toggleFullScreen(this);\n};\n\nEasyMDE.prototype.isPreviewActive = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.lastChild;\n\n    return /editor-preview-active/.test(preview.className);\n};\n\nEasyMDE.prototype.isSideBySideActive = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n\n    return /editor-preview-active-side/.test(preview.className);\n};\n\nEasyMDE.prototype.isFullscreenActive = function () {\n    var cm = this.codemirror;\n\n    return cm.getOption('fullScreen');\n};\n\nEasyMDE.prototype.getState = function () {\n    var cm = this.codemirror;\n\n    return getState(cm);\n};\n\nEasyMDE.prototype.toTextArea = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n\n    if (wrapper.parentNode) {\n        if (this.gui.toolbar) {\n            wrapper.parentNode.removeChild(this.gui.toolbar);\n        }\n        if (this.gui.statusbar) {\n            wrapper.parentNode.removeChild(this.gui.statusbar);\n        }\n        if (this.gui.sideBySide) {\n            wrapper.parentNode.removeChild(this.gui.sideBySide);\n        }\n    }\n\n    cm.toTextArea();\n\n    if (this.autosaveTimeoutId) {\n        clearTimeout(this.autosaveTimeoutId);\n        this.autosaveTimeoutId = undefined;\n        this.clearAutosavedValue();\n    }\n};\n\nmodule.exports = EasyMDE;\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n * \n * It is partly modified to add some FoundryVTT related functionality.\n */\n\nconst Tokenizer = require('./Tokenizer.js');\nconst { defaults } = require('./defaults.js');\nconst { block, inline } = require('./rules.js');\n\n/**\n * smartypants text replacement\n */\nfunction smartypants(text) {\n  return text\n    // em-dashes\n    .replace(/---/g, '\\u2014')\n    // en-dashes\n    .replace(/--/g, '\\u2013')\n    // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, '$1\\u2018')\n    // closing singles & apostrophes\n    .replace(/'/g, '\\u2019')\n    // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, '$1\\u201c')\n    // closing doubles\n    .replace(/\"/g, '\\u201d')\n    // ellipses\n    .replace(/\\.{3}/g, '\\u2026');\n}\n\n/**\n * mangle email addresses\n */\nfunction mangle(text) {\n  let out = '',\n    i,\n    ch;\n\n  const l = text.length;\n  for (i = 0; i < l; i++) {\n    ch = text.charCodeAt(i);\n    if (Math.random() > 0.5) {\n      ch = 'x' + ch.toString(16);\n    }\n    out += '&#' + ch + ';';\n  }\n\n  return out;\n}\n\n/**\n * Block Lexer\n */\nmodule.exports = class Lexer {\n  constructor(options) {\n    this.tokens = [];\n    this.tokens.links = Object.create(null);\n    this.options = options || defaults;\n    this.options.tokenizer = this.options.tokenizer || new Tokenizer();\n    this.tokenizer = this.options.tokenizer;\n    this.tokenizer.options = this.options;\n\n    const rules = {\n      block: block.normal,\n      inline: inline.normal\n    };\n\n    if (this.options.pedantic) {\n      rules.block = block.pedantic;\n      rules.inline = inline.pedantic;\n    } else if (this.options.gfm) {\n      rules.block = block.gfm;\n      if (this.options.breaks) {\n        rules.inline = inline.breaks;\n      } else {\n        rules.inline = inline.gfm;\n      }\n    }\n    this.tokenizer.rules = rules;\n  }\n\n  /**\n   * Expose Rules\n   */\n  static get rules() {\n    return {\n      block,\n      inline\n    };\n  }\n\n  /**\n   * Static Lex Method\n   */\n  static lex(src, options) {\n    const lexer = new Lexer(options);\n    return lexer.lex(src);\n  }\n\n  /**\n   * Preprocessing\n   */\n  lex(src) {\n    src = src\n      .replace(/\\r\\n|\\r/g, '\\n')\n      .replace(/\\t/g, '    ');\n\n    this.blockTokens(src, this.tokens, true);\n\n    this.inline(this.tokens);\n\n    return this.tokens;\n  }\n\n  /**\n   * Lexing\n   */\n  blockTokens(src, tokens = [], top = true) {\n    src = src.replace(/^ +$/gm, '');\n    let token, i, l, lastToken;\n\n    while (src) {\n      // newline\n      if (token = this.tokenizer.space(src)) {\n        src = src.substring(token.raw.length);\n        if (token.type) {\n          tokens.push(token);\n        }\n        continue;\n      }\n\n      // code\n      if (token = this.tokenizer.code(src, tokens)) {\n        src = src.substring(token.raw.length);\n        if (token.type) {\n          tokens.push(token);\n        } else {\n          lastToken = tokens[tokens.length - 1];\n          lastToken.raw += '\\n' + token.raw;\n          lastToken.text += '\\n' + token.text;\n        }\n        continue;\n      }\n\n      // fences\n      if (token = this.tokenizer.fences(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // heading\n      if (token = this.tokenizer.heading(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // table no leading pipe (gfm)\n      if (token = this.tokenizer.nptable(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // hr\n      if (token = this.tokenizer.hr(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // blockquote\n      if (token = this.tokenizer.blockquote(src)) {\n        src = src.substring(token.raw.length);\n        token.tokens = this.blockTokens(token.text, [], top);\n        tokens.push(token);\n        continue;\n      }\n\n      // list\n      if (token = this.tokenizer.list(src)) {\n        src = src.substring(token.raw.length);\n        l = token.items.length;\n        for (i = 0; i < l; i++) {\n          token.items[i].tokens = this.blockTokens(token.items[i].text, [], false);\n        }\n        tokens.push(token);\n        continue;\n      }\n\n      // html\n      if (token = this.tokenizer.html(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // def\n      if (top && (token = this.tokenizer.def(src))) {\n        src = src.substring(token.raw.length);\n        if (!this.tokens.links[token.tag]) {\n          this.tokens.links[token.tag] = {\n            href: token.href,\n            title: token.title\n          };\n        }\n        continue;\n      }\n\n      // table (gfm)\n      if (token = this.tokenizer.table(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // lheading\n      if (token = this.tokenizer.lheading(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // FVTT stuff\n      if (token = this.tokenizer.secret(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n      // End FVTT stuff\n\n      // top-level paragraph\n      if (top && (token = this.tokenizer.paragraph(src))) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // text\n      if (token = this.tokenizer.text(src, tokens)) {\n        src = src.substring(token.raw.length);\n        if (token.type) {\n          tokens.push(token);\n        } else {\n          lastToken = tokens[tokens.length - 1];\n          lastToken.raw += '\\n' + token.raw;\n          lastToken.text += '\\n' + token.text;\n        }\n        continue;\n      }\n\n      if (src) {\n        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n        if (this.options.silent) {\n          console.error(errMsg);\n          break;\n        } else {\n          throw new Error(errMsg);\n        }\n      }\n    }\n\n    return tokens;\n  }\n\n  inline(tokens) {\n    let i,\n      j,\n      k,\n      l2,\n      row,\n      token;\n\n    const l = tokens.length;\n    for (i = 0; i < l; i++) {\n      token = tokens[i];\n      switch (token.type) {\n        case 'paragraph':\n        case 'text':\n        case 'heading': {\n          token.tokens = [];\n          this.inlineTokens(token.text, token.tokens);\n          break;\n        }\n        case 'table': {\n          token.tokens = {\n            header: [],\n            cells: []\n          };\n\n          // header\n          l2 = token.header.length;\n          for (j = 0; j < l2; j++) {\n            token.tokens.header[j] = [];\n            this.inlineTokens(token.header[j], token.tokens.header[j]);\n          }\n\n          // cells\n          l2 = token.cells.length;\n          for (j = 0; j < l2; j++) {\n            row = token.cells[j];\n            token.tokens.cells[j] = [];\n            for (k = 0; k < row.length; k++) {\n              token.tokens.cells[j][k] = [];\n              this.inlineTokens(row[k], token.tokens.cells[j][k]);\n            }\n          }\n\n          break;\n        }\n        case 'blockquote': {\n          this.inline(token.tokens);\n          break;\n        }\n        case 'list': {\n          l2 = token.items.length;\n          for (j = 0; j < l2; j++) {\n            this.inline(token.items[j].tokens);\n          }\n          break;\n        }\n        default: {\n          // do nothing\n        }\n      }\n    }\n\n    return tokens;\n  }\n\n  /**\n   * Lexing/Compiling\n   */\n  inlineTokens(src, tokens = [], inLink = false, inRawBlock = false, prevChar = '') {\n    let token;\n\n    // String with links masked to avoid interference with em and strong\n    let maskedSrc = src;\n    let match;\n\n    // Mask out reflinks\n    if (this.tokens.links) {\n      const links = Object.keys(this.tokens.links);\n      if (links.length > 0) {\n        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n          if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n          }\n        }\n      }\n    }\n    // Mask out other blocks\n    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n      maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n    }\n\n    while (src) {\n      // escape\n      if (token = this.tokenizer.escape(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // tag\n      if (token = this.tokenizer.tag(src, inLink, inRawBlock)) {\n        src = src.substring(token.raw.length);\n        inLink = token.inLink;\n        inRawBlock = token.inRawBlock;\n        tokens.push(token);\n        continue;\n      }\n\n      // link\n      if (token = this.tokenizer.link(src)) {\n        src = src.substring(token.raw.length);\n        if (token.type === 'link') {\n          token.tokens = this.inlineTokens(token.text, [], true, inRawBlock);\n        }\n        tokens.push(token);\n        continue;\n      }\n\n      // reflink, nolink\n      if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n        src = src.substring(token.raw.length);\n        if (token.type === 'link') {\n          token.tokens = this.inlineTokens(token.text, [], true, inRawBlock);\n        }\n        tokens.push(token);\n        continue;\n      }\n\n      // strong\n      if (token = this.tokenizer.strong(src, maskedSrc, prevChar)) {\n        src = src.substring(token.raw.length);\n        token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock);\n        tokens.push(token);\n        continue;\n      }\n\n      // em\n      if (token = this.tokenizer.em(src, maskedSrc, prevChar)) {\n        src = src.substring(token.raw.length);\n        token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock);\n        tokens.push(token);\n        continue;\n      }\n\n      // code\n      if (token = this.tokenizer.codespan(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // br\n      if (token = this.tokenizer.br(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // del (gfm)\n      if (token = this.tokenizer.del(src)) {\n        src = src.substring(token.raw.length);\n        token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock);\n        tokens.push(token);\n        continue;\n      }\n\n      // autolink\n      if (token = this.tokenizer.autolink(src, mangle)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // url (gfm)\n      if (!inLink && (token = this.tokenizer.url(src, mangle))) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // FVTT stuff\n      if (token = this.tokenizer.entityLink(src)) {\n        src = src.substring(token.raw.length);\n\n        tokens.push(token);\n        continue;\n      }\n      // End FVTT stuff\n\n      // text\n      if (token = this.tokenizer.inlineText(src, inRawBlock, smartypants)) {\n        src = src.substring(token.raw.length);\n        prevChar = token.raw.slice(-1);\n        tokens.push(token);\n        continue;\n      }\n\n      if (src) {\n        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n        if (this.options.silent) {\n          console.error(errMsg);\n          break;\n        } else {\n          throw new Error(errMsg);\n        }\n      }\n    }\n\n    return tokens;\n  }\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n * \n * It is partly modified to add some FoundryVTT related functionality.\n */\n\nconst Renderer = require('./Renderer.js');\nconst TextRenderer = require('./TextRenderer.js');\nconst Slugger = require('./Slugger.js');\nconst { defaults } = require('./defaults.js');\nconst {\n  unescape\n} = require('./helpers.js');\n\n/**\n * Parsing & Compiling\n */\nmodule.exports = class Parser {\n  constructor(options) {\n    this.options = options || defaults;\n    this.options.renderer = this.options.renderer || new Renderer();\n    this.renderer = this.options.renderer;\n    this.renderer.options = this.options;\n    this.textRenderer = new TextRenderer();\n    this.slugger = new Slugger();\n  }\n\n  /**\n   * Static Parse Method\n   */\n  static parse(tokens, options) {\n    const parser = new Parser(options);\n    return parser.parse(tokens);\n  }\n\n  /**\n   * Parse Loop\n   */\n  parse(tokens, top = true) {\n    let out = '',\n      i,\n      j,\n      k,\n      l2,\n      l3,\n      row,\n      cell,\n      header,\n      body,\n      token,\n      ordered,\n      start,\n      loose,\n      itemBody,\n      item,\n      checked,\n      task,\n      checkbox;\n\n    const l = tokens.length;\n    for (i = 0; i < l; i++) {\n      token = tokens[i];\n      switch (token.type) {\n        case 'space': {\n          continue;\n        }\n        case 'hr': {\n          out += this.renderer.hr();\n          continue;\n        }\n        case 'heading': {\n          out += this.renderer.heading(\n            this.parseInline(token.tokens),\n            token.depth,\n            unescape(this.parseInline(token.tokens, this.textRenderer)),\n            this.slugger);\n          continue;\n        }\n        case 'code': {\n          out += this.renderer.code(token.text,\n            token.lang,\n            token.escaped);\n          continue;\n        }\n        case 'table': {\n          header = '';\n\n          // header\n          cell = '';\n          l2 = token.header.length;\n          for (j = 0; j < l2; j++) {\n            cell += this.renderer.tablecell(\n              this.parseInline(token.tokens.header[j]),\n              { header: true, align: token.align[j] }\n            );\n          }\n          header += this.renderer.tablerow(cell);\n\n          body = '';\n          l2 = token.cells.length;\n          for (j = 0; j < l2; j++) {\n            row = token.tokens.cells[j];\n\n            cell = '';\n            l3 = row.length;\n            for (k = 0; k < l3; k++) {\n              cell += this.renderer.tablecell(\n                this.parseInline(row[k]),\n                { header: false, align: token.align[k] }\n              );\n            }\n\n            body += this.renderer.tablerow(cell);\n          }\n          out += this.renderer.table(header, body);\n          continue;\n        }\n        case 'blockquote': {\n          body = this.parse(token.tokens);\n          out += this.renderer.blockquote(body);\n          continue;\n        }\n        case 'list': {\n          ordered = token.ordered;\n          start = token.start;\n          loose = token.loose;\n          l2 = token.items.length;\n\n          body = '';\n          for (j = 0; j < l2; j++) {\n            item = token.items[j];\n            checked = item.checked;\n            task = item.task;\n\n            itemBody = '';\n            if (item.task) {\n              checkbox = this.renderer.checkbox(checked);\n              if (loose) {\n                if (item.tokens.length > 0 && item.tokens[0].type === 'text') {\n                  item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                  if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                    item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                  }\n                } else {\n                  item.tokens.unshift({\n                    type: 'text',\n                    text: checkbox\n                  });\n                }\n              } else {\n                itemBody += checkbox;\n              }\n            }\n\n            itemBody += this.parse(item.tokens, loose);\n            body += this.renderer.listitem(itemBody, task, checked);\n          }\n\n          out += this.renderer.list(body, ordered, start);\n          continue;\n        }\n        case 'html': {\n          // TODO parse inline content if parameter markdown=1\n          out += this.renderer.html(token.text);\n          continue;\n        }\n        case 'paragraph': {\n          out += this.renderer.paragraph(this.parseInline(token.tokens));\n          continue;\n        }\n        case 'text': {\n          body = token.tokens ? this.parseInline(token.tokens) : token.text;\n          while (i + 1 < l && tokens[i + 1].type === 'text') {\n            token = tokens[++i];\n            body += '\\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);\n          }\n          out += top ? this.renderer.paragraph(body) : body;\n          continue;\n        }\n        // FVTT Stuff\n        case 'secret': {\n          out += this.renderer.secret(token.text);\n          continue;\n        }\n        // end FVTT Stuff\n        default: {\n          const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n          if (this.options.silent) {\n            console.error(errMsg);\n            return;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n    }\n\n    return out;\n  }\n\n  /**\n   * Parse Inline Tokens\n   */\n  parseInline(tokens, renderer) {\n    renderer = renderer || this.renderer;\n    let out = '',\n      i,\n      token;\n\n    const l = tokens.length;\n    for (i = 0; i < l; i++) {\n      token = tokens[i];\n      switch (token.type) {\n        case 'escape': {\n          out += renderer.text(token.text);\n          break;\n        }\n        case 'html': {\n          out += renderer.html(token.text);\n          break;\n        }\n        case 'link': {\n          out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));\n          break;\n        }\n        case 'image': {\n          out += renderer.image(token.href, token.title, token.text);\n          break;\n        }\n        case 'strong': {\n          out += renderer.strong(this.parseInline(token.tokens, renderer));\n          break;\n        }\n        case 'em': {\n          out += renderer.em(this.parseInline(token.tokens, renderer));\n          break;\n        }\n        case 'codespan': {\n          out += renderer.codespan(token.text);\n          break;\n        }\n        case 'br': {\n          out += renderer.br();\n          break;\n        }\n        case 'del': {\n          out += renderer.del(this.parseInline(token.tokens, renderer));\n          break;\n        }\n        case 'text': {\n          out += renderer.text(token.text);\n          break;\n        }\n        // FVTT Stuff\n        case 'entityLink': {\n          out += token.text;\n          continue;\n        }\n        // end FVTT Stuff\n        default: {\n          const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n          if (this.options.silent) {\n            console.error(errMsg);\n            return;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n    }\n    return out;\n  }\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n * \n * It is partly modified to add some FoundryVTT related functionality.\n */\n\nconst { defaults } = require('./defaults.js');\nconst {\n  cleanUrl,\n  escape\n} = require('./helpers.js');\n\n/**\n * Renderer\n */\nmodule.exports = class Renderer {\n  constructor(options) {\n    this.options = options || defaults;\n  }\n\n  code(code, infostring, escaped) {\n    const lang = (infostring || '').match(/\\S*/)[0];\n    if (this.options.highlight) {\n      const out = this.options.highlight(code, lang);\n      if (out != null && out !== code) {\n        escaped = true;\n        code = out;\n      }\n    }\n\n    if (!lang) {\n      return '<pre><code>'\n        + (escaped ? code : escape(code, true))\n        + '</code></pre>\\n';\n    }\n\n    return '<pre><code class=\"'\n      + this.options.langPrefix\n      + escape(lang, true)\n      + '\">'\n      + (escaped ? code : escape(code, true))\n      + '</code></pre>\\n';\n  }\n\n  blockquote(quote) {\n    return '<blockquote>\\n' + quote + '</blockquote>\\n';\n  }\n\n  html(html) {\n    return html;\n  }\n\n  heading(text, level, raw, slugger) {\n    if (this.options.headerIds) {\n      return '<h'\n        + level\n        + ' id=\"'\n        + this.options.headerPrefix\n        + slugger.slug(raw)\n        + '\">'\n        + text\n        + '</h'\n        + level\n        + '>\\n';\n    }\n    // ignore IDs\n    return '<h' + level + '>' + text + '</h' + level + '>\\n';\n  }\n\n  hr() {\n    return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n  }\n\n  list(body, ordered, start) {\n    const type = ordered ? 'ol' : 'ul',\n      startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n    return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n  }\n\n  listitem(text) {\n    return '<li>' + text + '</li>\\n';\n  }\n\n  checkbox(checked) {\n    return '<input '\n      + (checked ? 'checked=\"\" ' : '')\n      + 'disabled=\"\" type=\"checkbox\"'\n      + (this.options.xhtml ? ' /' : '')\n      + '> ';\n  }\n\n  paragraph(text) {\n    return '<p>' + text + '</p>\\n';\n  }\n\n  table(header, body) {\n    if (body) body = '<tbody>' + body + '</tbody>';\n\n    return '<table>\\n'\n      + '<thead>\\n'\n      + header\n      + '</thead>\\n'\n      + body\n      + '</table>\\n';\n  }\n\n  tablerow(content) {\n    return '<tr>\\n' + content + '</tr>\\n';\n  }\n\n  tablecell(content, flags) {\n    const type = flags.header ? 'th' : 'td';\n    const tag = flags.align\n      ? '<' + type + ' align=\"' + flags.align + '\">'\n      : '<' + type + '>';\n    return tag + content + '</' + type + '>\\n';\n  }\n\n  // span level renderer\n  strong(text) {\n    return '<strong>' + text + '</strong>';\n  }\n\n  em(text) {\n    return '<em>' + text + '</em>';\n  }\n\n  codespan(text) {\n    return '<code>' + text + '</code>';\n  }\n\n  br() {\n    return this.options.xhtml ? '<br/>' : '<br>';\n  }\n\n  del(text) {\n    return '<del>' + text + '</del>';\n  }\n\n  link(href, title, text) {\n    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n    if (href === null) {\n      return text;\n    }\n    let out = '<a href=\"' + escape(href) + '\"';\n    if (title) {\n      out += ' title=\"' + title + '\"';\n    }\n    out += '>' + text + '</a>';\n    return out;\n  }\n\n  image(href, title, text) {\n    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n    if (href === null) {\n      return text;\n    }\n\n    let out = '<img src=\"' + href + '\" alt=\"' + text + '\"';\n    if (title) {\n      out += ' title=\"' + title + '\"';\n    }\n    out += this.options.xhtml ? '/>' : '>';\n    return out;\n  }\n\n  text(text) {\n    return text;\n  }\n\n  // FVTT stuff\n  secret(text) {\n    return '<section class=\"secret\">' + text + '</section>';\n  }\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * Slugger generates header id\n */\nmodule.exports = class Slugger {\n  constructor() {\n    this.seen = {};\n  }\n\n  /**\n   * Convert string to unique id\n   */\n  slug(value) {\n    let slug = value\n      .toLowerCase()\n      .trim()\n      // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '')\n      // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '')\n      .replace(/\\s/g, '-');\n\n    if (this.seen.hasOwnProperty(slug)) {\n      const originalSlug = slug;\n      do {\n        this.seen[originalSlug]++;\n        slug = originalSlug + '-' + this.seen[originalSlug];\n      } while (this.seen.hasOwnProperty(slug));\n    }\n    this.seen[slug] = 0;\n\n    return slug;\n  }\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\nmodule.exports = class TextRenderer {\n  // no need for block level renderers\n  strong(text) {\n    return text;\n  }\n\n  em(text) {\n    return text;\n  }\n\n  codespan(text) {\n    return text;\n  }\n\n  del(text) {\n    return text;\n  }\n\n  html(text) {\n    return text;\n  }\n\n  text(text) {\n    return text;\n  }\n\n  link(href, title, text) {\n    return '' + text;\n  }\n\n  image(href, title, text) {\n    return '' + text;\n  }\n\n  br() {\n    return '';\n  }\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n * \n * It is partly modified to add some FoundryVTT related functionality.\n */\n\nconst { defaults } = require('./defaults.js');\nconst {\n  rtrim,\n  splitCells,\n  escape,\n  findClosingBracket\n} = require('./helpers.js');\n\nfunction outputLink(cap, link, raw) {\n  const href = link.href;\n  const title = link.title ? escape(link.title) : null;\n  const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n\n  if (cap[0].charAt(0) !== '!') {\n    return {\n      type: 'link',\n      raw,\n      href,\n      title,\n      text\n    };\n  } else {\n    return {\n      type: 'image',\n      raw,\n      href,\n      title,\n      text: escape(text)\n    };\n  }\n}\n\nfunction indentCodeCompensation(raw, text) {\n  const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n\n  if (matchIndentToCode === null) {\n    return text;\n  }\n\n  const indentToCode = matchIndentToCode[1];\n\n  return text\n    .split('\\n')\n    .map(node => {\n      const matchIndentInNode = node.match(/^\\s+/);\n      if (matchIndentInNode === null) {\n        return node;\n      }\n\n      const [indentInNode] = matchIndentInNode;\n\n      if (indentInNode.length >= indentToCode.length) {\n        return node.slice(indentToCode.length);\n      }\n\n      return node;\n    })\n    .join('\\n');\n}\n\n/**\n * Tokenizer\n */\nmodule.exports = class Tokenizer {\n  constructor(options) {\n    this.options = options || defaults;\n  }\n\n  space(src) {\n    const cap = this.rules.block.newline.exec(src);\n    if (cap) {\n      if (cap[0].length > 1) {\n        return {\n          type: 'space',\n          raw: cap[0]\n        };\n      }\n      return { raw: '\\n' };\n    }\n  }\n\n  code(src, tokens) {\n    const cap = this.rules.block.code.exec(src);\n    if (cap) {\n      const lastToken = tokens[tokens.length - 1];\n      // An indented code block cannot interrupt a paragraph.\n      if (lastToken && lastToken.type === 'paragraph') {\n        return {\n          raw: cap[0],\n          text: cap[0].trimRight()\n        };\n      }\n\n      const text = cap[0].replace(/^ {4}/gm, '');\n      return {\n        type: 'code',\n        raw: cap[0],\n        codeBlockStyle: 'indented',\n        text: !this.options.pedantic\n          ? rtrim(text, '\\n')\n          : text\n      };\n    }\n  }\n\n  fences(src) {\n    const cap = this.rules.block.fences.exec(src);\n    if (cap) {\n      const raw = cap[0];\n      const text = indentCodeCompensation(raw, cap[3] || '');\n\n      return {\n        type: 'code',\n        raw,\n        lang: cap[2] ? cap[2].trim() : cap[2],\n        text\n      };\n    }\n  }\n\n  heading(src) {\n    const cap = this.rules.block.heading.exec(src);\n    if (cap) {\n      return {\n        type: 'heading',\n        raw: cap[0],\n        depth: cap[1].length,\n        text: cap[2]\n      };\n    }\n  }\n\n  nptable(src) {\n    const cap = this.rules.block.nptable.exec(src);\n    if (cap) {\n      const item = {\n        type: 'table',\n        header: splitCells(cap[1].replace(/^ *| *\\| *$/g, '')),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : [],\n        raw: cap[0]\n      };\n\n      if (item.header.length === item.align.length) {\n        let l = item.align.length;\n        let i;\n        for (i = 0; i < l; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n\n        l = item.cells.length;\n        for (i = 0; i < l; i++) {\n          item.cells[i] = splitCells(item.cells[i], item.header.length);\n        }\n\n        return item;\n      }\n    }\n  }\n\n  hr(src) {\n    const cap = this.rules.block.hr.exec(src);\n    if (cap) {\n      return {\n        type: 'hr',\n        raw: cap[0]\n      };\n    }\n  }\n\n  blockquote(src) {\n    const cap = this.rules.block.blockquote.exec(src);\n    if (cap) {\n      const text = cap[0].replace(/^ *> ?/gm, '');\n\n      return {\n        type: 'blockquote',\n        raw: cap[0],\n        text\n      };\n    }\n  }\n\n  list(src) {\n    const cap = this.rules.block.list.exec(src);\n    if (cap) {\n      let raw = cap[0];\n      const bull = cap[2];\n      const isordered = bull.length > 1;\n      const isparen = bull[bull.length - 1] === ')';\n\n      const list = {\n        type: 'list',\n        raw,\n        ordered: isordered,\n        start: isordered ? +bull.slice(0, -1) : '',\n        loose: false,\n        items: []\n      };\n\n      // Get each top-level item.\n      const itemMatch = cap[0].match(this.rules.block.item);\n\n      let next = false,\n        item,\n        space,\n        b,\n        addBack,\n        loose,\n        istask,\n        ischecked;\n\n      const l = itemMatch.length;\n      for (let i = 0; i < l; i++) {\n        item = itemMatch[i];\n        raw = item;\n\n        // Remove the list item's bullet\n        // so it is seen as the next token.\n        space = item.length;\n        item = item.replace(/^ *([*+-]|\\d+[.)]) */, '');\n\n        // Outdent whatever the\n        // list item contains. Hacky.\n        if (~item.indexOf('\\n ')) {\n          space -= item.length;\n          item = !this.options.pedantic\n            ? item.replace(new RegExp('^ {1,' + space + '}', 'gm'), '')\n            : item.replace(/^ {1,4}/gm, '');\n        }\n\n        // Determine whether the next list item belongs here.\n        // Backpedal if it does not belong in this list.\n        if (i !== l - 1) {\n          b = this.rules.block.bullet.exec(itemMatch[i + 1])[0];\n          if (isordered ? b.length === 1 || (!isparen && b[b.length - 1] === ')')\n            : (b.length > 1 || (this.options.smartLists && b !== bull))) {\n            addBack = itemMatch.slice(i + 1).join('\\n');\n            list.raw = list.raw.substring(0, list.raw.length - addBack.length);\n            i = l - 1;\n          }\n        }\n\n        // Determine whether item is loose or not.\n        // Use: /(^|\\n)(?! )[^\\n]+\\n\\n(?!\\s*$)/\n        // for discount behavior.\n        loose = next || /\\n\\n(?!\\s*$)/.test(item);\n        if (i !== l - 1) {\n          next = item.charAt(item.length - 1) === '\\n';\n          if (!loose) loose = next;\n        }\n\n        if (loose) {\n          list.loose = true;\n        }\n\n        // Check for task list items\n        istask = /^\\[[ xX]\\] /.test(item);\n        ischecked = undefined;\n        if (istask) {\n          ischecked = item[1] !== ' ';\n          item = item.replace(/^\\[[ xX]\\] +/, '');\n        }\n\n        list.items.push({\n          type: 'list_item',\n          raw,\n          task: istask,\n          checked: ischecked,\n          loose: loose,\n          text: item\n        });\n      }\n\n      return list;\n    }\n  }\n\n  html(src) {\n    const cap = this.rules.block.html.exec(src);\n    if (cap) {\n      return {\n        type: this.options.sanitize\n          ? 'paragraph'\n          : 'html',\n        raw: cap[0],\n        pre: !this.options.sanitizer\n          && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n        text: this.options.sanitize ? (this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0])) : cap[0]\n      };\n    }\n  }\n\n  def(src) {\n    const cap = this.rules.block.def.exec(src);\n    if (cap) {\n      if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n      const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n      return {\n        tag,\n        raw: cap[0],\n        href: cap[2],\n        title: cap[3]\n      };\n    }\n  }\n\n  table(src) {\n    const cap = this.rules.block.table.exec(src);\n    if (cap) {\n      const item = {\n        type: 'table',\n        header: splitCells(cap[1].replace(/^ *| *\\| *$/g, '')),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : []\n      };\n\n      if (item.header.length === item.align.length) {\n        item.raw = cap[0];\n\n        let l = item.align.length;\n        let i;\n        for (i = 0; i < l; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n\n        l = item.cells.length;\n        for (i = 0; i < l; i++) {\n          item.cells[i] = splitCells(\n            item.cells[i].replace(/^ *\\| *| *\\| *$/g, ''),\n            item.header.length);\n        }\n\n        return item;\n      }\n    }\n  }\n\n  lheading(src) {\n    const cap = this.rules.block.lheading.exec(src);\n    if (cap) {\n      return {\n        type: 'heading',\n        raw: cap[0],\n        depth: cap[2].charAt(0) === '=' ? 1 : 2,\n        text: cap[1]\n      };\n    }\n  }\n\n  paragraph(src) {\n    const cap = this.rules.block.paragraph.exec(src);\n    if (cap) {\n      return {\n        type: 'paragraph',\n        raw: cap[0],\n        text: cap[1].charAt(cap[1].length - 1) === '\\n'\n          ? cap[1].slice(0, -1)\n          : cap[1]\n      };\n    }\n  }\n\n  text(src, tokens) {\n    const cap = this.rules.block.text.exec(src);\n    if (cap) {\n      const lastToken = tokens[tokens.length - 1];\n      if (lastToken && lastToken.type === 'text') {\n        return {\n          raw: cap[0],\n          text: cap[0]\n        };\n      }\n\n      return {\n        type: 'text',\n        raw: cap[0],\n        text: cap[0]\n      };\n    }\n  }\n\n  escape(src) {\n    const cap = this.rules.inline.escape.exec(src);\n    if (cap) {\n      return {\n        type: 'escape',\n        raw: cap[0],\n        text: escape(cap[1])\n      };\n    }\n  }\n\n  tag(src, inLink, inRawBlock) {\n    const cap = this.rules.inline.tag.exec(src);\n    if (cap) {\n      if (!inLink && /^<a /i.test(cap[0])) {\n        inLink = true;\n      } else if (inLink && /^<\\/a>/i.test(cap[0])) {\n        inLink = false;\n      }\n      if (!inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        inRawBlock = true;\n      } else if (inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        inRawBlock = false;\n      }\n\n      return {\n        type: this.options.sanitize\n          ? 'text'\n          : 'html',\n        raw: cap[0],\n        inLink,\n        inRawBlock,\n        text: this.options.sanitize\n          ? (this.options.sanitizer\n            ? this.options.sanitizer(cap[0])\n            : escape(cap[0]))\n          : cap[0]\n      };\n    }\n  }\n\n  link(src) {\n    const cap = this.rules.inline.link.exec(src);\n    if (cap) {\n      const lastParenIndex = findClosingBracket(cap[2], '()');\n      if (lastParenIndex > -1) {\n        const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n        const linkLen = start + cap[1].length + lastParenIndex;\n        cap[2] = cap[2].substring(0, lastParenIndex);\n        cap[0] = cap[0].substring(0, linkLen).trim();\n        cap[3] = '';\n      }\n      let href = cap[2];\n      let title = '';\n      if (this.options.pedantic) {\n        const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n        if (link) {\n          href = link[1];\n          title = link[3];\n        } else {\n          title = '';\n        }\n      } else {\n        title = cap[3] ? cap[3].slice(1, -1) : '';\n      }\n      href = href.trim().replace(/^<([\\s\\S]*)>$/, '$1');\n      const token = outputLink(cap, {\n        href: href ? href.replace(this.rules.inline._escapes, '$1') : href,\n        title: title ? title.replace(this.rules.inline._escapes, '$1') : title\n      }, cap[0]);\n      return token;\n    }\n  }\n\n  reflink(src, links) {\n    let cap;\n    if ((cap = this.rules.inline.reflink.exec(src))\n        || (cap = this.rules.inline.nolink.exec(src))) {\n      let link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n      link = links[link.toLowerCase()];\n      if (!link || !link.href) {\n        const text = cap[0].charAt(0);\n        return {\n          type: 'text',\n          raw: text,\n          text\n        };\n      }\n      const token = outputLink(cap, link, cap[0]);\n      return token;\n    }\n  }\n\n  strong(src, maskedSrc, prevChar = '') {\n    let match = this.rules.inline.strong.start.exec(src);\n\n    if (match && (!match[1] || (match[1] && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))))) {\n      maskedSrc = maskedSrc.slice(-1 * src.length);\n      const endReg = match[0] === '**' ? this.rules.inline.strong.endAst : this.rules.inline.strong.endUnd;\n\n      endReg.lastIndex = 0;\n\n      let cap;\n      while ((match = endReg.exec(maskedSrc)) != null) {\n        cap = this.rules.inline.strong.middle.exec(maskedSrc.slice(0, match.index + 3));\n        if (cap) {\n          return {\n            type: 'strong',\n            raw: src.slice(0, cap[0].length),\n            text: src.slice(2, cap[0].length - 2)\n          };\n        }\n      }\n    }\n  }\n\n  em(src, maskedSrc, prevChar = '') {\n    let match = this.rules.inline.em.start.exec(src);\n\n    if (match && (!match[1] || (match[1] && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))))) {\n      maskedSrc = maskedSrc.slice(-1 * src.length);\n      const endReg = match[0] === '*' ? this.rules.inline.em.endAst : this.rules.inline.em.endUnd;\n\n      endReg.lastIndex = 0;\n\n      let cap;\n      while ((match = endReg.exec(maskedSrc)) != null) {\n        cap = this.rules.inline.em.middle.exec(maskedSrc.slice(0, match.index + 2));\n        if (cap) {\n          return {\n            type: 'em',\n            raw: src.slice(0, cap[0].length),\n            text: src.slice(1, cap[0].length - 1)\n          };\n        }\n      }\n    }\n  }\n\n  codespan(src) {\n    const cap = this.rules.inline.code.exec(src);\n    if (cap) {\n      let text = cap[2].replace(/\\n/g, ' ');\n      const hasNonSpaceChars = /[^ ]/.test(text);\n      const hasSpaceCharsOnBothEnds = text.startsWith(' ') && text.endsWith(' ');\n      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n        text = text.substring(1, text.length - 1);\n      }\n      text = escape(text, true);\n      return {\n        type: 'codespan',\n        raw: cap[0],\n        text\n      };\n    }\n  }\n\n  br(src) {\n    const cap = this.rules.inline.br.exec(src);\n    if (cap) {\n      return {\n        type: 'br',\n        raw: cap[0]\n      };\n    }\n  }\n\n  del(src) {\n    const cap = this.rules.inline.del.exec(src);\n    if (cap) {\n      return {\n        type: 'del',\n        raw: cap[0],\n        text: cap[1]\n      };\n    }\n  }\n\n  autolink(src, mangle) {\n    const cap = this.rules.inline.autolink.exec(src);\n    if (cap) {\n      let text, href;\n      if (cap[2] === '@') {\n        text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);\n        href = 'mailto:' + text;\n      } else {\n        text = escape(cap[1]);\n        href = text;\n      }\n\n      return {\n        type: 'link',\n        raw: cap[0],\n        text,\n        href,\n        tokens: [\n          {\n            type: 'text',\n            raw: text,\n            text\n          }\n        ]\n      };\n    }\n  }\n\n  url(src, mangle) {\n    let cap;\n    if (cap = this.rules.inline.url.exec(src)) {\n      let text, href;\n      if (cap[2] === '@') {\n        text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n        href = 'mailto:' + text;\n      } else {\n        // do extended autolink path validation\n        let prevCapZero;\n        do {\n          prevCapZero = cap[0];\n          cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];\n        } while (prevCapZero !== cap[0]);\n        text = escape(cap[0]);\n        if (cap[1] === 'www.') {\n          href = 'http://' + text;\n        } else {\n          href = text;\n        }\n      }\n      return {\n        type: 'link',\n        raw: cap[0],\n        text,\n        href,\n        tokens: [\n          {\n            type: 'text',\n            raw: text,\n            text\n          }\n        ]\n      };\n    }\n  }\n\n  inlineText(src, inRawBlock, smartypants) {\n    const cap = this.rules.inline.text.exec(src);\n    if (cap) {\n      let text;\n      if (inRawBlock) {\n        text = this.options.sanitize ? (this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0])) : cap[0];\n      } else {\n        text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);\n      }\n      return {\n        type: 'text',\n        raw: cap[0],\n        text\n      };\n    }\n  }\n\n  // FVTT stuff\n  // block\n  secret(src, tokens) {\n    const cap = this.rules.block.secret.exec(src);\n    if (cap) {\n      const text = cap[3];\n      return {\n        type: 'secret',\n        raw: cap[0],\n        text: text\n      };\n    }\n  }\n\n\n  // inline\n  entityLink(src) {\n    let match = this.rules.inline.entityLink.exec(src);\n    if (match) {\n      console.log(match);\n      console.log(TextEditor._replaceContentLinks(match[0], match[1], match[2], match[3]));\n      // console.log(TextEditor._replaceContentLinks(match[0], match[1], match[2], match[3]))\n      return {\n        type: 'entityLink',\n        raw: match[0],\n        text: TextEditor._replaceContentLinks(match[0], match[1], match[2], match[3])\n      }\n    }\n  }\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\nfunction getDefaults() {\n  return {\n    baseUrl: null,\n    breaks: false,\n    gfm: true,\n    headerIds: true,\n    headerPrefix: '',\n    highlight: null,\n    langPrefix: 'language-',\n    mangle: true,\n    pedantic: false,\n    renderer: null,\n    sanitize: false,\n    sanitizer: null,\n    silent: false,\n    smartLists: false,\n    smartypants: false,\n    tokenizer: null,\n    walkTokens: null,\n    xhtml: false\n  };\n}\n\nfunction changeDefaults(newDefaults) {\n  module.exports.defaults = newDefaults;\n}\n\nmodule.exports = {\n  defaults: getDefaults(),\n  getDefaults,\n  changeDefaults\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = /[&<>\"']/g;\nconst escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\nconst escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\nconst escapeReplacements = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\nconst getEscapeReplacement = (ch) => escapeReplacements[ch];\nfunction escape(html, encode) {\n  if (encode) {\n    if (escapeTest.test(html)) {\n      return html.replace(escapeReplace, getEscapeReplacement);\n    }\n  } else {\n    if (escapeTestNoEncode.test(html)) {\n      return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n    }\n  }\n\n  return html;\n}\n\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\n\nfunction unescape(html) {\n  // explicitly match decimal, hex, and named HTML entities\n  return html.replace(unescapeTest, (_, n) => {\n    n = n.toLowerCase();\n    if (n === 'colon') return ':';\n    if (n.charAt(0) === '#') {\n      return n.charAt(1) === 'x'\n        ? String.fromCharCode(parseInt(n.substring(2), 16))\n        : String.fromCharCode(+n.substring(1));\n    }\n    return '';\n  });\n}\n\nconst caret = /(^|[^\\[])\\^/g;\nfunction edit(regex, opt) {\n  regex = regex.source || regex;\n  opt = opt || '';\n  const obj = {\n    replace: (name, val) => {\n      val = val.source || val;\n      val = val.replace(caret, '$1');\n      regex = regex.replace(name, val);\n      return obj;\n    },\n    getRegex: () => {\n      return new RegExp(regex, opt);\n    }\n  };\n  return obj;\n}\n\nconst nonWordAndColonTest = /[^\\w:]/g;\nconst originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\nfunction cleanUrl(sanitize, base, href) {\n  if (sanitize) {\n    let prot;\n    try {\n      prot = decodeURIComponent(unescape(href))\n        .replace(nonWordAndColonTest, '')\n        .toLowerCase();\n    } catch (e) {\n      return null;\n    }\n    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n      return null;\n    }\n  }\n  if (base && !originIndependentUrl.test(href)) {\n    href = resolveUrl(base, href);\n  }\n  try {\n    href = encodeURI(href).replace(/%25/g, '%');\n  } catch (e) {\n    return null;\n  }\n  return href;\n}\n\nconst baseUrls = {};\nconst justDomain = /^[^:]+:\\/*[^/]*$/;\nconst protocol = /^([^:]+:)[\\s\\S]*$/;\nconst domain = /^([^:]+:\\/*[^/]*)[\\s\\S]*$/;\n\nfunction resolveUrl(base, href) {\n  if (!baseUrls[' ' + base]) {\n    // we can ignore everything in base after the last slash of its path component,\n    // but we might need to add _that_\n    // https://tools.ietf.org/html/rfc3986#section-3\n    if (justDomain.test(base)) {\n      baseUrls[' ' + base] = base + '/';\n    } else {\n      baseUrls[' ' + base] = rtrim(base, '/', true);\n    }\n  }\n  base = baseUrls[' ' + base];\n  const relativeBase = base.indexOf(':') === -1;\n\n  if (href.substring(0, 2) === '//') {\n    if (relativeBase) {\n      return href;\n    }\n    return base.replace(protocol, '$1') + href;\n  } else if (href.charAt(0) === '/') {\n    if (relativeBase) {\n      return href;\n    }\n    return base.replace(domain, '$1') + href;\n  } else {\n    return base + href;\n  }\n}\n\nconst noopTest = { exec: function noopTest() {} };\n\nfunction merge(obj) {\n  let i = 1,\n    target,\n    key;\n\n  for (; i < arguments.length; i++) {\n    target = arguments[i];\n    for (key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        obj[key] = target[key];\n      }\n    }\n  }\n\n  return obj;\n}\n\nfunction splitCells(tableRow, count) {\n  // ensure that every cell-delimiting pipe has a space\n  // before it to distinguish it from an escaped pipe\n  const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n      let escaped = false,\n        curr = offset;\n      while (--curr >= 0 && str[curr] === '\\\\') escaped = !escaped;\n      if (escaped) {\n        // odd number of slashes means | is escaped\n        // so we leave it alone\n        return '|';\n      } else {\n        // add space before unescaped |\n        return ' |';\n      }\n    }),\n    cells = row.split(/ \\|/);\n  let i = 0;\n\n  if (cells.length > count) {\n    cells.splice(count);\n  } else {\n    while (cells.length < count) cells.push('');\n  }\n\n  for (; i < cells.length; i++) {\n    // leading or trailing whitespace is ignored per the gfm spec\n    cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n  }\n  return cells;\n}\n\n// Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n// /c*$/ is vulnerable to REDOS.\n// invert: Remove suffix of non-c chars instead. Default falsey.\nfunction rtrim(str, c, invert) {\n  const l = str.length;\n  if (l === 0) {\n    return '';\n  }\n\n  // Length of suffix matching the invert condition.\n  let suffLen = 0;\n\n  // Step left until we fail to match the invert condition.\n  while (suffLen < l) {\n    const currChar = str.charAt(l - suffLen - 1);\n    if (currChar === c && !invert) {\n      suffLen++;\n    } else if (currChar !== c && invert) {\n      suffLen++;\n    } else {\n      break;\n    }\n  }\n\n  return str.substr(0, l - suffLen);\n}\n\nfunction findClosingBracket(str, b) {\n  if (str.indexOf(b[1]) === -1) {\n    return -1;\n  }\n  const l = str.length;\n  let level = 0,\n    i = 0;\n  for (; i < l; i++) {\n    if (str[i] === '\\\\') {\n      i++;\n    } else if (str[i] === b[0]) {\n      level++;\n    } else if (str[i] === b[1]) {\n      level--;\n      if (level < 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\nfunction checkSanitizeDeprecation(opt) {\n  if (opt && opt.sanitize && !opt.silent) {\n    console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');\n  }\n}\n\nmodule.exports = {\n  escape,\n  unescape,\n  edit,\n  cleanUrl,\n  resolveUrl,\n  noopTest,\n  merge,\n  splitCells,\n  rtrim,\n  findClosingBracket,\n  checkSanitizeDeprecation\n};\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n * \n * It is partly modified to add some FoundryVTT related functionality.\n */\n\nconst Lexer = require('./Lexer.js');\nconst Parser = require('./Parser.js');\nconst Tokenizer = require('./Tokenizer.js');\nconst Renderer = require('./Renderer.js');\nconst TextRenderer = require('./TextRenderer.js');\nconst Slugger = require('./Slugger.js');\nconst {\n  merge,\n  checkSanitizeDeprecation,\n  escape\n} = require('./helpers.js');\nconst {\n  getDefaults,\n  changeDefaults,\n  defaults\n} = require('./defaults.js');\n\n/**\n * Marked\n */\nfunction marked(src, opt, callback) {\n  // throw error in case of non string input\n  if (typeof src === 'undefined' || src === null) {\n    throw new Error('marked(): input parameter is undefined or null');\n  }\n  if (typeof src !== 'string') {\n    throw new Error('marked(): input parameter is of type '\n      + Object.prototype.toString.call(src) + ', string expected');\n  }\n\n  if (typeof opt === 'function') {\n    callback = opt;\n    opt = null;\n  }\n\n  opt = merge({}, marked.defaults, opt || {});\n  checkSanitizeDeprecation(opt);\n\n  if (callback) {\n    const highlight = opt.highlight;\n    let tokens;\n\n    try {\n      tokens = Lexer.lex(src, opt);\n    } catch (e) {\n      return callback(e);\n    }\n\n    const done = function(err) {\n      let out;\n\n      if (!err) {\n        try {\n          out = Parser.parse(tokens, opt);\n        } catch (e) {\n          err = e;\n        }\n      }\n\n      opt.highlight = highlight;\n\n      return err\n        ? callback(err)\n        : callback(null, out);\n    };\n\n    if (!highlight || highlight.length < 3) {\n      return done();\n    }\n\n    delete opt.highlight;\n\n    if (!tokens.length) return done();\n\n    let pending = 0;\n    marked.walkTokens(tokens, function(token) {\n      if (token.type === 'code') {\n        pending++;\n        setTimeout(() => {\n          highlight(token.text, token.lang, function(err, code) {\n            if (err) {\n              return done(err);\n            }\n            if (code != null && code !== token.text) {\n              token.text = code;\n              token.escaped = true;\n            }\n\n            pending--;\n            if (pending === 0) {\n              done();\n            }\n          });\n        }, 0);\n      }\n    });\n\n    if (pending === 0) {\n      done();\n    }\n\n    return;\n  }\n\n  try {\n    const tokens = Lexer.lex(src, opt);\n    if (opt.walkTokens) {\n      marked.walkTokens(tokens, opt.walkTokens);\n    }\n    return Parser.parse(tokens, opt);\n  } catch (e) {\n    e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n    if (opt.silent) {\n      return '<p>An error occurred:</p><pre>'\n        + escape(e.message + '', true)\n        + '</pre>';\n    }\n    throw e;\n  }\n}\n\n/**\n * Options\n */\n\nmarked.options =\nmarked.setOptions = function(opt) {\n  merge(marked.defaults, opt);\n  changeDefaults(marked.defaults);\n  return marked;\n};\n\nmarked.getDefaults = getDefaults;\n\nmarked.defaults = defaults;\n\n/**\n * Use Extension\n */\n\nmarked.use = function(extension) {\n  const opts = merge({}, extension);\n  if (extension.renderer) {\n    const renderer = marked.defaults.renderer || new Renderer();\n    for (const prop in extension.renderer) {\n      const prevRenderer = renderer[prop];\n      renderer[prop] = (...args) => {\n        let ret = extension.renderer[prop].apply(renderer, args);\n        if (ret === false) {\n          ret = prevRenderer.apply(renderer, args);\n        }\n        return ret;\n      };\n    }\n    opts.renderer = renderer;\n  }\n  if (extension.tokenizer) {\n    const tokenizer = marked.defaults.tokenizer || new Tokenizer();\n    for (const prop in extension.tokenizer) {\n      const prevTokenizer = tokenizer[prop];\n      tokenizer[prop] = (...args) => {\n        let ret = extension.tokenizer[prop].apply(tokenizer, args);\n        if (ret === false) {\n          ret = prevTokenizer.apply(tokenizer, args);\n        }\n        return ret;\n      };\n    }\n    opts.tokenizer = tokenizer;\n  }\n  if (extension.walkTokens) {\n    const walkTokens = marked.defaults.walkTokens;\n    opts.walkTokens = (token) => {\n      extension.walkTokens(token);\n      if (walkTokens) {\n        walkTokens(token);\n      }\n    };\n  }\n  marked.setOptions(opts);\n};\n\n/**\n * Run callback for every token\n */\n\nmarked.walkTokens = function(tokens, callback) {\n  for (const token of tokens) {\n    callback(token);\n    switch (token.type) {\n      case 'table': {\n        for (const cell of token.tokens.header) {\n          marked.walkTokens(cell, callback);\n        }\n        for (const row of token.tokens.cells) {\n          for (const cell of row) {\n            marked.walkTokens(cell, callback);\n          }\n        }\n        break;\n      }\n      case 'list': {\n        marked.walkTokens(token.items, callback);\n        break;\n      }\n      default: {\n        if (token.tokens) {\n          marked.walkTokens(token.tokens, callback);\n        }\n      }\n    }\n  }\n};\n\n/**\n * Expose\n */\n\nmarked.Parser = Parser;\nmarked.parser = Parser.parse;\n\nmarked.Renderer = Renderer;\nmarked.TextRenderer = TextRenderer;\n\nmarked.Lexer = Lexer;\nmarked.lexer = Lexer.lex;\n\nmarked.Tokenizer = Tokenizer;\n\nmarked.Slugger = Slugger;\n\nmarked.parse = marked;\n\nmodule.exports = marked;\n","/**\n * This file is part of \n * marked - a markdown parser\n * Copyright (c) 2011-${new Date().getFullYear()}, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n * \n * It is partly modified to add some FoundryVTT related functionality.\n * Added functionality:\n * - secret blocks\n * - Entity Links\n */\n\nconst {\n  noopTest,\n  edit,\n  merge\n} = require('./helpers.js');\n\n/**\n * Block-Level Grammar\n */\nconst block = {\n  newline: /^\\n+/,\n  code: /^( {4}[^\\n]+\\n*)+/,\n  fences: /^ {0,3}(`{3,}(?=[^`\\n]*\\n)|~{3,})([^\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?:\\n+|$)|$)/,\n  hr: /^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)/,\n  heading: /^ {0,3}(#{1,6}) +([^\\n]*?)(?: +#+)? *(?:\\n+|$)/,\n  blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n  list: /^( {0,3})(bull) [\\s\\S]+?(?:hr|def|\\n{2,}(?! )(?!\\1bull )\\n*|\\s*$)/,\n  html: '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?\\\\?>\\\\n*' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?>\\\\n*' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>\\\\n*' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (6)\n    + '|<(?!script|pre|style)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) open tag\n    + '|</(?!script|pre|style)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) closing tag\n    + ')',\n  def: /^ {0,3}\\[(label)\\]: *\\n? *<?([^\\s>]+)>?(?:(?: +\\n? *| *\\n *)(title))? *(?:\\n+|$)/,\n  nptable: noopTest,\n  table: noopTest,\n  lheading: /^([^\\n]+)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n  // regex template, placeholders will be replaced according to different paragraph\n  // interruption rules of commonmark and the original markdown spec:\n  _paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\\n]+)*)/,\n  text: /^[^\\n]+/,\n\n  // FVTT secret block using $$$\n  secret: /^ {0,3}(\\${3,}(?=\\n)|~{3,})([^\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1(?:\\n+|$)|$)/\n};\n\nblock._label = /(?!\\s*\\])(?:\\\\[\\[\\]]|[^\\[\\]])+/;\nblock._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\nblock.def = edit(block.def)\n  .replace('label', block._label)\n  .replace('title', block._title)\n  .getRegex();\n\nblock.bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nblock.item = /^( *)(bull) ?[^\\n]*(?:\\n(?!\\1bull ?)[^\\n]*)*/;\nblock.item = edit(block.item, 'gm')\n  .replace(/bull/g, block.bullet)\n  .getRegex();\n\nblock.list = edit(block.list)\n  .replace(/bull/g, block.bullet)\n  .replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))')\n  .replace('def', '\\\\n+(?=' + block.def.source + ')')\n  .getRegex();\n\nblock._tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n  + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n  + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n  + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n  + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr'\n  + '|track|ul';\nblock._comment = /<!--(?!-?>)[\\s\\S]*?-->/;\nblock.html = edit(block.html, 'i')\n  .replace('comment', block._comment)\n  .replace('tag', block._tag)\n  .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n  .getRegex();\n\nblock.paragraph = edit(block._paragraph)\n  .replace('hr', block.hr)\n  .replace('heading', ' {0,3}#{1,6} ')\n  .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n  .replace('blockquote', ' {0,3}>')\n  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|!--)')\n  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n\nblock.blockquote = edit(block.blockquote)\n  .replace('paragraph', block.paragraph)\n  .getRegex();\n\n/**\n * Normal Block Grammar\n */\n\nblock.normal = merge({}, block);\n\n/**\n * GFM Block Grammar\n */\n\nblock.gfm = merge({}, block.normal, {\n  nptable: '^ *([^|\\\\n ].*\\\\|.*)\\\\n' // Header\n    + ' *([-:]+ *\\\\|[-| :]*)' // Align\n    + '(?:\\\\n((?:(?!\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)', // Cells\n  table: '^ *\\\\|(.+)\\\\n' // Header\n    + ' *\\\\|?( *[-:]+[-| :]*)' // Align\n    + '(?:\\\\n *((?:(?!\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)' // Cells\n});\n\nblock.gfm.nptable = edit(block.gfm.nptable)\n  .replace('hr', block.hr)\n  .replace('heading', ' {0,3}#{1,6} ')\n  .replace('blockquote', ' {0,3}>')\n  .replace('code', ' {4}[^\\\\n]')\n  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|!--)')\n  .replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n  .getRegex();\n\nblock.gfm.table = edit(block.gfm.table)\n  .replace('hr', block.hr)\n  .replace('heading', ' {0,3}#{1,6} ')\n  .replace('blockquote', ' {0,3}>')\n  .replace('code', ' {4}[^\\\\n]')\n  .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n  .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|!--)')\n  .replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n  .getRegex();\n\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\n\nblock.pedantic = merge({}, block.normal, {\n  html: edit(\n    '^ *(?:comment *(?:\\\\n|\\\\s*$)'\n    + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n    + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n    .replace('comment', block._comment)\n    .replace(/tag/g, '(?!(?:'\n      + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n      + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n      + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n    .getRegex(),\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n  heading: /^ *(#{1,6}) *([^\\n]+?) *(?:#+ *)?(?:\\n+|$)/,\n  fences: noopTest, // fences not supported\n  paragraph: edit(block.normal._paragraph)\n    .replace('hr', block.hr)\n    .replace('heading', ' *#{1,6} *[^\\n]')\n    .replace('lheading', block.lheading)\n    .replace('blockquote', ' {0,3}>')\n    .replace('|fences', '')\n    .replace('|list', '')\n    .replace('|html', '')\n    .getRegex()\n});\n\n\n\n/**\n * Inline-Level Grammar\n */\nconst inline = {\n  escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n  autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n  url: noopTest,\n  tag: '^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>', // CDATA section\n  link: /^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/,\n  reflink: /^!?\\[(label)\\]\\[(?!\\s*\\])((?:\\\\[\\[\\]]?|[^\\[\\]\\\\])+)\\]/,\n  nolink: /^!?\\[(?!\\s*\\])((?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]|[^\\[\\]])*)\\](?:\\[\\])?/,\n  reflinkSearch: 'reflink|nolink(?!\\\\()',\n  strong: {\n    start: /^(?:(\\*\\*(?=[*punctuation]))|\\*\\*)(?![\\s])|__/, // (1) returns if starts w/ punctuation\n    middle: /^\\*\\*(?:(?:(?!overlapSkip)(?:[^*]|\\\\\\*)|overlapSkip)|\\*(?:(?!overlapSkip)(?:[^*]|\\\\\\*)|overlapSkip)*?\\*)+?\\*\\*$|^__(?![\\s])((?:(?:(?!overlapSkip)(?:[^_]|\\\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\\\_)|overlapSkip)*?_)+?)__$/,\n    endAst: /[^punctuation\\s]\\*\\*(?!\\*)|[punctuation]\\*\\*(?!\\*)(?:(?=[punctuation\\s]|$))/, // last char can't be punct, or final * must also be followed by punct (or endline)\n    endUnd: /[^\\s]__(?!_)(?:(?=[punctuation\\s])|$)/ // last char can't be a space, and final _ must preceed punct or \\s (or endline)\n  },\n  em: {\n    start: /^(?:(\\*(?=[punctuation]))|\\*)(?![*\\s])|_/, // (1) returns if starts w/ punctuation\n    middle: /^\\*(?:(?:(?!overlapSkip)(?:[^*]|\\\\\\*)|overlapSkip)|\\*(?:(?!overlapSkip)(?:[^*]|\\\\\\*)|overlapSkip)*?\\*)+?\\*$|^_(?![_\\s])(?:(?:(?!overlapSkip)(?:[^_]|\\\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\\\_)|overlapSkip)*?_)+?_$/,\n    endAst: /[^punctuation\\s]\\*(?!\\*)|[punctuation]\\*(?!\\*)(?:(?=[punctuation\\s]|$))/, // last char can't be punct, or final * must also be followed by punct (or endline)\n    endUnd: /[^\\s]_(?!_)(?:(?=[punctuation\\s])|$)/ // last char can't be a space, and final _ must preceed punct or \\s (or endline)\n  },\n  code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n  br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n  del: noopTest,\n  text: /^(`+|[^`])(?:[\\s\\S]*?(?:(?=[\\@\\\\<!\\[`*]|\\b_|$)|[^ ](?= {2,}\\n))|(?= {2,}\\n))/,\n  punctuation: /^([\\s*punctuation])/,\n  // FVTT stuff\n  entityLink: new RegExp(`^@(${CONST.ENTITY_LINK_TYPES.concat(\"Compendium\").join(\"|\")})\\\\[([^\\\\]]+)\\\\](?:{([^}]+)})?`)\n};\n// list of punctuation marks from common mark spec\n// without * and _ to workaround cases with double emphasis\ninline._punctuation = '!\"#$%&\\'()+\\\\-.,/:;<=>?@\\\\[\\\\]`^{|}~';\ninline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();\n\n// sequences em should skip over [title](link), `code`, <html>\ninline._blockSkip = '\\\\[[^\\\\]]*?\\\\]\\\\([^\\\\)]*?\\\\)|`[^`]*?`|<[^>]*?>';\ninline._overlapSkip = '__[^_]*?__|\\\\*\\\\*\\\\[^\\\\*\\\\]*?\\\\*\\\\*';\n\ninline.em.start = edit(inline.em.start)\n  .replace(/punctuation/g, inline._punctuation)\n  .getRegex();\n\ninline.em.middle = edit(inline.em.middle)\n  .replace(/punctuation/g, inline._punctuation)\n  .replace(/overlapSkip/g, inline._overlapSkip)\n  .getRegex();\n\ninline.em.endAst = edit(inline.em.endAst, 'g')\n  .replace(/punctuation/g, inline._punctuation)\n  .getRegex();\n\ninline.em.endUnd = edit(inline.em.endUnd, 'g')\n  .replace(/punctuation/g, inline._punctuation)\n  .getRegex();\n\ninline.strong.start = edit(inline.strong.start)\n  .replace(/punctuation/g, inline._punctuation)\n  .getRegex();\n\ninline.strong.middle = edit(inline.strong.middle)\n  .replace(/punctuation/g, inline._punctuation)\n  .replace(/blockSkip/g, inline._blockSkip)\n  .getRegex();\n\ninline.strong.endAst = edit(inline.strong.endAst, 'g')\n  .replace(/punctuation/g, inline._punctuation)\n  .getRegex();\n\ninline.strong.endUnd = edit(inline.strong.endUnd, 'g')\n  .replace(/punctuation/g, inline._punctuation)\n  .getRegex();\n\ninline.blockSkip = edit(inline._blockSkip, 'g')\n  .getRegex();\n\ninline.overlapSkip = edit(inline._overlapSkip, 'g')\n  .getRegex();\n\ninline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\n\ninline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\ninline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\ninline.autolink = edit(inline.autolink)\n  .replace('scheme', inline._scheme)\n  .replace('email', inline._email)\n  .getRegex();\n\ninline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\n\ninline.tag = edit(inline.tag)\n  .replace('comment', block._comment)\n  .replace('attribute', inline._attribute)\n  .getRegex();\n\ninline._label = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\ninline._href = /<(?:\\\\[<>]?|[^\\s<>\\\\])*>|[^\\s\\x00-\\x1f]*/;\ninline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\n\ninline.link = edit(inline.link)\n  .replace('label', inline._label)\n  .replace('href', inline._href)\n  .replace('title', inline._title)\n  .getRegex();\n\ninline.reflink = edit(inline.reflink)\n  .replace('label', inline._label)\n  .getRegex();\n\ninline.reflinkSearch = edit(inline.reflinkSearch, 'g')\n  .replace('reflink', inline.reflink)\n  .replace('nolink', inline.nolink)\n  .getRegex();\n\n/**\n * Normal Inline Grammar\n */\n\ninline.normal = merge({}, inline);\n\n/**\n * Pedantic Inline Grammar\n */\n\ninline.pedantic = merge({}, inline.normal, {\n  strong: {\n    start: /^__|\\*\\*/,\n    middle: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n    endAst: /\\*\\*(?!\\*)/g,\n    endUnd: /__(?!_)/g\n  },\n  em: {\n    start: /^_|\\*/,\n    middle: /^()\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)|^_(?=\\S)([\\s\\S]*?\\S)_(?!_)/,\n    endAst: /\\*(?!\\*)/g,\n    endUnd: /_(?!_)/g\n  },\n  link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n    .replace('label', inline._label)\n    .getRegex(),\n  reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n    .replace('label', inline._label)\n    .getRegex()\n});\n\n/**\n * GFM Inline Grammar\n */\n\ninline.gfm = merge({}, inline.normal, {\n  escape: edit(inline.escape).replace('])', '~|])').getRegex(),\n  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n  url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n  _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n  del: /^~+(?=\\S)([\\s\\S]*?\\S)~+/,\n  text: /^(`+|[^`])(?:[\\s\\S]*?(?:(?=[@\\\\<!\\[`*~]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))|(?= {2,}\\n|[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))/\n});\n\ninline.gfm.url = edit(inline.gfm.url, 'i')\n  .replace('email', inline.gfm._extended_email)\n  .getRegex();\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\ninline.breaks = merge({}, inline.gfm, {\n  br: edit(inline.br).replace('{2,}', '*').getRegex(),\n  text: edit(inline.gfm.text)\n    .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n    .replace(/\\{2,\\}/g, '*')\n    .getRegex()\n});\n\n// FVTT Stuff\n\ninline.entityLink = edit(inline.entityLink).getRegex();\n\nmodule.exports = {\n  block,\n  inline\n};\n","import EasyMDE from './easymde/easymde.js';\n\nHooks.on('ready', () => game.journal.get('Gb3Z2SCBSDp1sEVe').sheet.render(true))\n\n\n// FormApplication.prototype._createEditor = function(target, editorOptions, initialContent) {\n// \t// console.log(\"lalalalal\")\n// \t// console.log(target, editorOptions, initialContent);\n// \t// // const textarea = document.createElement('textarea');\n// \t// // textarea.innerHTML = editorOptions.target.innerHTML;\n// \t// // editorOptions.target.parentNode.replaceChild(textarea, editorOptions.target);\n// \t// console.log(new EasyMDE({\n// \t// \telement: editorOptions.target,\n// \t// \tforceSync: true\n// \t// }));\n// }\n\nHooks.on('init', function() {\n\tgame.settings.register('markdown-editor', 'vim-mode', {\n\t\tname: 'VIM Keybindings',\n\t\thint: 'Enable VIM keybindings for the markdown editor',\n\t\tscope: 'user',\n\t\tdefault: false,\n\t\ttype: Boolean,\n\t\trestricted: false,\n\t\tconfig: true\n\t})\n});\n\nHandlebars.registerHelper('editor', function(options) {\n  let target = options.hash['target'],\n      content = options.hash['content'] || \"\",\n      button = Boolean(options.hash['button']),\n      owner = Boolean(options.hash['owner']),\n      editable = Boolean(options.hash['editable']);\n  if ( !target ) throw new Error(\"You must define the name of a target field.\");\n\n  // Enrich the content\n  content = TextEditor.enrichHTML(content, {secrets: owner, entities: true});\n\n  // Construct the HTML\n\tlet editor = $(`<div class=\"editor ${owner ? 'no-secrets' : ''}\"><textarea class=\"editor-content\" ${editable ? 'data-editable=\"true\"' : ''} name=\"${target}\">${content}</textarea></div>`);\n\n  // Append edit button\n\tif ( button && editable ) editor.append($('<a class=\"editor-edit\"><i class=\"fas fa-edit\"></i></a>'));\n\t\n  return new Handlebars.SafeString(editor[0].outerHTML);\n});\n\n\n\n(function() {\n\tconst oldActivateListeners = FormApplication.prototype.activateListeners;\n\tFormApplication.prototype.activateListeners = function(html) {\n\t\toldActivateListeners.bind(this)(html);\n\t\thtml.find('.editor-content').each((i, div) => this._activateEditor(div));\n\t}\n\n\tFormApplication.prototype._activateEditor =  function(textarea) {\n\t\tconst div = textarea.parentNode;\n\t\tconst target = textarea.name;\n\t\tconst editable = !!textarea.dataset.editable;\n\t\tlet editorOptions = {\n\t\t\telement: textarea,\n\t\t\tforceSync: true,\n\t\t\tminHeight: \"0px\",\n\t\t\ttoolbar: [\n\t\t\t\t\"bold\",\n\t\t\t\t\"italic\",\n\t\t\t\t\"strikethrough\",\n\t\t\t\t\"heading\",\n\t\t\t\t\"|\",\n\t\t\t\t\"ordered-list\",\n\t\t\t\t\"unordered-list\",\n\t\t\t\t{\n\t\t\t\t\tname: \"secret\",\n\t\t\t\t\taction: EasyMDE.toggleSecretBlock,\n\t\t\t\t\tclassName: \"fas fa-user-secret\",\n\t\t\t\t\ttitle: \"Make Secret block\"\n\t\t\t\t},\n\t\t\t\t\"quote\",\n\t\t\t\t// \"code\",\n\t\t\t\t\"table\",\n\t\t\t\t\"|\",\n\t\t\t\t\"link\",\n\t\t\t\t{\n\t\t\t\t\tname: \"image\",\n\t\t\t\t\taction: chooseImage.bind(this),\n\t\t\t\t\tclassName: \"fa fa-image\",\n\t\t\t\t\ttitle: \"Image\"\n\t\t\t\t},\n\t\t\t\t\"horizontal-rule\",\n\t\t\t\t\"|\",\n\t\t\t\t\"preview\",\n\t\t\t\t\"side-by-side\",\n\t\t\t\t\"fullscreen\",\n\t\t\t\t\"|\",\n\t\t\t\t{\n\t\t\t\t\tname: \"save\",\n\t\t\t\t\taction: saveEditor.bind(this),\n\t\t\t\t\tclassName: \"fa fa-floppy-o\",\n\t\t\t\t\ttitle: \"Save\"\n\t\t\t\t},\n\t\t\t\t\"|\",\n\t\t\t\t\"guide\"\n\t\t\t],\n\t\t\tshortcuts: {\n\t\t\t\t// \"save\": \"Ctrl-S\"\n\t\t\t},\n\t\t\tstatus: false,\n\t\t\tspellChecker: false\n\t\t\t// renderingConfig: {\n\t\t\t// \tmarkedOptions: {\n\t\t\t// \t\ttokenizer: new marked.Tokenizer()\n\t\t\t// \t}\n\t\t\t// }\n\t\t}\n\t\tif (!editable) editorOptions.toolbar = false;\n\t\tthis.editors[target] = new EasyMDE(editorOptions);\n\t\tthis.editors[target].togglePreview();\n\n\t\tif (!editable)\n\t\t\treturn;\n\t\tdiv.querySelector('.editor-toolbar').classList.add('hidden');\n\t\tthis.editors[target].codemirror.on('change', (instance, changeObj) => {\n\t\t\t// console.log(instance, changeObj)\n\t\t\tif (changeObj.text.find(e => e === '@')) {\n\t\t\t\tinstance.showHint({\n\t\t\t\t\thint: getEntityHints,\n\t\t\t\t\t// closeOnUnfocus: false\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.editors[target].codemirror.on('drop', (inst, ev) => {\n\t\t\tev.preventDefault();\n\t\t\tconst data = JSON.parse(event.dataTransfer.getData('text/plain'));\n\t\t\tif ( !data ) return;\n\n\t\t\tconst insertIntoEditor = function(link) {\n\t\t\t\tinst.replaceSelection(link)\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tif (data.pack) {\n\t\t\t\t\tconst pack = game.packs.get(data.pack);\n\t\t\t\t\tpack.getEntity(data.id).then(entity => \n\t\t\t\t\t\tinsertIntoEditor(`@Compendium[${data.pack}.${data.id}]{${entity.name}}`));\n\t\t\t\t} else {\n\t\t\t\t\tconst entity = CONFIG[data.type].collection.instance.get(data.id);\n\t\t\t\t\tinsertIntoEditor(`@${data.type}[${entity._id}]{${entity.name}}`);\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t} catch(e) {\n\t\t\t\tconsole.error(\"Dropped incorrect data!\", data);\n\t\t\t}\n\t\t});\n\t\t// this.editors[target].codemirror.on('shown', () => console.log(\"SHOWN!\"));\n\n\t\tconst btn = div.querySelector('.editor-edit');\n\t\tif (btn)\n\t\t\tbtn.addEventListener('click', ev => {\n\t\t\t\tev.currentTarget.style.display = 'none';\n\t\t\t\tev.currentTarget.parentNode.querySelector('.editor-toolbar').classList.remove('hidden');\n\t\t\t\tthis.editors[target].togglePreview();\n\t\t\t})\n\n\t}\n\n\t// Stop the original enrichHTML method from replacing entity links, since we're doing this \"on the fly\", by leveraging marked-js\n\tconst oldEnrichHTML = TextEditor.enrichHTML;\n\tTextEditor.enrichHTML = function(content, {secrets=false, entities=true, links=true, rolls=true, rollData=null}={}) {return oldEnrichHTML.bind(this)(content, {secrets, entities: false, links, rolls, rollData})}\n}());\n\nfunction saveEditor(editor) {\n\teditor.element.parentNode.querySelector('.editor-edit').style.display = null;\n\t// editor.element.parentNode.querySelector('.editor-toolbar').style.display = 'none';\n\teditor.element.parentNode.querySelector('.editor-toolbar').classList.add('hidden');\n\tif (!editor.isPreviewActive())\n\t\teditor.togglePreview();\n\n\tthis.submit();\n}\n\nfunction chooseImage(editor) {\n\tnew FilePicker({\n\t\ttype: \"image\",\n\t\tcallback: path => {\n\t\t\tconst cm = editor.codemirror;\n\t\t\tconst start = cm.getCursor('start');\n\n\t\t\tcm.replaceSelection(`![](${path})`);\n\t\t},\n\t\ttop: this.position.top + 40,\n\t\tleft: this.position.left + 10\n\t}).browse();\n}\n\n// const entityTypes = CONST.ENTITY_LINK_TYPES.concat(\"Compendium\").map(e => {\n// \treturn {\n// \t\ttext: e + \"[\",\n// \t\tdisplayText: e\n// \t}\n// });\n\nconst entityTypes = CONST.ENTITY_LINK_TYPES.map(e => {\n\treturn {\n\t\ttext: e + \"[\",\n\t\tdisplayText: e\n\t}\n});\n\n\n\nfunction getEntityHints(editor, options) {\n\treturn new Promise(function(resolve) {\n\t\tvar Pos = editor.constructor.Pos;\n\t\tvar cur = editor.getCursor();\n\t\t// const entities = CONST.ENTITY_LINK_TYPES.concat(\"Compendium\");\n\t\tconst word = editor.findWordAt(cur);\n\t\tconst completions = {\n\t\t\tlist: getCompletions(editor.getRange(word.anchor, word.head), entityTypes, options),\n\t\t\tfrom: word.anchor,\n\t\t\tto: word.head\n\t\t}\n\t\teditor.constructor.on(completions, 'pick', (completion) => {\n\t\t\tstartEntityCompletion(editor, completion.displayText, {startAtStart: true});\n\t\t});\n\t\tif (completions.list.length)\n\t\t\tresolve(completions);\n\t\tresolve(null);\n\t})\n}\n\nfunction getCompletions(token, keywords, options = {startAtStart: false}) {\n\t// keywords = keywords.map(e => {\n\t// \treturn {\n\t// \t\ttext: e + \"[\",\n\t// \t\tdisplayText: e\n\t// \t}\n\t// })\n\tif (token === \"@\" || token === \"[\")\n\t\treturn keywords.map(e => {\n\t\t\treturn {...e, ...{text: token + e.text}};\n\t\t});\n\tconst regex = new RegExp(`${options.startAtStart ? '^' : ''}${token}`);\n\treturn keywords.filter(e => regex.exec(e.text));\n}\n\nfunction startEntityCompletion(editor, type) {\n\tconst coll = CONFIG[type].collection.instance;\n\tconst collection = coll.entries.map(e => {\n\t\treturn {\n\t\t\ttext: e.id + \"]{\" + e.name + \"}\",\n\t\t\tdisplayText: e.name\n\t\t}\n\t});\n\t// const list = \n\teditor.showHint({\n\t\thint: (editor) => getEntityNameHints(editor, collection),\n\t\t// closeOnUnfocus: false\n\t});\n}\n\nfunction getEntityNameHints(editor, collection) {\n\tvar Pos = editor.constructor.Pos;\n\tvar cur = editor.getCursor();\n\tconst word = editor.findWordAt(cur);\n\n\tconst completions = {\n\t\tlist: getCompletions(editor.getRange(word.anchor, word.head), collection, options),\n\t\tfrom: word.anchor,\n\t\tto: word.head\n\t}\n\treturn completions;\n}"],"sourceRoot":""}